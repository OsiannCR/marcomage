<?xml version="1.0" encoding="utf-8"?>
<!--MArcomage cards database (XML)-->
<cards xmlns="http://arcomage.netvor.sk">
  <card id="0">
    <name>Empty</name>
    <class>None</class>
    <cost>
      <bricks>0</bricks>
      <gems>0</gems>
      <recruits>0</recruits>
    </cost>
    <modes>0</modes>
    <level>0</level>
    <keywords/>
    <effect/>
    <code/>
    <created>None</created>
    <modified>None</modified>
  </card>
  <card id="1">
    <name>Basic wall</name>
    <class>Common</class>
    <cost>
      <bricks>1</bricks>
    </cost>
    <level>0</level>
    <effect><![CDATA[If Wall = 0<br />Wall: +10<br />else<br />Wall: +3]]></effect>
    <code><![CDATA[if ($mydata->Wall == 0) $mydata->Wall+= 10; else $mydata->Wall+= 3;]]></code>
    <created>2006-05-01</created>
    <modified>2011-01-24</modified>
  </card>
  <card id="2">
    <name>Foundations</name>
    <class>Common</class>
    <cost>
      <bricks>1</bricks>
    </cost>
    <level>1</level>
    <effect><![CDATA[Tower: +2<br />If Tower was damaged during opponent's last round<br />Tower: +5]]></effect>
    <code><![CDATA[if ($mychanges['Tower'] < 0) $mydata->Tower+= 7; else $mydata->Tower+= 2;]]></code>
    <created>2006-05-01</created>
    <modified>2010-06-21</modified>
  </card>
  <card id="3">
    <name>Lightning strike</name>
    <class>Uncommon</class>
    <cost>
      <gems>11</gems>
    </cost>
    <level>0</level>
    <keywords>Destruction</keywords>
    <effect><![CDATA[Enemy quarry: -1]]></effect>
    <code><![CDATA[$hisdata->Quarry-= 1;]]></code>
    <created>2006-05-01</created>
    <modified>2007-11-25</modified>
  </card>
  <card id="4">
    <name>Great Wall of China</name>
    <class>Rare</class>
    <cost>
      <bricks>40</bricks>
    </cost>
    <level>0</level>
    <keywords>Far sight</keywords>
    <effect><![CDATA[Wall: +N<br />N = Max wall / 2]]></effect>
    <code><![CDATA[$mydata->Wall+= round($max_wall / 2);]]></code>
    <created>2006-05-01</created>
    <modified>2010-12-24</modified>
  </card>
  <card id="5">
    <name>Curse</name>
    <class>Uncommon</class>
    <cost>
      <gems>48</gems>
    </cost>
    <level>0</level>
    <keywords>Demonic,Illusion</keywords>
    <effect><![CDATA[Facilities: +1<br />Enemy facilities: -1]]></effect>
    <code><![CDATA[$mydata->addFacilities(1); $hisdata->addFacilities(-1);]]></code>
    <created>2006-05-01</created>
    <modified>2013-12-24</modified>
  </card>
  <card id="6">
    <name>Red dragon</name>
    <class>Rare</class>
    <cost>
      <recruits>30</recruits>
    </cost>
    <level>2</level>
    <keywords>Dragon,Charge (25)</keywords>
    <effect><![CDATA[Attack: 30<br />Enemy wall: -20]]></effect>
    <code><![CDATA[$hisdata->attack(30); $hisdata->Wall-= 20;]]></code>
    <created>2006-05-01</created>
    <modified>2012-12-24</modified>
  </card>
  <card id="7">
    <name>Knight</name>
    <class>Common</class>
    <cost>
      <recruits>5</recruits>
    </cost>
    <level>0</level>
    <keywords>Soldier,Charge (3)</keywords>
    <effect><![CDATA[Attack: 7]]></effect>
    <code><![CDATA[$hisdata->attack(7);]]></code>
    <created>2006-05-01</created>
    <modified>2007-08-18</modified>
  </card>
  <card id="8">
    <name>Soulstealer</name>
    <class>Uncommon</class>
    <cost>
      <recruits>10</recruits>
    </cost>
    <level>0</level>
    <keywords>Far sight</keywords>
    <effect><![CDATA[Gems: +7<br />Enemy gems: -7]]></effect>
    <code><![CDATA[$mydata->Gems+= 7; $hisdata->Gems-= 7;]]></code>
    <created>2006-05-01</created>
    <modified>2010-06-21</modified>
  </card>
  <card id="9">
    <name>Stonehenge</name>
    <class>Rare</class>
    <cost>
      <bricks>17</bricks>
      <gems>13</gems>
    </cost>
    <level>2</level>
    <effect><![CDATA[Wall: +15<br />Magic: +2<br />Summons a rare <b>Mage</b>]]></effect>
    <code><![CDATA[
    $mydata->Wall+= 15;
    $mydata->Magic+= 2;
    $nextcard = $this->drawCard($this->getList(['class'=>'Rare', 'keyword'=>'Mage']), $mydata->Hand, $cardpos, 'drawCardList');
]]></code>
    <created>2006-05-01</created>
    <modified>2013-03-31</modified>
  </card>
  <card id="10">
    <name>Iron golem</name>
    <class>Uncommon</class>
    <cost>
      <bricks>18</bricks>
      <recruits>12</recruits>
    </cost>
    <modes>2</modes>
    <level>0</level>
    <keywords>Unliving,Skirmisher</keywords>
    <effect><![CDATA[Attack: 21<br />Mode1:<br />Bricks: +8<br />Mode2:<br />Recruits: +6]]></effect>
    <code><![CDATA[
    $hisdata->attack(21);
    if ($mode == 1) $mydata->Bricks+=8;
    elseif ($mode == 2) $mydata->Recruits+= 6;
]]></code>
    <created>2006-11-14</created>
    <modified>2010-12-24</modified>
  </card>
  <card id="11">
    <name>Meditation</name>
    <class>Uncommon</class>
    <cost>
      <gems>15</gems>
    </cost>
    <level>5</level>
    <keywords>Restoration</keywords>
    <effect><![CDATA[Gems: +25<br />If last card played was a <b>Mage</b><br />Gems: +5]]></effect>
    <code><![CDATA[
    $mydata->Gems+= 25;
    if ($mylast_card->hasKeyword('Mage') and $mylast_action == 'play') {
      $mydata->Gems+= 5;
    }
]]></code>
    <created>2006-05-01</created>
    <modified>2015-09-26</modified>
  </card>
  <card id="12">
    <name>Blacksmith</name>
    <class>Uncommon</class>
    <cost>
      <recruits>10</recruits>
    </cost>
    <level>4</level>
    <effect><![CDATA[Dungeon: +1]]></effect>
    <code><![CDATA[$mydata->Dungeons+= 1;]]></code>
    <created>2006-05-01</created>
    <modified>2006-05-01</modified>
  </card>
  <card id="13">
    <name>Goblin flanker</name>
    <class>Common</class>
    <cost>
      <recruits>1</recruits>
    </cost>
    <level>9</level>
    <keywords>Horde</keywords>
    <effect><![CDATA[Attack: 3<br />If matching card doesn't cost recruits<br />Steals 3 random resources]]></effect>
    <code><![CDATA[
    $hisdata->attack(3);
    if ($this->getCard($hisdata->Hand[$cardpos])->getResources('Recruits') == 0) {
      $mydata->addRandomResources(3);
      $hisdata->addRandomResources(-3);
    }
]]></code>
    <created>2006-05-01</created>
    <modified>2011-12-24</modified>
  </card>
  <card id="14">
    <name>Immolation</name>
    <class>Uncommon</class>
    <cost>
      <gems>13</gems>
    </cost>
    <level>2</level>
    <keywords>Destruction</keywords>
    <effect><![CDATA[Enemy magic: -1]]></effect>
    <code><![CDATA[$hisdata->Magic-= 1;]]></code>
    <created>2006-05-01</created>
    <modified>2007-11-25</modified>
  </card>
  <card id="15">
    <name>Plague</name>
    <class>Uncommon</class>
    <cost>
      <gems>4</gems>
    </cost>
    <level>6</level>
    <effect><![CDATA[Highest facility: -1<br />Enemy highest facility: -1]]></effect>
    <code><![CDATA[$mydata->addHighestFacility(-1); $hisdata->addHighestFacility(-1);]]></code>
    <created>2006-05-01</created>
    <modified>2012-06-24</modified>
  </card>
  <card id="16">
    <name>Mage guild</name>
    <class>Common</class>
    <cost>
      <bricks>5</bricks>
      <gems>2</gems>
    </cost>
    <level>6</level>
    <effect><![CDATA[Tower: +3<br />Stock: +1<br />Summons a <b>Mage</b>]]></effect>
    <code><![CDATA[
    $mydata->Tower+= 3;
    $mydata->addStock(1);
    $nextcard = $this->drawCard($this->getList(['keyword'=>'Mage']), $mydata->Hand, $cardpos, 'drawCardList');
]]></code>
    <created>2006-11-14</created>
    <modified>2007-09-26</modified>
  </card>
  <card id="17">
    <name>Earthquake</name>
    <class>Rare</class>
    <cost>
      <gems>28</gems>
    </cost>
    <level>6</level>
    <keywords>Nature</keywords>
    <effect><![CDATA[Enemy tower and Enemy wall is halved (min 10 damage)]]></effect>
    <code><![CDATA[
    $hisdata->Tower-= max(round($hisdata->Tower/2), 10);
    $hisdata->Wall-= max(round($hisdata->Wall/2), 10);
]]></code>
    <created>2006-05-01</created>
    <modified>2010-09-23</modified>
  </card>
  <card id="18">
    <name>Scout tower</name>
    <class>Common</class>
    <cost>
      <bricks>4</bricks>
    </cost>
    <level>0</level>
    <effect><![CDATA[Tower: +5]]></effect>
    <code><![CDATA[$mydata->Tower+= 5;]]></code>
    <created>2006-05-01</created>
    <modified>2011-12-24</modified>
  </card>
  <card id="19">
    <name>Fortification</name>
    <class>Uncommon</class>
    <cost>
      <bricks>10</bricks>
    </cost>
    <level>0</level>
    <effect><![CDATA[Wall: +25]]></effect>
    <code><![CDATA[$mydata->Wall+= 25;]]></code>
    <created>2006-05-01</created>
    <modified>2011-02-12</modified>
  </card>
  <card id="20">
    <name>Duelist</name>
    <class>Common</class>
    <cost>
      <recruits>10</recruits>
    </cost>
    <level>10</level>
    <keywords>Soldier</keywords>
    <effect><![CDATA[Recruits: +10<br />Discard highest cost non-rare Recruits only card from opponent's hand]]></effect>
    <code><![CDATA[
    $mydata->Recruits+= 10;
    $card_costs = $max_cards = array(); $max = 0;
    for ($i = 1; $i <= 8; $i++) {
      $cur_card = $this->getCard($hisdata->Hand[$i]);
      if ($cur_card->getClass() != 'Rare' and $cur_card->getResources('Bricks') == 0 and $cur_card->getResources('Gems') == 0 and $cur_card->getResources('Recruits') > 0) {
        $cur_cost = $card_costs[$i] = $cur_card->getResources('Recruits');
        if ($cur_cost > $max) {
          $max = $cur_cost;
        }
      }
    }
    if (count($card_costs) > 0) {
      foreach ($card_costs as $i => $cost) {
        if ($cost == $max) {
          $max_cards[] = $i;
        }
      }
      $dis_pos = $max_cards[$this->arrayRand($max_cards)];
      $this->setCard('his', $dis_pos, $this->drawCard($his_deck, $hisdata->Hand, $dis_pos, 'drawCardDifferent'));
    }
]]></code>
    <created>2006-05-01</created>
    <modified>2011-12-24</modified>
  </card>
  <card id="21">
    <name>Stronghold</name>
    <class>Rare</class>
    <cost>
      <bricks>20</bricks>
    </cost>
    <level>0</level>
    <keywords>Far sight</keywords>
    <effect><![CDATA[Tower: +30]]></effect>
    <code><![CDATA[$mydata->Tower+= 30;]]></code>
    <created>2006-05-01</created>
    <modified>2010-09-10</modified>
  </card>
  <card id="22">
    <name>Master bricklayer</name>
    <class>Uncommon</class>
    <cost>
      <bricks>9</bricks>
    </cost>
    <level>3</level>
    <effect><![CDATA[Quarry: +1]]></effect>
    <code><![CDATA[$mydata->Quarry+= 1;]]></code>
    <created>2006-05-01</created>
    <modified>2006-05-01</modified>
  </card>
  <card id="23">
    <name>Caravan</name>
    <class>Common</class>
    <level>0</level>
    <effect><![CDATA[Stock: +1<br />If opponent lowered your stock last round<br />Stock: +1]]></effect>
    <code><![CDATA[
    $tmp = ($mychanges['Bricks'] < 0 or $mychanges['Gems'] < 0 or $mychanges['Recruits'] < 0) ? 2 : 1;
    $mydata->addStock($tmp);
]]></code>
    <created>2006-05-01</created>
    <modified>2008-07-30</modified>
  </card>
  <card id="24">
    <name>Minotaur</name>
    <class>Common</class>
    <cost>
      <recruits>3</recruits>
    </cost>
    <level>6</level>
    <keywords>Beast,Skirmisher</keywords>
    <effect><![CDATA[Attack: 5<br />If Tower < 30<br />Tower: +4]]></effect>
    <code><![CDATA[$hisdata->attack(5); if ($mydata->Tower < 30) $mydata->Tower+= 4;]]></code>
    <created>2006-05-01</created>
    <modified>2015-09-26</modified>
  </card>
  <card id="25">
    <name>Griffin</name>
    <class>Uncommon</class>
    <cost>
      <bricks>4</bricks>
      <recruits>7</recruits>
    </cost>
    <level>5</level>
    <keywords>Beast,Runic,Far sight</keywords>
    <effect><![CDATA[Attack: 14]]></effect>
    <code><![CDATA[$hisdata->attack(14);]]></code>
    <created>2006-05-01</created>
    <modified>2013-07-27</modified>
  </card>
  <card id="26">
    <name>Thief</name>
    <class>Common</class>
    <cost>
      <recruits>3</recruits>
    </cost>
    <level>0</level>
    <keywords>Brigand</keywords>
    <effect><![CDATA[Attack: 1<br />Stock: +1<br />Enemy stock: -1]]></effect>
    <code><![CDATA[$hisdata->attack(1); $mydata->addStock(1); $hisdata->addStock(-1);]]></code>
    <created>2006-05-01</created>
    <modified>2014-12-24</modified>
  </card>
  <card id="27">
    <name>Fairy</name>
    <class>Uncommon</class>
    <cost>
      <gems>6</gems>
    </cost>
    <level>9</level>
    <keywords>Holy,Quick</keywords>
    <effect><![CDATA[Stock: +#<b>Holy</b> in hand]]></effect>
    <code><![CDATA[$mydata->addStock($this->keywordCount($mydata->Hand, 'Holy'));]]></code>
    <created>2006-05-01</created>
    <modified>2012-04-07</modified>
  </card>
  <card id="28">
    <name>Vampire</name>
    <class>Uncommon</class>
    <cost>
      <gems>17</gems>
    </cost>
    <level>0</level>
    <keywords>Undead</keywords>
    <effect><![CDATA[Attack: 29<br />Gems: -7<br />If #<b>Undead</b> in hand < 4<br />Magic: -1]]></effect>
    <code><![CDATA[
    $hisdata->attack(29); $mydata->Gems-= 7;
    if ($this->keywordCount($mydata->Hand, 'Undead') < 4) $mydata->Magic-= 1;
]]></code>
    <created>2006-05-01</created>
    <modified>2010-09-10</modified>
  </card>
  <card id="29">
    <name>Bloody moon</name>
    <class>Uncommon</class>
    <cost>
      <gems>12</gems>
    </cost>
    <level>0</level>
    <keywords>Destruction</keywords>
    <effect><![CDATA[Enemy dungeon: -1]]></effect>
    <code><![CDATA[$hisdata->Dungeons-= 1;]]></code>
    <created>2006-05-01</created>
    <modified>2007-11-25</modified>
  </card>
  <card id="30">
    <name>Magic maelstrom</name>
    <class>Rare</class>
    <cost>
      <gems>1</gems>
    </cost>
    <modes>2</modes>
    <level>6</level>
    <effect><![CDATA[Magic: +2<br />Gems: +30<br />Mode1:<br />Quarry: -1<br />Mode2:<br />Dungeon: -1]]></effect>
    <code><![CDATA[
    $mydata->Magic+= 2; $mydata->Gems+= 30;
    if ($mode == 1) $mydata->Quarry-= 1;
    elseif ($mode == 2) $mydata->Dungeons-= 1;
]]></code>
    <created>2006-05-01</created>
    <modified>2010-09-23</modified>
  </card>
  <card id="31">
    <name>Risen angel</name>
    <class>Uncommon</class>
    <cost>
      <gems>9</gems>
      <recruits>11</recruits>
    </cost>
    <level>6</level>
    <keywords>Undead</keywords>
    <effect><![CDATA[Attack: 22 + N<br />Gems: +N<br />N = #<b>Holy</b> in opponent's hand]]></effect>
    <code><![CDATA[
    $tmp = $this->keywordCount($hisdata->Hand, 'Holy');
    $hisdata->attack(22 + $tmp);
    $mydata->Gems+= $tmp;
]]></code>
    <created>2006-05-01</created>
    <modified>2011-12-24</modified>
  </card>
  <card id="32">
    <name>Crimson hawk</name>
    <class>Rare</class>
    <cost>
      <recruits>8</recruits>
    </cost>
    <level>0</level>
    <keywords>Beast,Far sight</keywords>
    <effect><![CDATA[Attack: 16]]></effect>
    <code><![CDATA[$hisdata->attack(16);]]></code>
    <created>2006-05-01</created>
    <modified>2010-06-21</modified>
  </card>
  <card id="33">
    <name>Beast farm</name>
    <class>Uncommon</class>
    <cost>
      <bricks>10</bricks>
      <recruits>5</recruits>
    </cost>
    <level>4</level>
    <effect><![CDATA[Wall: +13<br />Summons a rare <b>Beast</b>]]></effect>
    <code><![CDATA[
    $mydata->Wall+= 13;
    $nextcard = $this->drawCard($this->getList(['class'=>'Rare', 'keyword'=>'Beast']), $mydata->Hand, $cardpos, 'drawCardList');
]]></code>
    <created>2006-11-14</created>
    <modified>2012-12-24</modified>
  </card>
  <card id="34">
    <name>Book of magic</name>
    <class>Uncommon</class>
    <cost>
      <gems>12</gems>
    </cost>
    <level>5</level>
    <effect><![CDATA[Magic: +1]]></effect>
    <code><![CDATA[$mydata->Magic+= 1;]]></code>
    <created>2006-05-01</created>
    <modified>2006-05-01</modified>
  </card>
  <card id="35">
    <name>Magical tower</name>
    <class>Uncommon</class>
    <cost>
      <bricks>15</bricks>
    </cost>
    <level>0</level>
    <effect><![CDATA[Tower: +15<br />If matching card in opponent's hand costs gems<br />Gems: +10]]></effect>
    <code><![CDATA[
    $mydata->Tower+= 15;
    if ($this->getCard($hisdata->Hand[$cardpos])->getResources('Gems') > 0) {
      $mydata->Gems+= 10;
    }
]]></code>
    <created>2006-05-01</created>
    <modified>2010-01-20</modified>
  </card>
  <card id="36">
    <name>Light cavalry</name>
    <class>Uncommon</class>
    <cost>
      <recruits>15</recruits>
    </cost>
    <level>0</level>
    <keywords>Soldier,Charge (9)</keywords>
    <effect><![CDATA[Attack: 16]]></effect>
    <code><![CDATA[$hisdata->attack(16);]]></code>
    <created>2006-05-01</created>
    <modified>2007-09-26</modified>
  </card>
  <card id="37">
    <name>Mystic strike</name>
    <class>Uncommon</class>
    <cost>
      <gems>6</gems>
    </cost>
    <level>4</level>
    <keywords>Destruction,Banish</keywords>
    <effect><![CDATA[Enemy gems: -12]]></effect>
    <code><![CDATA[$hisdata->Gems-= 12;]]></code>
    <created>2006-05-01</created>
    <modified>2010-11-01</modified>
  </card>
  <card id="38">
    <name>Master thief</name>
    <class>Uncommon</class>
    <cost>
      <recruits>15</recruits>
    </cost>
    <level>10</level>
    <keywords>Brigand</keywords>
    <effect><![CDATA[Stock: +N<br />Enemy stock: -N<br />N = #<b>Brigand</b> in hand]]></effect>
    <code><![CDATA[
    $tmp = $this->keywordCount($mydata->Hand, 'Brigand');
    $mydata->addStock($tmp);
    $hisdata->addStock(-$tmp);
]]></code>
    <created>2006-05-01</created>
    <modified>2012-09-08</modified>
  </card>
  <card id="39">
    <name>Reinforced wall</name>
    <class>Common</class>
    <cost>
      <bricks>2</bricks>
    </cost>
    <level>2</level>
    <keywords>Skirmisher</keywords>
    <effect><![CDATA[Tower: +2<br />Wall: +3]]></effect>
    <code><![CDATA[$mydata->Tower+= 2; $mydata->Wall+= 3;]]></code>
    <created>2006-05-01</created>
    <modified>2011-12-24</modified>
  </card>
  <card id="40">
    <name>Sorrow</name>
    <class>Uncommon</class>
    <cost>
      <gems>12</gems>
    </cost>
    <level>3</level>
    <keywords>Illusion</keywords>
    <effect><![CDATA[Enemy recruits: -20]]></effect>
    <code><![CDATA[$hisdata->Recruits-= 20;]]></code>
    <created>2006-05-01</created>
    <modified>2009-10-26</modified>
  </card>
  <card id="41">
    <name>Stone golem</name>
    <class>Common</class>
    <cost>
      <bricks>8</bricks>
    </cost>
    <modes>2</modes>
    <level>9</level>
    <keywords>Unliving,Skirmisher</keywords>
    <effect><![CDATA[Mode1:<br />Wall: +8<br />Mode2:<br />Enemy wall: -9]]></effect>
    <code><![CDATA[if ($mode == 1) $mydata->Wall+=8; elseif ($mode == 2) $hisdata->Wall-= 9;]]></code>
    <created>2006-11-14</created>
    <modified>2010-12-24</modified>
  </card>
  <card id="42">
    <name>Lady Ellena</name>
    <class>Common</class>
    <cost>
      <recruits>1</recruits>
    </cost>
    <level>3</level>
    <keywords>Far sight</keywords>
    <effect><![CDATA[Attack: 2<br />Summons a <b>Far sight</b>]]></effect>
    <code><![CDATA[
    $hisdata->attack(2);
    $nextcard = $this->drawCard($this->getList(['keyword'=>'Far sight']), $mydata->Hand, $cardpos, 'drawCardList');
]]></code>
    <created>2006-05-01</created>
    <modified>2011-01-24</modified>
  </card>
  <card id="43">
    <name>Blood sacrifice</name>
    <class>Uncommon</class>
    <cost>
      <recruits>5</recruits>
    </cost>
    <level>4</level>
    <keywords>Demonic</keywords>
    <effect><![CDATA[Magic: -1<br />Gems: +25]]></effect>
    <code><![CDATA[$mydata->Magic-= 1; $mydata->Gems+= 25;]]></code>
    <created>2006-05-01</created>
    <modified>2013-12-24</modified>
  </card>
  <card id="44">
    <name>Angel</name>
    <class>Rare</class>
    <cost>
      <gems>8</gems>
    </cost>
    <level>6</level>
    <keywords>Holy,Swift</keywords>
    <effect><![CDATA[Stock: +3N<br />N = #<b>Holy</b> in hand]]></effect>
    <code><![CDATA[$mydata->addStock(3 * $this->keywordCount($mydata->Hand, 'Holy'));]]></code>
    <created>2006-05-01</created>
    <modified>2007-09-26</modified>
  </card>
  <card id="45">
    <name>Marauder</name>
    <class>Common</class>
    <cost>
      <recruits>3</recruits>
    </cost>
    <level>0</level>
    <keywords>Barbarian,Siege</keywords>
    <effect><![CDATA[Attack: 4<br />Enemy tower: -1]]></effect>
    <code><![CDATA[$hisdata->attack(4); $hisdata->Tower-= 1;]]></code>
    <created>2006-05-01</created>
    <modified>2011-09-24</modified>
  </card>
  <card id="46">
    <name>Ogre</name>
    <class>Common</class>
    <cost>
      <recruits>8</recruits>
    </cost>
    <level>0</level>
    <keywords>Horde,Charge (7),Siege</keywords>
    <effect><![CDATA[Enemy wall: -8]]></effect>
    <code><![CDATA[$hisdata->Wall-= 8;]]></code>
    <created>2006-05-01</created>
    <modified>2011-12-24</modified>
  </card>
  <card id="47">
    <name>City walls</name>
    <class>Uncommon</class>
    <cost>
      <bricks>20</bricks>
    </cost>
    <level>0</level>
    <effect><![CDATA[Wall: +35<br />Bricks: +5]]></effect>
    <code><![CDATA[$mydata->Wall+= 35; $mydata->Bricks+= 5;]]></code>
    <created>2006-05-01</created>
    <modified>2011-01-24</modified>
  </card>
  <card id="48">
    <name>School of Restoration</name>
    <class>Common</class>
    <cost>
      <bricks>5</bricks>
      <gems>2</gems>
    </cost>
    <level>6</level>
    <effect><![CDATA[Tower: +4<br />Stock: +1<br />Summons a <b>Restoration</b>]]></effect>
    <code><![CDATA[
    $mydata->Tower+= 4;
    $mydata->addStock(1);
    $nextcard = $this->drawCard($this->getList(['keyword'=>'Restoration']), $mydata->Hand, $cardpos, 'drawCardList');
]]></code>
    <created>2006-11-14</created>
    <modified>2015-09-26</modified>
  </card>
  <card id="49">
    <name>Magical clay</name>
    <class>Uncommon</class>
    <cost>
      <gems>5</gems>
    </cost>
    <level>0</level>
    <keywords>Restoration</keywords>
    <effect><![CDATA[Bricks: +10<br />If last card played was a <b>Mage</b><br />Bricks: +5]]></effect>
    <code><![CDATA[
    $mydata->Bricks+= 10;
    if ($mylast_card->hasKeyword('Mage') and $mylast_action == 'play')
      $mydata->Bricks+= 5;
]]></code>
    <created>2006-05-01</created>
    <modified>2009-04-11</modified>
  </card>
  <card id="50">
    <name>Magical steel</name>
    <class>Uncommon</class>
    <cost>
      <gems>6</gems>
    </cost>
    <level>8</level>
    <keywords>Restoration</keywords>
    <effect><![CDATA[Recruits: +10<br />If last card played was a <b>Mage</b><br />Recruits: +5]]></effect>
    <code><![CDATA[
    $mydata->Recruits+= 10;
    if ($mylast_card->hasKeyword('Mage') and $mylast_action == 'play') {
      $mydata->Recruits+= 5;
    }
]]></code>
    <created>2006-05-01</created>
    <modified>2009-04-11</modified>
  </card>
  <card id="51">
    <name>Samurai</name>
    <class>Uncommon</class>
    <level>10</level>
    <effect><![CDATA[Discard highest cost non-<b>Durable</b> keyword card from opponent's hand]]></effect>
    <code><![CDATA[
    $card_costs = $max_cards = array(); $max = 0;
    for ($i = 1; $i <= 8; $i++) {
      $cur_card = $this->getCard($hisdata->Hand[$i]);
      if (!$cur_card->hasKeyword('Durable') and $cur_card->hasKeyword('any')) {
        $cur_cost = $card_costs[$i] = $cur_card->getResources();
        if ($cur_cost > $max) {
          $max = $cur_cost;
        }
      }
    }
    if (count($card_costs) > 0) {
      foreach ($card_costs as $i => $cost) {
        if ($cost == $max) {
          $max_cards[] = $i;
        }
      }
      $dis_pos = $max_cards[$this->arrayRand($max_cards)];
      $this->setCard('his', $dis_pos, $this->drawCard($his_deck, $hisdata->Hand, $dis_pos, 'drawCardDifferent'));
    }
]]></code>
    <created>2006-05-01</created>
    <modified>2010-11-01</modified>
  </card>
  <card id="52">
    <name>Pirates</name>
    <class>Uncommon</class>
    <cost>
      <recruits>10</recruits>
    </cost>
    <level>0</level>
    <keywords>Brigand</keywords>
    <effect><![CDATA[Attack: 9<br />Enemy stock: -3]]></effect>
    <code><![CDATA[$hisdata->attack(9); $hisdata->addStock(-3);]]></code>
    <created>2006-05-01</created>
    <modified>2012-09-08</modified>
  </card>
  <card id="53">
    <name>Sorceress</name>
    <class>Uncommon</class>
    <cost>
      <gems>11</gems>
    </cost>
    <level>0</level>
    <keywords>Mage,Swift</keywords>
    <effect><![CDATA[Attack: 6 + #Magic]]></effect>
    <code><![CDATA[$hisdata->attack(6 + $mydata->Magic);]]></code>
    <created>2006-05-01</created>
    <modified>2015-08-01</modified>
  </card>
  <card id="54">
    <name>Battering ram</name>
    <class>Common</class>
    <cost>
      <recruits>5</recruits>
    </cost>
    <level>0</level>
    <keywords>Siege</keywords>
    <effect><![CDATA[Enemy wall: -10]]></effect>
    <code><![CDATA[$hisdata->Wall-= 10;]]></code>
    <created>2006-05-01</created>
    <modified>2011-04-24</modified>
  </card>
  <card id="55">
    <name>School of Nature</name>
    <class>Common</class>
    <cost>
      <bricks>6</bricks>
      <gems>3</gems>
    </cost>
    <level>8</level>
    <effect><![CDATA[Tower: +5<br />Stock: +1<br />Summons a <b>Nature</b>]]></effect>
    <code><![CDATA[
    $mydata->Tower+= 5;
    $mydata->addStock(1);
    $nextcard = $this->drawCard($this->getList(['keyword'=>'Nature']), $mydata->Hand, $cardpos, 'drawCardList');
]]></code>
    <created>2006-11-14</created>
    <modified>2010-02-27</modified>
  </card>
  <card id="56">
    <name>Parapet</name>
    <class>Uncommon</class>
    <cost>
      <bricks>7</bricks>
    </cost>
    <level>2</level>
    <effect><![CDATA[Tower: +12]]></effect>
    <code><![CDATA[$mydata->Tower+= 12;]]></code>
    <created>2006-05-01</created>
    <modified>2011-01-24</modified>
  </card>
  <card id="57">
    <name>Gate</name>
    <class>Common</class>
    <cost>
      <bricks>3</bricks>
    </cost>
    <level>0</level>
    <effect><![CDATA[Wall: +7]]></effect>
    <code><![CDATA[$mydata->Wall+= 7;]]></code>
    <created>2006-05-01</created>
    <modified>2006-05-01</modified>
  </card>
  <card id="58">
    <name>Academy of Destruction</name>
    <class>Uncommon</class>
    <cost>
      <bricks>8</bricks>
      <gems>5</gems>
    </cost>
    <level>0</level>
    <effect><![CDATA[Tower: +6<br />Stock: +2<br />Summons non-common <b>Destruction</b>]]></effect>
    <code><![CDATA[
    $mydata->Tower+= 6;
    $mydata->addStock(2);
    $uncommon = $this->getList(['class'=>'Uncommon', 'keyword'=>'Destruction']);
    $rare = $this->getList(['class'=>'Rare', 'keyword'=>'Destruction']);
    $nextcard = $this->drawCard(array_merge($uncommon, $rare), $mydata->Hand, $cardpos, 'drawCardList');
]]></code>
    <created>2006-11-14</created>
    <modified>2015-09-26</modified>
  </card>
  <card id="59">
    <name>Flame spitter</name>
    <class>Uncommon</class>
    <cost>
      <recruits>8</recruits>
    </cost>
    <level>4</level>
    <effect><![CDATA[Enemy tower: -9]]></effect>
    <code><![CDATA[$hisdata->Tower-= 9;]]></code>
    <created>2006-05-01</created>
    <modified>2007-08-18</modified>
  </card>
  <card id="60">
    <name>Dwarven warriors</name>
    <class>Common</class>
    <cost>
      <recruits>3</recruits>
    </cost>
    <level>0</level>
    <keywords>Runic</keywords>
    <effect><![CDATA[Attack: 4<br />Bricks: +3]]></effect>
    <code><![CDATA[$hisdata->attack(4); $mydata->Bricks+= 3;]]></code>
    <created>2006-05-01</created>
    <modified>2011-04-24</modified>
  </card>
  <card id="61">
    <name>Ether dragon</name>
    <class>Rare</class>
    <cost>
      <gems>25</gems>
      <recruits>15</recruits>
    </cost>
    <level>0</level>
    <keywords>Dragon,Banish</keywords>
    <effect><![CDATA[Attack: 50]]></effect>
    <code><![CDATA[$hisdata->attack(50);]]></code>
    <created>2006-05-01</created>
    <modified>2010-12-24</modified>
  </card>
  <card id="62">
    <name>Catapult</name>
    <class>Uncommon</class>
    <cost>
      <recruits>16</recruits>
    </cost>
    <level>1</level>
    <keywords>Siege</keywords>
    <effect><![CDATA[Enemy tower: -14]]></effect>
    <code><![CDATA[$hisdata->Tower-= 14;]]></code>
    <created>2006-05-01</created>
    <modified>2011-04-24</modified>
  </card>
  <card id="63">
    <name>Dark ritual</name>
    <class>Rare</class>
    <cost>
      <gems>15</gems>
    </cost>
    <level>5</level>
    <keywords>Demonic</keywords>
    <effect><![CDATA[Facilities: -1<br />Enemy tower: -24]]></effect>
    <code><![CDATA[$mydata->addFacilities(-1); $hisdata->Tower-= 24;]]></code>
    <created>2006-05-01</created>
    <modified>2013-12-24</modified>
  </card>
  <card id="64">
    <name>Enlightenment</name>
    <class>Rare</class>
    <level>8</level>
    <effect><![CDATA[Tower: +25<br />Facilities: +1<br />Enemy tower: +25<br />Enemy facilities: +1]]></effect>
    <code><![CDATA[
    $mydata->Tower+= 25;
    $mydata->addFacilities(1);
    $hisdata->Tower+= 25;
    $hisdata->addFacilities(1);
]]></code>
    <created>2006-05-01</created>
    <modified>2010-06-21</modified>
  </card>
  <card id="65">
    <name>Academy of Illusion</name>
    <class>Uncommon</class>
    <cost>
      <bricks>9</bricks>
      <gems>6</gems>
    </cost>
    <level>6</level>
    <effect><![CDATA[Tower: +7<br />Stock: +3<br />Summons non-common <b>Illusion</b>]]></effect>
    <code><![CDATA[
    $mydata->Tower+= 7;
    $mydata->addStock(3);
    $uncommon = $this->getList(['class'=>'Uncommon', 'keyword'=>'Illusion']);
    $rare = $this->getList(['class'=>'Rare', 'keyword'=>'Illusion']);
    $nextcard = $this->drawCard(array_merge($uncommon, $rare), $mydata->Hand, $cardpos, 'drawCardList');
]]></code>
    <created>2006-11-14</created>
    <modified>2015-09-26</modified>
  </card>
  <card id="66">
    <name>Manticore</name>
    <class>Rare</class>
    <cost>
      <recruits>10</recruits>
    </cost>
    <level>0</level>
    <keywords>Beast,Frenzy</keywords>
    <effect><![CDATA[Attack: 18]]></effect>
    <code><![CDATA[$hisdata->attack(18);]]></code>
    <created>2006-05-01</created>
    <modified>2009-06-22</modified>
  </card>
  <card id="67">
    <name>Magical palace</name>
    <class>Rare</class>
    <cost>
      <gems>35</gems>
    </cost>
    <level>0</level>
    <effect><![CDATA[Tower: +40]]></effect>
    <code><![CDATA[$mydata->Tower+= 40;]]></code>
    <created>2006-05-01</created>
    <modified>2009-10-26</modified>
  </card>
  <card id="68">
    <name>Gladiator</name>
    <class>Uncommon</class>
    <cost>
      <recruits>1</recruits>
    </cost>
    <level>6</level>
    <keywords>Barbarian</keywords>
    <effect><![CDATA[Attack: 3<br />Recruits: +2<br />Summons a non-common <b>Barbarian</b>]]></effect>
    <code><![CDATA[
    $hisdata->attack(3);
    $mydata->Recruits+= 2;
    $uncommon = $this->getList(['class'=>'Uncommon', 'keyword'=>'Barbarian']);
    $rare = $this->getList(['class'=>'Rare', 'keyword'=>'Barbarian']);
    $nextcard = $this->drawCard(array_merge($uncommon, $rare), $mydata->Hand, $cardpos, 'drawCardList');
]]></code>
    <created>2006-05-01</created>
    <modified>2008-07-30</modified>
  </card>
  <card id="69">
    <name>Beast mistress</name>
    <class>Rare</class>
    <cost>
      <recruits>5</recruits>
    </cost>
    <level>0</level>
    <keywords>Beast,Frenzy</keywords>
    <effect><![CDATA[Attack: 12]]></effect>
    <code><![CDATA[$hisdata->attack(12);]]></code>
    <created>2006-05-01</created>
    <modified>2011-01-24</modified>
  </card>
  <card id="70">
    <name>Stormwind</name>
    <class>Rare</class>
    <cost>
      <bricks>15</bricks>
      <gems>10</gems>
    </cost>
    <level>0</level>
    <effect><![CDATA[Tower: +20<br />Magic: +2]]></effect>
    <code><![CDATA[$mydata->Tower+= 20; $mydata->Magic+= 2;]]></code>
    <created>2006-05-01</created>
    <modified>2010-03-14</modified>
  </card>
  <card id="71">
    <name>Dwarven miners</name>
    <class>Common</class>
    <cost>
      <bricks>3</bricks>
      <recruits>2</recruits>
    </cost>
    <level>0</level>
    <keywords>Runic</keywords>
    <effect><![CDATA[Attack: 3<br />Wall: +5]]></effect>
    <code><![CDATA[$hisdata->attack(3); $mydata->Wall+= 5;]]></code>
    <created>2006-05-01</created>
    <modified>2011-04-24</modified>
  </card>
  <card id="72">
    <name>Tower guards</name>
    <class>Uncommon</class>
    <cost>
      <recruits>9</recruits>
    </cost>
    <level>7</level>
    <keywords>Soldier,Far sight</keywords>
    <effect><![CDATA[Tower: +10]]></effect>
    <code><![CDATA[$mydata->Tower+= 10;]]></code>
    <created>2006-05-01</created>
    <modified>2010-06-21</modified>
  </card>
  <card id="73">
    <name>Giant spider</name>
    <class>Uncommon</class>
    <cost>
      <recruits>7</recruits>
    </cost>
    <level>2</level>
    <keywords>Horde,Frenzy</keywords>
    <effect><![CDATA[Attack: 10<br />Wall: +5<br />Enemy bricks: -5]]></effect>
    <code><![CDATA[$hisdata->attack(10); $mydata->Wall+= 5; $hisdata->Bricks-= 5;]]></code>
    <created>2006-05-01</created>
    <modified>2013-07-27</modified>
  </card>
  <card id="74">
    <name>Highlander</name>
    <class>Rare</class>
    <cost>
      <recruits>14</recruits>
    </cost>
    <level>0</level>
    <keywords>Barbarian,Skirmisher</keywords>
    <effect><![CDATA[Attack: 25]]></effect>
    <code><![CDATA[$hisdata->attack(25);]]></code>
    <created>2006-05-01</created>
    <modified>2009-04-11</modified>
  </card>
  <card id="75">
    <name>White crocodile</name>
    <class>Rare</class>
    <cost>
      <recruits>7</recruits>
    </cost>
    <level>0</level>
    <keywords>Beast,Frenzy</keywords>
    <effect><![CDATA[Attack: 15]]></effect>
    <code><![CDATA[$hisdata->attack(15);]]></code>
    <created>2006-05-01</created>
    <modified>2009-06-22</modified>
  </card>
  <card id="76">
    <name>Ninja</name>
    <class>Uncommon</class>
    <modes>8</modes>
    <level>8</level>
    <keywords>Far sight</keywords>
    <effect><![CDATA[Production x0<br />Enemy tower: -3<br />Replace a card in hand with self]]></effect>
    <code><![CDATA[
    $production->multiply(0);
    $hisdata->Tower-= 3;
    if ($mode == $cardpos) $nextcard = 0;
    else $this->replaceCard('my', $mode, $card->id());
]]></code>
    <created>2006-05-01</created>
    <modified>2011-12-24</modified>
  </card>
  <card id="77">
    <name>Amazon tribe</name>
    <class>Common</class>
    <cost>
      <bricks>2</bricks>
      <gems>2</gems>
      <recruits>2</recruits>
    </cost>
    <level>8</level>
    <keywords>Barbarian,Skirmisher</keywords>
    <effect><![CDATA[Attack: 6<br />Recruits: +N<br />N = #<b>Barbarian</b> in hand (max 4)]]></effect>
    <code><![CDATA[
    $hisdata->attack(6);
    $mydata->Recruits+= min($this->keywordCount($mydata->Hand, 'Barbarian'), 4);
]]></code>
    <created>2006-05-01</created>
    <modified>2012-04-07</modified>
  </card>
  <card id="78">
    <name>Unicorn</name>
    <class>Common</class>
    <cost>
      <recruits>5</recruits>
    </cost>
    <level>6</level>
    <keywords>Banish,Charge (2)</keywords>
    <effect><![CDATA[Attack: 5<br />Gems: +3]]></effect>
    <code><![CDATA[$hisdata->attack(5); $mydata->Gems+= 3;]]></code>
    <created>2006-05-01</created>
    <modified>2010-11-01</modified>
  </card>
  <card id="79">
    <name>Erosion</name>
    <class>Common</class>
    <cost>
      <gems>6</gems>
    </cost>
    <level>0</level>
    <keywords>Destruction</keywords>
    <effect><![CDATA[Enemy bricks: -10]]></effect>
    <code><![CDATA[$hisdata->Bricks-= 10;]]></code>
    <created>2006-05-01</created>
    <modified>2011-01-24</modified>
  </card>
  <card id="80">
    <name>Catastrophe</name>
    <class>Rare</class>
    <cost>
      <gems>25</gems>
    </cost>
    <level>9</level>
    <keywords>Destruction,Nature</keywords>
    <effect><![CDATA[Each player suffers 4 damage for each facility and 10 resources he has]]></effect>
    <code><![CDATA[
    $my_fac = $mydata->Quarry + $mydata->Magic + $mydata->Dungeons;
    $his_fac = $hisdata->Quarry + $hisdata->Magic + $hisdata->Dungeons;
    $my_res = $mydata->Bricks + $mydata->Gems + $mydata->Recruits;
    $his_res = $hisdata->Bricks + $hisdata->Gems + $hisdata->Recruits;
    $mydata->attack(($my_fac + floor($my_res / 10)) * 4);
    $hisdata->attack(($his_fac + floor($his_res / 10)) * 4);
]]></code>
    <created>2006-05-01</created>
    <modified>2012-09-08</modified>
  </card>
  <card id="81">
    <name>New era</name>
    <class>Rare</class>
    <cost>
      <gems>1</gems>
    </cost>
    <level>7</level>
    <effect><![CDATA[Facilities: +2<br />Stock: = 0<br />Enemy facilities: +2<br />Enemy stock: = 0]]></effect>
    <code><![CDATA[
    $mydata->addFacilities(2);
    $mydata->setStock(0);
    $hisdata->addFacilities(2);
    $hisdata->setStock(0);
]]></code>
    <created>2006-05-01</created>
    <modified>2008-12-24</modified>
  </card>
  <card id="82">
    <name>Wizard</name>
    <class>Common</class>
    <cost>
      <gems>1</gems>
    </cost>
    <level>2</level>
    <keywords>Mage,Far sight</keywords>
    <effect><![CDATA[Attack: #Magic]]></effect>
    <code><![CDATA[$hisdata->attack($mydata->Magic);]]></code>
    <created>2006-05-01</created>
    <modified>2010-06-21</modified>
  </card>
  <card id="83">
    <name>Valkyrie</name>
    <class>Uncommon</class>
    <cost>
      <recruits>14</recruits>
    </cost>
    <level>0</level>
    <keywords>Banish,Charge (7)</keywords>
    <effect><![CDATA[Attack: 15<br />Dungeon: +1<br />Enemy dungeon: +1]]></effect>
    <code><![CDATA[
    $hisdata->attack(15);
    $mydata->Dungeons+= 1; $hisdata->Dungeons+= 1;
]]></code>
    <created>2006-05-01</created>
    <modified>2010-11-01</modified>
  </card>
  <card id="84">
    <name>Cold arrow</name>
    <class>Uncommon</class>
    <cost>
      <gems>8</gems>
    </cost>
    <level>0</level>
    <keywords>Destruction,Banish</keywords>
    <effect><![CDATA[Attack: 8<br />Enemy gems: -8]]></effect>
    <code><![CDATA[$hisdata->attack(8); $hisdata->Gems-= 8;]]></code>
    <created>2006-05-01</created>
    <modified>2010-11-01</modified>
  </card>
  <card id="85">
    <name>Heavenly warrior</name>
    <class>Uncommon</class>
    <cost>
      <recruits>10</recruits>
    </cost>
    <level>6</level>
    <keywords>Holy,Far sight</keywords>
    <effect><![CDATA[Attack: 10<br />Enemy gems: -8]]></effect>
    <code><![CDATA[$hisdata->attack(10); $hisdata->Gems-= 8;]]></code>
    <created>2006-05-01</created>
    <modified>2010-06-21</modified>
  </card>
  <card id="86">
    <name>Bone dragon</name>
    <class>Rare</class>
    <cost>
      <gems>30</gems>
      <recruits>10</recruits>
    </cost>
    <level>0</level>
    <keywords>Dragon,Undead</keywords>
    <effect><![CDATA[Attack: 40<br />Enemy gems: -20]]></effect>
    <code><![CDATA[$hisdata->attack(40); $hisdata->Gems-= 20;]]></code>
    <created>2006-05-01</created>
    <modified>2007-05-08</modified>
  </card>
  <card id="87">
    <name>Pyramids</name>
    <class>Uncommon</class>
    <cost>
      <bricks>60</bricks>
    </cost>
    <level>10</level>
    <effect><![CDATA[Tower: +60<br />If Wall < 40<br />Wall:= 40]]></effect>
    <code><![CDATA[$mydata->Tower+= 60; if ($mydata->Wall < 40) $mydata->Wall = 40;]]></code>
    <created>2006-05-01</created>
    <modified>2012-09-08</modified>
  </card>
  <card id="88">
    <name>Undead host</name>
    <class>Uncommon</class>
    <cost>
      <gems>35</gems>
      <recruits>35</recruits>
    </cost>
    <level>9</level>
    <keywords>Undead</keywords>
    <effect><![CDATA[Attack: 35 + 7N<br />N = #<b>Undead</b> in hand]]></effect>
    <code><![CDATA[
    $tmp = ($this->keywordCount($mydata->Hand, 'Undead') * 7) + 35;
    $hisdata->attack($tmp);
]]></code>
    <created>2006-05-01</created>
    <modified>2012-09-08</modified>
  </card>
  <card id="89">
    <name>Orc regiment</name>
    <class>Uncommon</class>
    <cost>
      <recruits>60</recruits>
    </cost>
    <level>0</level>
    <keywords>Horde</keywords>
    <effect><![CDATA[Attack: 80<br />If matching card or its neighbours are zero cost<br />Attack: 20]]></effect>
    <code><![CDATA[
    $hisdata->attack(80);
    if ($this->getCard($hisdata->Hand[$cardpos])->getResources() == 0 or
      (isset($hisdata->Hand[$cardpos + 1]) and $this->getCard($hisdata->Hand[$cardpos + 1])->getResources() == 0) or 
      (isset($hisdata->Hand[$cardpos - 1]) and $this->getCard($hisdata->Hand[$cardpos - 1])->getResources() == 0)) {
      $hisdata->attack(20);
    }
]]></code>
    <created>2006-05-01</created>
    <modified>2012-09-08</modified>
  </card>
  <card id="90">
    <name>Paladin</name>
    <class>Uncommon</class>
    <cost>
      <recruits>10</recruits>
    </cost>
    <level>5</level>
    <keywords>Holy,Soldier,Banish</keywords>
    <effect><![CDATA[Attack: 10<br />Gems: +6]]></effect>
    <code><![CDATA[$hisdata->attack(10); $mydata->Gems+= 6;]]></code>
    <created>2006-05-01</created>
    <modified>2010-09-10</modified>
  </card>
  <card id="91">
    <name>Corrosion</name>
    <class>Common</class>
    <cost>
      <gems>3</gems>
    </cost>
    <level>0</level>
    <keywords>Destruction</keywords>
    <effect><![CDATA[Enemy recruits: -6]]></effect>
    <code><![CDATA[$hisdata->Recruits-= 6;]]></code>
    <created>2006-05-01</created>
    <modified>2011-04-24</modified>
  </card>
  <card id="92">
    <name>Dragon golem</name>
    <class>Rare</class>
    <cost>
      <bricks>45</bricks>
    </cost>
    <modes>2</modes>
    <level>6</level>
    <keywords>Dragon,Unliving,Charge (16)</keywords>
    <effect><![CDATA[Mode1:<br />Attack: 55<br />Mode2:<br />Wall: +65]]></effect>
    <code><![CDATA[
    if ($mode == 1) $hisdata->attack(55);
    elseif ($mode == 2) $mydata->Wall+= 65;
]]></code>
    <created>2006-05-01</created>
    <modified>2010-12-24</modified>
  </card>
  <card id="93">
    <name>Clay golem</name>
    <class>Uncommon</class>
    <cost>
      <bricks>30</bricks>
    </cost>
    <modes>3</modes>
    <level>10</level>
    <keywords>Unliving,Siege</keywords>
    <effect><![CDATA[Mode1:<br />Attack: 25<br />Mode2:<br />Wall: +32<br />Mode3:<br />Enemy wall: -35]]></effect>
    <code><![CDATA[
    if ($mode == 1) $hisdata->attack(25);
    elseif ($mode == 2) $mydata->Wall+= 32;
    elseif ($mode == 3) $hisdata->Wall-= 35;
]]></code>
    <created>2006-05-01</created>
    <modified>2012-09-08</modified>
  </card>
  <card id="94">
    <name>Stone gargoyle</name>
    <class>Common</class>
    <cost>
      <bricks>16</bricks>
    </cost>
    <modes>2</modes>
    <level>10</level>
    <keywords>Unliving,Far sight</keywords>
    <effect><![CDATA[Mode1:<br />Attack: 12<br />Mode2:<br />Enemy tower: -7]]></effect>
    <code><![CDATA[
    if ($mode == 1) $hisdata->attack(12);
    elseif ($mode == 2) $hisdata->Tower-= 7;
]]></code>
    <created>2006-05-01</created>
    <modified>2010-06-21</modified>
  </card>
  <card id="95">
    <name>Archer</name>
    <class>Common</class>
    <cost>
      <recruits>2</recruits>
    </cost>
    <level>2</level>
    <keywords>Soldier</keywords>
    <effect><![CDATA[Enemy tower: -3]]></effect>
    <code><![CDATA[$hisdata->Tower-= 3;]]></code>
    <created>2006-05-01</created>
    <modified>2007-08-18</modified>
  </card>
  <card id="96">
    <name>Pegasus</name>
    <class>Uncommon</class>
    <level>0</level>
    <keywords>Quick,Aria</keywords>
    <effect><![CDATA[Gems: +3]]></effect>
    <code><![CDATA[$mydata->Gems+= 3;]]></code>
    <created>2006-05-01</created>
    <modified>2012-09-08</modified>
  </card>
  <card id="97">
    <name>Conscript</name>
    <class>Common</class>
    <level>2</level>
    <effect><![CDATA[Attack: 1<br />If last card played was a zero cost card<br />Summons a non-common zero cost card]]></effect>
    <code><![CDATA[
    $hisdata->attack(1);
    if ($mylast_card->getResources() == 0 and $mylast_action == 'play' and $mylast_card->id() > 0) {
      $uncommon = $this->getList(['class'=>'Uncommon', 'cost'=>'Zero']);
      $rare = $this->getList(['class'=>'Rare', 'cost'=>'Zero']);
      $nextcard = $this->drawCard(array_merge($uncommon, $rare), $mydata->Hand, $cardpos, 'drawCardList');
    }
 ]]></code>
    <created>2006-05-01</created>
    <modified>2011-12-24</modified>
  </card>
  <card id="98">
    <name>Murderer</name>
    <class>Uncommon</class>
    <cost>
      <recruits>18</recruits>
    </cost>
    <level>0</level>
    <keywords>Horde</keywords>
    <effect><![CDATA[Attack: 10<br />Enemy magic: -1]]></effect>
    <code><![CDATA[$hisdata->attack(10); $hisdata->Magic-= 1;]]></code>
    <created>2006-05-01</created>
    <modified>2011-12-24</modified>
  </card>
  <card id="99">
    <name>Magic rift</name>
    <class>Rare</class>
    <cost>
      <gems>12</gems>
    </cost>
    <level>7</level>
    <effect><![CDATA[Dungeon: +1<br />Magic: +1<br />Gems: +25<br />Enemy dungeon: +1<br />Enemy magic: +1<br />Enemy gems: -25]]></effect>
    <code><![CDATA[
    $mydata->Dungeons+= 1; $mydata->Magic+= 1; $mydata->Gems+= 25;
    $hisdata->Dungeons+= 1; $hisdata->Magic+= 1; $hisdata->Gems-= 25;
]]></code>
    <created>2006-05-01</created>
    <modified>2010-07-22</modified>
  </card>
  <card id="100">
    <name>Wonder</name>
    <class>Rare</class>
    <level>5</level>
    <effect><![CDATA[Quarry: +5<br />Enemy quarry: +5]]></effect>
    <code><![CDATA[$mydata->Quarry+= 5; $hisdata->Quarry+= 5;]]></code>
    <created>2006-05-01</created>
    <modified>2011-01-01</modified>
  </card>
  <card id="101">
    <name>Crypt sentry</name>
    <class>Common</class>
    <cost>
      <bricks>6</bricks>
      <recruits>4</recruits>
    </cost>
    <level>9</level>
    <keywords>Undead</keywords>
    <effect><![CDATA[Stock: +#<b>Undead</b> in hand (max 6)]]></effect>
    <code><![CDATA[
    $mydata->addStock(min($this->keywordCount($mydata->Hand, 'Undead'), 6));
]]></code>
    <created>2006-11-14</created>
    <modified>2011-09-24</modified>
  </card>
  <card id="102">
    <name>Honor guard</name>
    <class>Uncommon</class>
    <cost>
      <recruits>20</recruits>
    </cost>
    <level>2</level>
    <keywords>Soldier</keywords>
    <effect><![CDATA[Tower: +10<br />Recruits: +20]]></effect>
    <code><![CDATA[$mydata->Tower+= 10; $mydata->Recruits+= 20;]]></code>
    <created>2006-05-01</created>
    <modified>2011-12-24</modified>
  </card>
  <card id="103">
    <name>Vampire countess</name>
    <class>Uncommon</class>
    <cost>
      <gems>3</gems>
    </cost>
    <level>10</level>
    <keywords>Undead</keywords>
    <effect><![CDATA[Stock: +N<br />If N > 6<br />Magic: +1<br />N = #<b>Undead</b> in hand]]></effect>
    <code><![CDATA[
    $tmp = $this->keywordCount($mydata->Hand, 'Undead');
    $mydata->addStock($tmp);
    if ($tmp > 6) $mydata->Magic+= 1;
]]></code>
    <created>2006-11-14</created>
    <modified>2007-11-25</modified>
  </card>
  <card id="104">
    <name>Moat</name>
    <class>Uncommon</class>
    <cost>
      <bricks>10</bricks>
    </cost>
    <level>8</level>
    <keywords>Durable</keywords>
    <effect><![CDATA[Wall: +15<br />If last card played wasn't Moat<br />Wall: +5]]></effect>
    <code><![CDATA[$mydata->Wall+= ($mylast_action == 'play' && $mylast_card->id() == $card->id()) ? 15 : 20;]]></code>
    <created>2006-05-01</created>
    <modified>2015-08-01</modified>
  </card>
  <card id="105">
    <name>Rejuvenation</name>
    <class>Uncommon</class>
    <cost>
      <gems>8</gems>
    </cost>
    <level>7</level>
    <keywords>Restoration</keywords>
    <effect><![CDATA[Summons the last card]]></effect>
    <code><![CDATA[if ($mylast_card->id() > 0) $nextcard = $mylast_card->id();]]></code>
    <created>2006-05-01</created>
    <modified>2011-12-24</modified>
  </card>
  <card id="106">
    <name>Troll</name>
    <class>Uncommon</class>
    <cost>
      <recruits>6</recruits>
    </cost>
    <level>8</level>
    <keywords>Durable,Horde,Enduring (9)</keywords>
    <effect><![CDATA[Attack: 5]]></effect>
    <code><![CDATA[$hisdata->attack(5);]]></code>
    <created>2006-05-01</created>
    <modified>2011-12-24</modified>
  </card>
  <card id="107">
    <name>Alchemy</name>
    <class>Uncommon</class>
    <cost>
      <gems>1</gems>
    </cost>
    <level>7</level>
    <keywords>Restoration,Durable</keywords>
    <effect><![CDATA[Bricks: +2<br />Recruits: +2]]></effect>
    <code><![CDATA[$mydata->Bricks+= 2; $mydata->Recruits+= 2;]]></code>
    <created>2006-05-01</created>
    <modified>2007-08-18</modified>
  </card>
  <card id="108">
    <name>Archmage</name>
    <class>Rare</class>
    <cost>
      <gems>16</gems>
    </cost>
    <modes>2</modes>
    <level>0</level>
    <keywords>Mage</keywords>
    <effect><![CDATA[Tower: +20<br />Summons<br />Mode1:<br />last card<br />Mode2:<br />Ice queen]]></effect>
    <code><![CDATA[
    $mydata->Tower+= 20;
    if ($mode == 1 and $mylast_card->id() > 0) $nextcard = $mylast_card->id();
    elseif ($mode == 2) $nextcard = 425;
]]></code>
    <created>2006-05-01</created>
    <modified>2013-03-31</modified>
  </card>
  <card id="109">
    <name>Red mage</name>
    <class>Uncommon</class>
    <cost>
      <gems>14</gems>
    </cost>
    <level>0</level>
    <keywords>Mage,Swift</keywords>
    <effect><![CDATA[Attack: 8<br />Enemy stock: -3]]></effect>
    <code><![CDATA[
    $hisdata->attack(8);
    $hisdata->addStock(-3);
]]></code>
    <created>2006-05-01</created>
    <modified>2011-09-24</modified>
  </card>
  <card id="110">
    <name>Dark knight</name>
    <class>Rare</class>
    <cost>
      <gems>15</gems>
      <recruits>15</recruits>
    </cost>
    <level>0</level>
    <keywords>Undead,Skirmisher</keywords>
    <effect><![CDATA[Attack: 35<br />Enemy recruits: -10]]></effect>
    <code><![CDATA[$hisdata->attack(35); $hisdata->Recruits-= 10;]]></code>
    <created>2006-05-01</created>
    <modified>2010-12-24</modified>
  </card>
  <card id="111">
    <name>Elven fighter</name>
    <class>Common</class>
    <cost>
      <recruits>5</recruits>
    </cost>
    <level>1</level>
    <keywords>Alliance</keywords>
    <effect><![CDATA[Attack: 7<br />Gems: +2]]></effect>
    <code><![CDATA[$hisdata->attack(7); $mydata->Gems+= 2;]]></code>
    <created>2006-05-01</created>
    <modified>2011-01-24</modified>
  </card>
  <card id="112">
    <name>Ghoul</name>
    <class>Common</class>
    <cost>
      <gems>5</gems>
      <recruits>5</recruits>
    </cost>
    <level>3</level>
    <keywords>Undead,Frenzy</keywords>
    <effect><![CDATA[Attack: 10]]></effect>
    <code><![CDATA[$hisdata->attack(10);]]></code>
    <created>2006-05-01</created>
    <modified>2012-12-24</modified>
  </card>
  <card id="113">
    <name>Skeleton warriors</name>
    <class>Common</class>
    <cost>
      <gems>3</gems>
      <recruits>3</recruits>
    </cost>
    <level>0</level>
    <keywords>Undead</keywords>
    <effect><![CDATA[Attack: 7<br />If Wall < 12<br />Wall: +4]]></effect>
    <code><![CDATA[$hisdata->attack(7); if ($mydata->Wall < 12) $mydata->Wall+= 4;]]></code>
    <created>2006-05-01</created>
    <modified>2011-12-24</modified>
  </card>
  <card id="114">
    <name>Drowner</name>
    <class>Common</class>
    <cost>
      <gems>2</gems>
      <recruits>2</recruits>
    </cost>
    <level>4</level>
    <keywords>Aqua,Undead</keywords>
    <effect><![CDATA[Attack: 5<br />Wall: +2]]></effect>
    <code><![CDATA[$hisdata->attack(5); $mydata->Wall+= 2;]]></code>
    <created>2006-05-01</created>
    <modified>2011-09-24</modified>
  </card>
  <card id="115">
    <name>Angel of destruction</name>
    <class>Rare</class>
    <cost>
      <gems>20</gems>
      <recruits>20</recruits>
    </cost>
    <level>0</level>
    <keywords>Destruction</keywords>
    <effect><![CDATA[Attack: 30<br />Stock: = 0<br />Enemy stock: = 0]]></effect>
    <code><![CDATA[
    $hisdata->attack(30);
    $mydata->setStock(0);
    $hisdata->setStock(0);
]]></code>
    <created>2006-05-01</created>
    <modified>2010-09-23</modified>
  </card>
  <card id="116">
    <name>Telekinesis</name>
    <class>Uncommon</class>
    <cost>
      <gems>9</gems>
    </cost>
    <level>1</level>
    <keywords>Destruction</keywords>
    <effect><![CDATA[Tower: +5<br />Enemy tower: -5]]></effect>
    <code><![CDATA[$mydata->Tower+= 5; $hisdata->Tower-= 5;]]></code>
    <created>2006-05-01</created>
    <modified>2010-09-23</modified>
  </card>
  <card id="117">
    <name>Mummy</name>
    <class>Common</class>
    <cost>
      <recruits>1</recruits>
    </cost>
    <level>8</level>
    <keywords>Undead,Banish</keywords>
    <effect><![CDATA[Tower: +4<br />If #<b>Undead</b> in hand < 4<br />Gems: -3]]></effect>
    <code><![CDATA[
    $mydata->Tower+= 4;
    if ($this->keywordCount($mydata->Hand, 'Undead') < 4) $mydata->Gems-= 3;
]]></code>
    <created>2006-05-01</created>
    <modified>2011-12-24</modified>
  </card>
  <card id="118">
    <name>Gateway</name>
    <class>Uncommon</class>
    <cost>
      <gems>60</gems>
    </cost>
    <level>2</level>
    <effect><![CDATA[Facilities: +3<br />Wall: +25]]></effect>
    <code><![CDATA[$mydata->addFacilities(3); $mydata->Wall+= 25;]]></code>
    <created>2006-05-01</created>
    <modified>2014-12-24</modified>
  </card>
  <card id="119">
    <name>Haste</name>
    <class>Common</class>
    <cost>
      <gems>6</gems>
    </cost>
    <level>0</level>
    <keywords>Restoration</keywords>
    <effect><![CDATA[Production x2]]></effect>
    <code><![CDATA[$production->multiply(2);]]></code>
    <created>2006-05-01</created>
    <modified>2010-07-22</modified>
  </card>
  <card id="120">
    <name>Stalker</name>
    <class>Uncommon</class>
    <cost>
      <gems>11</gems>
      <recruits>5</recruits>
    </cost>
    <level>6</level>
    <keywords>Undead,Far sight</keywords>
    <effect><![CDATA[Attack: 11<br />Gems: +5<br />Enemy gems: -5]]></effect>
    <code><![CDATA[
    $hisdata->attack(11);
    $mydata->Gems+= 5; $hisdata->Gems-= 5;
]]></code>
    <created>2006-05-01</created>
    <modified>2010-06-21</modified>
  </card>
  <card id="121">
    <name>Luna the Sorceress</name>
    <class>Rare</class>
    <cost>
      <gems>25</gems>
    </cost>
    <level>0</level>
    <keywords>Mage,Far sight</keywords>
    <effect><![CDATA[Attack: 30<br />Magic: +1]]></effect>
    <code><![CDATA[$hisdata->attack(30); $mydata->Magic+= 1;]]></code>
    <created>2006-05-01</created>
    <modified>2011-01-01</modified>
  </card>
  <card id="122">
    <name>Elven scout</name>
    <class>Common</class>
    <cost>
      <recruits>2</recruits>
    </cost>
    <level>0</level>
    <keywords>Alliance,Banish</keywords>
    <effect><![CDATA[Attack: 3<br />Gems: +1]]></effect>
    <code><![CDATA[$hisdata->attack(3); $mydata->Gems+= 1;]]></code>
    <created>2006-05-01</created>
    <modified>2011-01-24</modified>
  </card>
  <card id="123">
    <name>Magic fountain</name>
    <class>Uncommon</class>
    <cost>
      <bricks>5</bricks>
      <gems>5</gems>
    </cost>
    <level>0</level>
    <keywords>Alliance</keywords>
    <effect><![CDATA[Tower: +7<br />Production x2]]></effect>
    <code><![CDATA[$mydata->Tower+= 7; $production->multiply(2);]]></code>
    <created>2006-05-01</created>
    <modified>2009-04-11</modified>
  </card>
  <card id="124">
    <name>Cannoneer</name>
    <class>Rare</class>
    <cost>
      <gems>7</gems>
      <recruits>7</recruits>
    </cost>
    <level>0</level>
    <keywords>Runic</keywords>
    <effect><![CDATA[Wall: -70<br />Attack: N<br />N = wall lost]]></effect>
    <code><![CDATA[
    $lowered = $mydata->Wall - max($mydata->Wall - 70, 0);
    $mydata->Wall-= $lowered;
    $hisdata->attack($lowered);
]]></code>
    <created>2006-05-01</created>
    <modified>2013-03-31</modified>
  </card>
  <card id="125">
    <name>Archangel</name>
    <class>Rare</class>
    <cost>
      <gems>40</gems>
    </cost>
    <level>6</level>
    <keywords>Restoration,Far sight</keywords>
    <effect><![CDATA[Tower: +15<br />Wall: +15<br />Stock: +15]]></effect>
    <code><![CDATA[
    $mydata->Tower+= 15; $mydata->Wall+= 15;
    $mydata->addStock(15);
]]></code>
    <created>2006-05-01</created>
    <modified>2010-06-21</modified>
  </card>
  <card id="126">
    <name>Green dragon</name>
    <class>Rare</class>
    <cost>
      <recruits>25</recruits>
    </cost>
    <level>0</level>
    <keywords>Dragon,Far sight</keywords>
    <effect><![CDATA[Attack: 40]]></effect>
    <code><![CDATA[$hisdata->attack(40);]]></code>
    <created>2006-05-01</created>
    <modified>2010-06-21</modified>
  </card>
  <card id="127">
    <name>Black dragon</name>
    <class>Rare</class>
    <cost>
      <recruits>43</recruits>
    </cost>
    <level>0</level>
    <keywords>Dragon</keywords>
    <effect><![CDATA[Attack: 60<br />Enemy recruits: -15]]></effect>
    <code><![CDATA[$hisdata->attack(60); $hisdata->Recruits-= 15;]]></code>
    <created>2006-05-01</created>
    <modified>2007-09-26</modified>
  </card>
  <card id="128">
    <name>Ice dragon</name>
    <class>Rare</class>
    <cost>
      <gems>10</gems>
      <recruits>25</recruits>
    </cost>
    <level>0</level>
    <keywords>Dragon,Skirmisher</keywords>
    <effect><![CDATA[Attack: 45<br />Enemy gems: -10]]></effect>
    <code><![CDATA[$hisdata->attack(45); $hisdata->Gems-= 10;]]></code>
    <created>2006-05-01</created>
    <modified>2010-12-24</modified>
  </card>
  <card id="129">
    <name>Wealth</name>
    <class>Common</class>
    <level>6</level>
    <effect><![CDATA[Stock: +8<br />Enemy stock: +8]]></effect>
    <code><![CDATA[
    $mydata->addStock(8);
    $hisdata->addStock(8);
]]></code>
    <created>2006-05-01</created>
    <modified>2011-02-12</modified>
  </card>
  <card id="130">
    <name>Sea monster</name>
    <class>Uncommon</class>
    <cost>
      <recruits>30</recruits>
    </cost>
    <level>7</level>
    <keywords>Aqua,Charge (8)</keywords>
    <effect><![CDATA[Attack: 30<br />If Enemy wall = 0<br />Recruits: +20]]></effect>
    <code><![CDATA[
    $hisdata->attack(30);
    if ($hisdata->Wall <= 0) $mydata->Recruits+= 20;
]]></code>
    <created>2006-05-01</created>
    <modified>2010-12-24</modified>
  </card>
  <card id="131">
    <name>Dragon egg</name>
    <class>Uncommon</class>
    <cost>
      <gems>13</gems>
    </cost>
    <level>8</level>
    <effect><![CDATA[Summons a <b>Dragon</b><br />If #<b>Dragon</b> in hand > 0<br />it will be a rare <b>Dragon</b>]]></effect>
    <code><![CDATA[
    $filters = ($this->keywordCount($mydata->Hand, 'Dragon') > 0) ? ['class'=>'Rare', 'keyword'=>'Dragon'] : ['keyword'=>'Dragon'];
    $nextcard = $this->drawCard($this->getList($filters), $mydata->Hand, $cardpos, 'drawCardList');
]]></code>
    <created>2006-05-01</created>
    <modified>2010-12-24</modified>
  </card>
  <card id="132">
    <name>Tubular bells</name>
    <class>Rare</class>
    <level>6</level>
    <effect><![CDATA[If #Facilities >= #Enemy facilities<br />Stock: -15<br />Always:<br />Facilities: +1]]></effect>
    <code><![CDATA[
    if (($mydata->Quarry + $mydata->Magic + $mydata->Dungeons) >= ($hisdata->Quarry + $hisdata->Magic + $hisdata->Dungeons)) {
      $mydata->addStock(-15);
    }
    $mydata->addFacilities(1);
]]></code>
    <created>2006-05-01</created>
    <modified>2009-10-26</modified>
  </card>
  <card id="133">
    <name>Banshee</name>
    <class>Uncommon</class>
    <cost>
      <gems>10</gems>
      <recruits>10</recruits>
    </cost>
    <level>8</level>
    <keywords>Undead</keywords>
    <effect><![CDATA[Attack: 4N + 4<br />N = #<b>Undead</b> in hand]]></effect>
    <code><![CDATA[
    $tmp = $this->keywordCount($mydata->Hand, 'Undead');
    $hisdata->attack((($tmp * 4) + 4));
]]></code>
    <created>2006-11-14</created>
    <modified>2012-09-08</modified>
  </card>
  <card id="134">
    <name>Centaur trainer</name>
    <class>Rare</class>
    <cost>
      <gems>13</gems>
      <recruits>17</recruits>
    </cost>
    <level>4</level>
    <keywords>Beast,Horde</keywords>
    <effect><![CDATA[Dungeon: +2<br />Summons a rare <b>Beast</b>]]></effect>
    <code><![CDATA[
    $mydata->Dungeons+= 2;
    $nextcard = $this->drawCard($this->getList(['class'=>'Rare', 'keyword'=>'Beast']), $mydata->Hand, $cardpos, 'drawCardList');
]]></code>
    <created>2006-11-14</created>
    <modified>2011-12-24</modified>
  </card>
  <card id="135">
    <name>Stone atronarch</name>
    <class>Common</class>
    <cost>
      <bricks>2</bricks>
      <gems>5</gems>
    </cost>
    <level>5</level>
    <keywords>Unliving</keywords>
    <effect><![CDATA[If Bricks > Enemy bricks<br />Attack: 10<br />else<br/>Bricks: +8]]></effect>
    <code><![CDATA[
    if ($mydata->Bricks > $hisdata->Bricks) $hisdata->attack(10);
    else $mydata->Bricks+= 8;]]></code>
    <created>2007-03-26</created>
    <modified>2007-11-25</modified>
  </card>
  <card id="136">
    <name>Elven enchantress</name>
    <class>Uncommon</class>
    <cost>
      <gems>10</gems>
    </cost>
    <level>0</level>
    <keywords>Alliance,Mage</keywords>
    <effect><![CDATA[Attack: 9<br />Production x2]]></effect>
    <code><![CDATA[$hisdata->attack(9); $production->multiply(2);]]></code>
    <created>2006-05-01</created>
    <modified>2011-01-24</modified>
  </card>
  <card id="137">
    <name>Seraphim</name>
    <class>Uncommon</class>
    <cost>
      <recruits>17</recruits>
    </cost>
    <level>3</level>
    <keywords>Holy,Far sight</keywords>
    <effect><![CDATA[Attack: 10<br />Tower: +10]]></effect>
    <code><![CDATA[$hisdata->attack(10); $mydata->Tower+= 10;]]></code>
    <created>2006-05-01</created>
    <modified>2010-06-21</modified>
  </card>
  <card id="138">
    <name>Devil</name>
    <class>Rare</class>
    <cost>
      <gems>28</gems>
      <recruits>30</recruits>
    </cost>
    <level>0</level>
    <keywords>Demonic</keywords>
    <effect><![CDATA[Attack: 50<br />Enemy stock: -50]]></effect>
    <code><![CDATA[
    $hisdata->attack(50);
    $hisdata->addStock(-50);
]]></code>
    <created>2006-05-01</created>
    <modified>2013-12-24</modified>
  </card>
  <card id="139">
    <name>Avenger</name>
    <class>Common</class>
    <cost>
      <gems>5</gems>
      <recruits>2</recruits>
    </cost>
    <level>4</level>
    <keywords>Holy</keywords>
    <effect><![CDATA[If Recruits > Enemy recruits<br />Attack: 10<br />else<br/>Recruits: +7]]></effect>
    <code><![CDATA[
    if ($mydata->Recruits > $hisdata->Recruits) $hisdata->attack(10);
    else $mydata->Recruits+= 7;
]]></code>
    <created>2007-03-26</created>
    <modified>2011-01-01</modified>
  </card>
  <card id="140">
    <name>Poacher</name>
    <class>Common</class>
    <cost>
      <recruits>5</recruits>
    </cost>
    <level>0</level>
    <keywords>Brigand</keywords>
    <effect><![CDATA[Attack: 3<br />Enemy stock: -2]]></effect>
    <code><![CDATA[
    $hisdata->attack(3);
    $hisdata->addStock(-2);
]]></code>
    <created>2006-05-01</created>
    <modified>2012-09-08</modified>
  </card>
  <card id="141">
    <name>Tower of Babylon</name>
    <class>Rare</class>
    <cost>
      <bricks>10</bricks>
    </cost>
    <level>0</level>
    <keywords>Durable</keywords>
    <effect><![CDATA[Tower: +10]]></effect>
    <code><![CDATA[$mydata->Tower+= 10;]]></code>
    <created>2006-05-01</created>
    <modified>2006-05-01</modified>
  </card>
  <card id="142">
    <name>Basilisk</name>
    <class>Uncommon</class>
    <cost>
      <recruits>10</recruits>
    </cost>
    <level>7</level>
    <keywords>Beast</keywords>
    <effect><![CDATA[Attack: 20<br />Wall: +10<br />Quarry: +1<br />Enemy wall: +10<br />Enemy quarry: +1]]></effect>
    <code><![CDATA[
    $hisdata->attack(20);
    $mydata->Wall+= 10; $mydata->Quarry+= 1;
    $hisdata->Wall+= 10; $hisdata->Quarry+= 1;
]]></code>
    <created>2006-05-01</created>
    <modified>2011-09-24</modified>
  </card>
  <card id="143">
    <name>Clay valley</name>
    <class>Rare</class>
    <cost>
      <gems>11</gems>
      <recruits>11</recruits>
    </cost>
    <level>3</level>
    <keywords>Alliance</keywords>
    <effect><![CDATA[Bricks prod x15]]></effect>
    <code><![CDATA[$production->multiplyBricks(15);]]></code>
    <created>2006-05-01</created>
    <modified>2012-12-24</modified>
  </card>
  <card id="144">
    <name>Necromancer</name>
    <class>Rare</class>
    <cost>
      <gems>19</gems>
      <recruits>13</recruits>
    </cost>
    <level>4</level>
    <keywords>Undead</keywords>
    <effect><![CDATA[Attack: 20<br />Summons rare <b>Undead</b><br />Gain cost of the summoned card (max 13)]]></effect>
    <code><![CDATA[
    $hisdata->attack(20);
    $nextcard = $this->drawCard($this->getList(['class'=>'Rare', 'keyword'=>'Undead']), $mydata->Hand, $cardpos, 'drawCardList');
    $cur_card = $this->getCard($nextcard);
    $mydata->Bricks+= min($cur_card->getResources('Bricks'), 13);
    $mydata->Gems+= min($cur_card->getResources('Gems'), 13);
    $mydata->Recruits+= min($cur_card->getResources('Recruits'), 13);
]]></code>
    <created>2006-05-01</created>
    <modified>2010-12-24</modified>
  </card>
  <card id="145">
    <name>Necromancy</name>
    <class>Common</class>
    <cost>
      <gems>4</gems>
    </cost>
    <level>10</level>
    <effect><![CDATA[Summons <b>Undead</b> of a rarity based on #<b>Undead</b> in hand (C - 0 to 3, U - 4 to 6, R - 7)]]></effect>
    <code><![CDATA[
    $tmp = $this->keywordCount($mydata->Hand, 'Undead');
    $rarity = ($tmp == 7) ? 'Rare' : (($tmp < 7 and $tmp > 3) ? 'Uncommon' : 'Common');
    $nextcard = $this->drawCard($this->getList(['class'=>$rarity, 'keyword'=>'Undead']), $mydata->Hand, $cardpos, 'drawCardList');
]]></code>
    <created>2006-05-01</created>
    <modified>2012-09-08</modified>
  </card>
  <card id="146">
    <name>Ancient ruins</name>
    <class>Uncommon</class>
    <level>0</level>
    <keywords>Runic</keywords>
    <effect><![CDATA[Bricks: +5<br />Gems: +2<br />Recruits: +1]]></effect>
    <code><![CDATA[$mydata->Bricks+= 5; $mydata->Gems+= 2; $mydata->Recruits+= 1;]]></code>
    <created>2006-05-01</created>
    <modified>2011-04-24</modified>
  </card>
  <card id="147">
    <name>Werewolf</name>
    <class>Common</class>
    <cost>
      <recruits>8</recruits>
    </cost>
    <level>8</level>
    <keywords>Beast,Far sight</keywords>
    <effect><![CDATA[If matching card is Revealed<br />Wall: +12<br />else<br />Attack: 12]]></effect>
    <code><![CDATA[if (!$hidden_cards or isset($hisdata->Revealed[$cardpos])) $mydata->Wall+= 12; else $hisdata->attack(12);]]></code>
    <created>2006-05-01</created>
    <modified>2011-12-24</modified>
  </card>
  <card id="148">
    <name>Two towers</name>
    <class>Rare</class>
    <level>0</level>
    <effect><![CDATA[Wall: +50<br />Enemy wall: +50]]></effect>
    <code><![CDATA[$mydata->Wall+= 50; $hisdata->Wall+= 50;]]></code>
    <created>2006-05-01</created>
    <modified>2006-05-01</modified>
  </card>
  <card id="149">
    <name>Double wall</name>
    <class>Common</class>
    <cost>
      <bricks>6</bricks>
    </cost>
    <level>0</level>
    <effect><![CDATA[Wall: +10]]></effect>
    <code><![CDATA[$mydata->Wall+= 10;]]></code>
    <created>2006-05-01</created>
    <modified>2011-01-24</modified>
  </card>
  <card id="150">
    <name>Conscript army</name>
    <class>Uncommon</class>
    <level>2</level>
    <effect><![CDATA[Attack: 12<br />Stock: -5<br />Replace matching card and up to two common cards in opponent's hand with Conscript]]></effect>
    <code><![CDATA[
    $hisdata->attack(12);
    $mydata->addStock(-5);
    $this->setCard('his', $cardpos, 97, ['reveal' => true]);
    $storage = array();
    for ($i = 1; $i <= 8; $i++) {
      if ($i != $cardpos and $this->getCard($hisdata->Hand[$i])->getClass() == 'Common') $storage[] = $i;
    }
    $count = min(count($storage), 2);
    if ($count > 0) {
      shuffle($storage);
      for ($k = 0; $k < $count; $k++) {
        $i = $storage[$k];
        $this->setCard('his', $i, 97, ['reveal' => true]);
      }
    }
]]></code>
    <created>2006-05-01</created>
    <modified>2015-09-26</modified>
  </card>
  <card id="151">
    <name>Trebuchet</name>
    <class>Rare</class>
    <cost>
      <bricks>6</bricks>
      <recruits>9</recruits>
    </cost>
    <level>0</level>
    <keywords>Durable,Siege</keywords>
    <effect><![CDATA[Enemy tower: -6]]></effect>
    <code><![CDATA[$hisdata->Tower-= 6;]]></code>
    <created>2006-05-01</created>
    <modified>2011-04-24</modified>
  </card>
  <card id="152">
    <name>Micramix</name>
    <class>Rare</class>
    <cost>
      <gems>1</gems>
    </cost>
    <level>10</level>
    <keywords>Illusion</keywords>
    <effect><![CDATA[Switches your hand with opponent's hand (shuffles both hands)]]></effect>
    <code><![CDATA[
    $this->setCard('my', $cardpos, $this->drawCard($my_deck, $mydata->Hand, $cardpos, 'drawCardRandom'));
    $tmp = $mydata->Hand; $this->setHandShuffled('my', $hisdata->Hand); $this->setHandShuffled('his', $tmp);
    $nextcard = 0;
]]></code>
    <created>2006-05-01</created>
    <modified>2015-08-01</modified>
  </card>
  <card id="153">
    <name>Acolyte</name>
    <class>Common</class>
    <cost>
      <gems>2</gems>
      <recruits>5</recruits>
    </cost>
    <level>1</level>
    <keywords>Mage</keywords>
    <effect><![CDATA[If Gems > Enemy gems<br />Attack: 10<br />else<br/>Gems: +7]]></effect>
    <code><![CDATA[
    if ($mydata->Gems > $hisdata->Gems) { $hisdata->attack(10); }
    else $mydata->Gems+= 7;
]]></code>
    <created>2007-03-26</created>
    <modified>2011-01-24</modified>
  </card>
  <card id="154">
    <name>Dwarven fortification</name>
    <class>Uncommon</class>
    <cost>
      <bricks>32</bricks>
    </cost>
    <level>0</level>
    <keywords>Runic</keywords>
    <effect><![CDATA[Wall: +40<br />Summons non-common <b>Runic</b> (can't summon self)]]></effect>
    <code><![CDATA[
    $mydata->Wall+= 40;
    $uncommon = $this->getList(['class'=>'Uncommon', 'keyword'=>'Runic']);
    $uncommon = array_diff($uncommon, [$card->id()]);
    $rare = $this->getList(['class'=>'Rare', 'keyword'=>'Runic']);
    $nextcard = $this->drawCard(array_merge($uncommon, $rare), $mydata->Hand, $cardpos, 'drawCardList');
]]></code>
    <created>2006-05-01</created>
    <modified>2012-12-24</modified>
  </card>
  <card id="155">
    <name>Citadel</name>
    <class>Uncommon</class>
    <cost>
      <bricks>20</bricks>
    </cost>
    <level>8</level>
    <keywords>Far sight</keywords>
    <effect><![CDATA[Tower: +18<br />Wall: +6]]></effect>
    <code><![CDATA[$mydata->Tower+= 18; $mydata->Wall+= 6;]]></code>
    <created>2006-05-01</created>
    <modified>2012-06-24</modified>
  </card>
  <card id="156">
    <name>Magic barrier</name>
    <class>Rare</class>
    <cost>
      <bricks>15</bricks>
      <gems>10</gems>
    </cost>
    <level>0</level>
    <keywords>Illusion</keywords>
    <effect><![CDATA[Tower: +#Bricks<br />Wall: +#Gems<br />Bricks: = 0<br />Gems: = 0]]></effect>
    <code><![CDATA[
    $mydata->Wall+= $mydata->Gems; $mydata->Tower+= $mydata->Bricks;
    $mydata->Gems= 0; $mydata->Bricks= 0;
]]></code>
    <created>2006-05-01</created>
    <modified>2010-09-23</modified>
  </card>
  <card id="157">
    <name>Volcano</name>
    <class>Rare</class>
    <cost>
      <gems>32</gems>
    </cost>
    <level>5</level>
    <keywords>Nature</keywords>
    <effect><![CDATA[Enemy tower: -15<br />Enemy wall: -15<br />Enemy stock: -15]]></effect>
    <code><![CDATA[
    $hisdata->Tower-= 15; $hisdata->Wall-= 15;
    $hisdata->addStock(-15);
]]></code>
    <created>2006-05-01</created>
    <modified>2012-09-08</modified>
  </card>
  <card id="158">
    <name>Flood</name>
    <class>Uncommon</class>
    <cost>
      <gems>20</gems>
    </cost>
    <level>7</level>
    <keywords>Nature</keywords>
    <effect><![CDATA[Enemy wall: -N<br />N = 45 - #Enemy bricks<br />Enemy bricks: -45]]></effect>
    <code><![CDATA[
    $lowered = $hisdata->Bricks - max($hisdata->Bricks - 45, 0);
    $hisdata->Bricks-= $lowered; $hisdata->Wall-= 45 - $lowered;
]]></code>
    <created>2006-05-01</created>
    <modified>2012-09-08</modified>
  </card>
  <card id="159">
    <name>Scepter of summoning</name>
    <class>Uncommon</class>
    <cost>
      <gems>15</gems>
    </cost>
    <level>4</level>
    <effect><![CDATA[Summons a rare card from your deck]]></effect>
    <code><![CDATA[$nextcard = $this->drawCard($my_deck->Rare, $mydata->Hand, $cardpos, 'drawCardList');]]></code>
    <created>2006-05-01</created>
    <modified>2006-05-01</modified>
  </card>
  <card id="160">
    <name>Gnome thief</name>
    <class>Common</class>
    <cost>
      <recruits>3</recruits>
    </cost>
    <level>0</level>
    <keywords>Brigand</keywords>
    <effect><![CDATA[Recruits: +1<br />Gems: +2<br />Enemy recruits: -1<br />Enemy gems: -2]]></effect>
    <code><![CDATA[$mydata->Recruits+= 1; $mydata->Gems+= 2; $hisdata->Recruits-= 1; $hisdata->Gems-= 2;]]></code>
    <created>2006-05-01</created>
    <modified>2014-12-24</modified>
  </card>
  <card id="161">
    <name>Damnation</name>
    <class>Rare</class>
    <cost>
      <gems>60</gems>
    </cost>
    <level>0</level>
    <keywords>Destruction</keywords>
    <effect><![CDATA[Enemy tower: -20<br />Enemy wall: -20<br />Enemy facilities: -2<br />Enemy stock: -20]]></effect>
    <code><![CDATA[
    $hisdata->Tower-= 20; $hisdata->Wall-= 20;
    $hisdata->addFacilities(-2);
    $hisdata->addStock(-20);
]]></code>
    <created>2006-05-01</created>
    <modified>2009-10-26</modified>
  </card>
  <card id="162">
    <name>Apprentice</name>
    <class>Uncommon</class>
    <cost>
      <gems>6</gems>
      <recruits>6</recruits>
    </cost>
    <level>0</level>
    <effect><![CDATA[Magic: +1]]></effect>
    <code><![CDATA[$mydata->Magic+= 1;]]></code>
    <created>2006-05-01</created>
    <modified>2010-07-22</modified>
  </card>
  <card id="163">
    <name>Architect</name>
    <class>Uncommon</class>
    <cost>
      <bricks>5</bricks>
      <gems>5</gems>
    </cost>
    <level>0</level>
    <effect><![CDATA[Quarry: +1]]></effect>
    <code><![CDATA[$mydata->Quarry+= 1;]]></code>
    <created>2006-05-01</created>
    <modified>2009-10-26</modified>
  </card>
  <card id="164">
    <name>Legendary smith</name>
    <class>Uncommon</class>
    <cost>
      <bricks>6</bricks>
      <recruits>6</recruits>
    </cost>
    <level>0</level>
    <effect><![CDATA[Dungeon: +1]]></effect>
    <code><![CDATA[$mydata->Dungeons+= 1;]]></code>
    <created>2006-05-01</created>
    <modified>2010-07-22</modified>
  </card>
  <card id="165">
    <name>Preparations</name>
    <class>Common</class>
    <cost>
      <bricks>6</bricks>
      <recruits>6</recruits>
    </cost>
    <level>2</level>
    <effect><![CDATA[If Dungeon < Enemy dungeon<br />Dungeon: +1<br />else<br />Recruits: +11]]></effect>
    <code><![CDATA[
    if ($mydata->Dungeons < $hisdata->Dungeons) { $mydata->Dungeons+= 1; }
    else $mydata->Recruits+= 11;
]]></code>
    <created>2007-03-26</created>
    <modified>2013-10-19</modified>
  </card>
  <card id="166">
    <name>Royal dragoons</name>
    <class>Uncommon</class>
    <cost>
      <recruits>40</recruits>
    </cost>
    <level>10</level>
    <keywords>Soldier,Charge (15)</keywords>
    <effect><![CDATA[Attack: 25 + 8N<br />N = #<b>Charge</b> in hand]]></effect>
    <code><![CDATA[
    $tmp = $this->keywordCount($mydata->Hand, 'Charge');
    $hisdata->attack(25 + (8 * $tmp));
]]></code>
    <created>2006-05-01</created>
    <modified>2011-01-24</modified>
  </card>
  <card id="167">
    <name>Dragon squadron</name>
    <class>Rare</class>
    <cost>
      <recruits>70</recruits>
    </cost>
    <level>0</level>
    <keywords>Dragon</keywords>
    <effect><![CDATA[Attack: 200]]></effect>
    <code><![CDATA[$hisdata->attack(200);]]></code>
    <created>2006-05-01</created>
    <modified>2007-05-08</modified>
  </card>
  <card id="168">
    <name>Mirror strike</name>
    <class>Uncommon</class>
    <cost>
      <gems>8</gems>
    </cost>
    <level>7</level>
    <keywords>Illusion</keywords>
    <effect><![CDATA[Summons opponent's last card]]></effect>
    <code><![CDATA[if ($hislast_card->id() > 0) $nextcard = $hislast_card->id();]]></code>
    <created>2006-05-01</created>
    <modified>2011-12-24</modified>
  </card>
  <card id="169">
    <name>Valhalla</name>
    <class>Rare</class>
    <level>0</level>
    <effect><![CDATA[Tower: -20<br />Wall: +70<br/>Won't lower tower below 1]]></effect>
    <code><![CDATA[
    $mydata->Tower-= 20; $mydata->Tower = max(1, $mydata->Tower);
    $mydata->Wall+= 70;
]]></code>
    <created>2006-05-01</created>
    <modified>2010-12-24</modified>
  </card>
  <card id="170">
    <name>Miracle</name>
    <class>Uncommon</class>
    <cost>
      <gems>1</gems>
    </cost>
    <level>8</level>
    <keywords>Holy</keywords>
    <effect><![CDATA[Player(s) with most <b>Holy</b> in hand gains<br />Stock: +8<br />His opponent gains<br />Stock: +2]]></effect>
    <code><![CDATA[
    $my_count = $this->keywordCount($mydata->Hand, 'Holy');
    $his_count = $this->keywordCount($hisdata->Hand, 'Holy');
    if ($my_count >= $his_count) {
      $mydata->addStock(8);
      $hisdata->addStock(2);
    }
    if ($my_count <= $his_count) {
      $mydata->addStock(2);
      $hisdata->addStock(8);
    }
]]></code>
    <created>2006-05-01</created>
    <modified>2011-02-12</modified>
  </card>
  <card id="171">
    <name>Master of the past</name>
    <class>Rare</class>
    <level>10</level>
    <keywords>Mage</keywords>
    <effect><![CDATA[Negates the negative effect of opponent's last round on your tower, wall, facilities and stock]]></effect>
    <code><![CDATA[
    $mydata->Tower-= min(0, $mychanges['Tower']); $mydata->Wall-= min(0, $mychanges['Wall']);
    $mydata->Quarry-= min(0, $mychanges['Quarry']); $mydata->Magic-= min(0, $mychanges['Magic']); $mydata->Dungeons-= min(0, $mychanges['Dungeons']);
    $mydata->Bricks-= min(0, $mychanges['Bricks']); $mydata->Gems-= min(0, $mychanges['Gems']); $mydata->Recruits-= min(0, $mychanges['Recruits']);
]]></code>
    <created>2006-05-01</created>
    <modified>2013-03-31</modified>
  </card>
  <card id="172">
    <name>Knight of time</name>
    <class>Uncommon</class>
    <cost>
      <gems>9</gems>
      <recruits>9</recruits>
    </cost>
    <level>2</level>
    <keywords>Mage,Swift</keywords>
    <effect><![CDATA[Attack: 14]]></effect>
    <code><![CDATA[$hisdata->attack(14);]]></code>
    <created>2006-05-01</created>
    <modified>2015-08-01</modified>
  </card>
  <card id="173">
    <name>Lord of time</name>
    <class>Rare</class>
    <cost>
      <gems>23</gems>
      <recruits>12</recruits>
    </cost>
    <level>4</level>
    <keywords>Mage,Swift,Rebirth</keywords>
    <effect><![CDATA[Attack: 20<br /><b>Mage</b> tokens = 0]]></effect>
    <code><![CDATA[$hisdata->attack(20); $mydata->setToken('Mage', 0);]]></code>
    <created>2006-05-01</created>
    <modified>2015-08-01</modified>
  </card>
  <card id="174">
    <name>Time warp</name>
    <class>Uncommon</class>
    <cost>
      <gems>11</gems>
    </cost>
    <level>0</level>
    <keywords>Swift</keywords>
    <effect><![CDATA[Production x2]]></effect>
    <code><![CDATA[$production->multiply(2);]]></code>
    <created>2006-05-01</created>
    <modified>2007-11-25</modified>
  </card>
  <card id="175">
    <name>Cathedral</name>
    <class>Uncommon</class>
    <cost>
      <bricks>27</bricks>
    </cost>
    <level>0</level>
    <keywords>Holy</keywords>
    <effect><![CDATA[Tower: +13<br />Stock: +7]]></effect>
    <code><![CDATA[
    $mydata->Tower+= 13;
    $mydata->addStock(7);
]]></code>
    <created>2006-05-01</created>
    <modified>2007-11-25</modified>
  </card>
  <card id="176">
    <name>Chapel</name>
    <class>Common</class>
    <cost>
      <bricks>5</bricks>
    </cost>
    <level>0</level>
    <keywords>Holy</keywords>
    <effect><![CDATA[Tower: +3<br />Stock: +1]]></effect>
    <code><![CDATA[
    $mydata->Tower+= 3;
    $mydata->addStock(1);
]]></code>
    <created>2006-05-01</created>
    <modified>2009-10-26</modified>
  </card>
  <card id="177">
    <name>Prayer</name>
    <class>Common</class>
    <cost>
      <gems>1</gems>
    </cost>
    <level>6</level>
    <effect><![CDATA[Gain 1 random resource for each <b>Holy</b> in hand (max 5)<br />Summons <b>Holy</b>]]></effect>
    <code><![CDATA[
    $nextcard = $this->drawCard($this->getList(['keyword'=>'Holy']), $mydata->Hand, $cardpos, 'drawCardList');
    $resources = min($this->keywordCount($mydata->Hand, 'Holy'),5);
    $mydata->addRandomResources($resources);
]]></code>
    <created>2006-05-01</created>
    <modified>2011-04-24</modified>
  </card>
  <card id="178">
    <name>Army of darkness</name>
    <class>Rare</class>
    <cost>
      <gems>13</gems>
    </cost>
    <level>8</level>
    <keywords>Undead</keywords>
    <effect><![CDATA[Attack: N * M<br />Recruits: = 0<br />N = #Recruits<br />M = #<b>Undead</b> rare cards in hand / 2]]></effect>
    <code><![CDATA[
    $rares = 0;
    for ($i = 1; $i <= 8; $i++) {
      $cur_card = $this->getCard($mydata->Hand[$i]);
      if ($cur_card->hasKeyword('Undead') and $cur_card->getClass() == 'Rare') $rares++;
    }
    $hisdata->attack($mydata->Recruits * round($rares / 2));
    $mydata->Recruits= 0;
]]></code>
    <created>2006-05-01</created>
    <modified>2010-12-24</modified>
  </card>
  <card id="179">
    <name>Redesign</name>
    <class>Rare</class>
    <level>9</level>
    <effect><![CDATA[Tower: +Wall / 2<br />Enemy tower: +Enemy wall / 2<br />Both walls are halved]]></effect>
    <code><![CDATA[$mydata->Tower+= round($mydata->Wall / 2); $mydata->Wall-= round($mydata->Wall / 2); $hisdata->Tower+= round($hisdata->Wall / 2); $hisdata->Wall-= round($hisdata->Wall / 2);]]></code>
    <created>2006-05-01</created>
    <modified>2012-09-08</modified>
  </card>
  <card id="180">
    <name>Mercenaries</name>
    <class>Uncommon</class>
    <level>1</level>
    <effect><![CDATA[Production x0<br />Attack: 9 + 9N<br />N = #Facilities that were lowered to 1]]></effect>
    <code><![CDATA[
    $production->multiply(0);
    $tmp = 0;
    if ($mydata->Quarry == 1) $tmp++;
    if ($mydata->Magic == 1) $tmp++;
    if ($mydata->Dungeons == 1) $tmp++;
    $hisdata->attack(9 + 9*$tmp);
]]></code>
    <created>2006-05-01</created>
    <modified>2011-02-12</modified>
  </card>
  <card id="181">
    <name>Genie</name>
    <class>Rare</class>
    <cost>
      <gems>30</gems>
      <recruits>10</recruits>
    </cost>
    <level>0</level>
    <effect><![CDATA[Attack: 35<br />Stock: +5<br />Enemy stock: -5]]></effect>
    <code><![CDATA[
    $hisdata->attack(35);
    $mydata->addStock(5);
    $hisdata->addStock(-5);
]]></code>
    <created>2006-05-01</created>
    <modified>2006-05-01</modified>
  </card>
  <card id="182">
    <name>Efreet</name>
    <class>Rare</class>
    <cost>
      <gems>35</gems>
      <recruits>15</recruits>
    </cost>
    <level>2</level>
    <keywords>Burning</keywords>
    <effect><![CDATA[Enemy stock: -20<br />Opponent suffers 1 damage for each resource lost]]></effect>
    <code><![CDATA[
    $res = ['Bricks', 'Gems', 'Recruits']; $dmg = 0;
    foreach ($res as $resource) {
      $lowered = $hisdata->$resource - max($hisdata->$resource - 20, 0);
      $hisdata->$resource-= $lowered; $dmg+= $lowered;
    }
    $hisdata->attack($dmg);
]]></code>
    <created>2006-05-01</created>
    <modified>2010-04-11</modified>
  </card>
  <card id="183">
    <name>Magic lamp</name>
    <class>Common</class>
    <cost>
      <bricks>5</bricks>
      <gems>5</gems>
      <recruits>5</recruits>
    </cost>
    <level>9</level>
    <effect><![CDATA[If New<br />Summons Genie or Efreet<br />else<br />Gain 20 random resources]]></effect>
    <code><![CDATA[
    if (isset($mynewflags[$cardpos])) {
      $nextcard = $this->drawCard([181, 182], $mydata->Hand, $cardpos, 'drawCardList');
    }
    else {
      $mydata->addRandomResources(20);
    }
]]></code>
    <created>2006-05-01</created>
    <modified>2015-09-26</modified>
  </card>
  <card id="184">
    <name>Lost city</name>
    <class>Uncommon</class>
    <cost>
      <bricks>10</bricks>
      <gems>5</gems>
    </cost>
    <level>4</level>
    <effect><![CDATA[Tower: +5<br />Stock: +4<br />Summons Genie, Efreet or Scepter of summoning]]></effect>
    <code><![CDATA[
    $mydata->Tower+= 5;
    $mydata->addStock(4);
    $nextcard = $this->drawCard([181, 182, 159], $mydata->Hand, $cardpos, 'drawCardList');
]]></code>
    <created>2006-05-01</created>
    <modified>2010-02-27</modified>
  </card>
  <card id="185">
    <name>Magic well</name>
    <class>Common</class>
    <cost>
      <gems>6</gems>
      <recruits>6</recruits>
    </cost>
    <level>4</level>
    <effect><![CDATA[If Magic < Enemy magic<br />Magic: +1<br />else<br />Gems: +11]]></effect>
    <code><![CDATA[
    if ($mydata->Magic < $hisdata->Magic) $mydata->Magic+= 1;
    else $mydata->Gems+= 11;
]]></code>
    <created>2007-03-26</created>
    <modified>2013-10-19</modified>
  </card>
  <card id="186">
    <name>Ent</name>
    <class>Uncommon</class>
    <cost>
      <gems>14</gems>
      <recruits>7</recruits>
    </cost>
    <level>2</level>
    <keywords>Alliance,Nature</keywords>
    <effect><![CDATA[Enemy wall: -40]]></effect>
    <code><![CDATA[$hisdata->Wall-= 40;]]></code>
    <created>2006-05-01</created>
    <modified>2009-06-22</modified>
  </card>
  <card id="187">
    <name>Mithril mine</name>
    <class>Common</class>
    <cost>
      <bricks>5</bricks>
      <gems>5</gems>
    </cost>
    <level>5</level>
    <effect><![CDATA[If Quarry < Enemy quarry<br />Quarry: +1<br />else<br />Bricks: +11]]></effect>
    <code><![CDATA[
    if ($mydata->Quarry < $hisdata->Quarry) $mydata->Quarry+= 1;
    else $mydata->Bricks+= 11;
]]></code>
    <created>2007-03-26</created>
    <modified>2013-10-19</modified>
  </card>
  <card id="188">
    <name>Crenellation</name>
    <class>Common</class>
    <cost>
      <bricks>2</bricks>
    </cost>
    <level>3</level>
    <keywords>Runic</keywords>
    <effect><![CDATA[Wall: +5<br />Enemy tower: -1]]></effect>
    <code><![CDATA[$mydata->Wall+= 5; $hisdata->Tower-= 1;]]></code>
    <created>2006-05-01</created>
    <modified>2011-04-24</modified>
  </card>
  <card id="189">
    <name>Foundry</name>
    <class>Uncommon</class>
    <cost>
      <bricks>10</bricks>
    </cost>
    <level>0</level>
    <keywords>Alliance</keywords>
    <effect><![CDATA[Tower: +5<br />Recruits prod x3]]></effect>
    <code><![CDATA[$mydata->Tower+= 5; $production->multiplyRecruits(3);]]></code>
    <created>2006-05-01</created>
    <modified>2010-01-20</modified>
  </card>
  <card id="190">
    <name>Elven ranger</name>
    <class>Uncommon</class>
    <cost>
      <recruits>11</recruits>
    </cost>
    <level>5</level>
    <keywords>Alliance,Far sight,Skirmisher</keywords>
    <effect><![CDATA[Attack: 11<br />Gems prod x2]]></effect>
    <code><![CDATA[$hisdata->attack(11); $production->multiplyGems(2);]]></code>
    <created>2006-05-01</created>
    <modified>2011-01-24</modified>
  </card>
  <card id="191">
    <name>Ivory tower</name>
    <class>Uncommon</class>
    <cost>
      <bricks>16</bricks>
    </cost>
    <level>0</level>
    <effect><![CDATA[Tower: +20]]></effect>
    <code><![CDATA[$mydata->Tower+= 20;]]></code>
    <created>2006-05-01</created>
    <modified>2010-01-20</modified>
  </card>
  <card id="192">
    <name>Fortified castle</name>
    <class>Rare</class>
    <cost>
      <bricks>40</bricks>
    </cost>
    <level>0</level>
    <effect><![CDATA[Tower: +45<br />Wall: +25]]></effect>
    <code><![CDATA[$mydata->Tower+= 45; $mydata->Wall+= 25;]]></code>
    <created>2006-05-01</created>
    <modified>2010-03-14</modified>
  </card>
  <card id="193">
    <name>Royal pikemen</name>
    <class>Uncommon</class>
    <cost>
      <recruits>18</recruits>
    </cost>
    <level>3</level>
    <keywords>Soldier,Skirmisher</keywords>
    <effect><![CDATA[Attack: 10<br />Wall: +10<br />Recruits: +4]]></effect>
    <code><![CDATA[$hisdata->attack(10); $mydata->Wall+= 10; $mydata->Recruits+= 4;]]></code>
    <created>2006-05-01</created>
    <modified>2012-06-24</modified>
  </card>
  <card id="194">
    <name>Draft</name>
    <class>Common</class>
    <cost>
      <bricks>1</bricks>
      <gems>1</gems>
      <recruits>1</recruits>
    </cost>
    <level>10</level>
    <effect><![CDATA[Summons a <b>Soldier</b><br />If <b>Soldier</b> tokens are set gain recruits cost of the summoned card (max 6)]]></effect>
    <code><![CDATA[
    $nextcard = $this->drawCard($this->getList(['keyword'=>'Soldier']), $mydata->Hand, $cardpos, 'drawCardList');
    if ($mydata->findToken('Soldier'))
      $mydata->Recruits+= min($this->getCard($nextcard)->getResources('Recruits'), 6);
]]></code>
    <created>2006-05-01</created>
    <modified>2009-06-22</modified>
  </card>
  <card id="195">
    <name>Fairy dragon</name>
    <class>Uncommon</class>
    <cost>
      <gems>15</gems>
    </cost>
    <level>5</level>
    <keywords>Dragon,Quick</keywords>
    <effect><![CDATA[Moves all <b>Dragon</b> cards from opponent's hand to your hand (to matching positions)<br />If there are none<br />Stock: +6]]></effect>
    <code><![CDATA[
    if ($this->keywordCount($hisdata->Hand, 'Dragon') == 0) {
      $mydata->addStock(6);
    }
    else
      for ($i = 1; $i <= 8; $i++)
        if ($this->getCard($hisdata->Hand[$i])->hasKeyword('Dragon')) {
          $this->setCard('my', $i, $hisdata->Hand[$i], ['reveal' => true]);
          $this->setCard('his', $i, $this->drawCard($his_deck, $hisdata->Hand, $i, 'drawCardDifferent'));
          if ($cardpos == $i) $nextcard = 0;
        }
]]></code>
    <created>2006-05-01</created>
    <modified>2015-09-26</modified>
  </card>
  <card id="196">
    <name>Monastery</name>
    <class>Uncommon</class>
    <cost>
      <bricks>10</bricks>
    </cost>
    <level>10</level>
    <keywords>Holy</keywords>
    <effect><![CDATA[Tower: +12<br />Summons non-common <b>Holy</b>]]></effect>
    <code><![CDATA[
    $mydata->Tower+= 12;
    $uncommon = $this->getList(['class'=>'Uncommon', 'keyword'=>'Holy']);
    $rare = $this->getList(['class'=>'Rare', 'keyword'=>'Holy']);
    $nextcard = $this->drawCard(array_merge($uncommon, $rare), $mydata->Hand, $cardpos, 'drawCardList');
]]></code>
    <created>2006-05-01</created>
    <modified>2010-10-03</modified>
  </card>
  <card id="197">
    <name>Pit fiend</name>
    <class>Rare</class>
    <cost>
      <gems>12</gems>
      <recruits>13</recruits>
    </cost>
    <level>0</level>
    <keywords>Demonic,Far sight,Charge (10)</keywords>
    <effect><![CDATA[Attack: 20<br />Enemy quarry: -1]]></effect>
    <code><![CDATA[$hisdata->attack(20); $hisdata->Quarry-= 1;]]></code>
    <created>2006-05-01</created>
    <modified>2013-12-24</modified>
  </card>
  <card id="198">
    <name>Demolition troop</name>
    <class>Rare</class>
    <cost>
      <gems>19</gems>
      <recruits>19</recruits>
    </cost>
    <level>4</level>
    <effect><![CDATA[Enemy wall: -60<br />If Enemy wall = 0<br />Enemy facilities: -1]]></effect>
    <code><![CDATA[
    $hisdata->Wall-= 60;
    if ($hisdata->Wall <= 0) {
      $hisdata->addFacilities(-1);
    }
]]></code>
    <created>2006-05-01</created>
    <modified>2008-12-24</modified>
  </card>
  <card id="199">
    <name>Duplication</name>
    <class>Rare</class>
    <cost>
      <gems>35</gems>
    </cost>
    <level>0</level>
    <keywords>Illusion,Swift</keywords>
    <effect><![CDATA[Stock x2]]></effect>
    <code><![CDATA[$mydata->Bricks= ($mydata->Bricks * 2); $mydata->Gems= ($mydata->Gems * 2); $mydata->Recruits= ($mydata->Recruits * 2);]]></code>
    <created>2006-05-01</created>
    <modified>2007-08-18</modified>
  </card>
  <card id="200">
    <name>Inspiration</name>
    <class>Uncommon</class>
    <cost>
      <bricks>5</bricks>
    </cost>
    <level>3</level>
    <effect><![CDATA[Tower: +20<br />Enemy tower: +30]]></effect>
    <code><![CDATA[$mydata->Tower+= 20; $hisdata->Tower+= 30;]]></code>
    <created>2006-05-01</created>
    <modified>2006-05-01</modified>
  </card>
  <card id="201">
    <name>Ballistae</name>
    <class>Uncommon</class>
    <cost>
      <bricks>15</bricks>
      <recruits>15</recruits>
    </cost>
    <level>0</level>
    <keywords>Siege</keywords>
    <effect><![CDATA[Wall: +30<br />If #<b>Siege</b> in hand > 1<br />Enemy tower: -10]]></effect>
    <code><![CDATA[
    $mydata->Wall+= 30;
    if ($this->keywordCount($mydata->Hand, 'Siege') > 1) $hisdata->Tower-= 10;
]]></code>
    <created>2006-05-01</created>
    <modified>2011-04-24</modified>
  </card>
  <card id="202">
    <name>Roc</name>
    <class>Uncommon</class>
    <cost>
      <recruits>15</recruits>
    </cost>
    <level>6</level>
    <keywords>Beast,Horde,Aria</keywords>
    <effect><![CDATA[Attack: 17<br />Bricks: +5<br />Enemy bricks: -5]]></effect>
    <code><![CDATA[
    $hisdata->attack(17);
    $mydata->Bricks+= 5; $hisdata->Bricks-= 5;
]]></code>
    <created>2006-05-01</created>
    <modified>2012-07-15</modified>
  </card>
  <card id="203">
    <name>Crypt</name>
    <class>Uncommon</class>
    <cost>
      <bricks>17</bricks>
    </cost>
    <level>10</level>
    <effect><![CDATA[Summons non-common <b>Undead</b><br />If <b>Undead</b> tokens > 50<br />Gain cost of the summoned card (max 10)]]></effect>
    <code><![CDATA[
    $uncommon = $this->getList(['class'=>'Uncommon', 'keyword'=>'Undead']);
    $rare = $this->getList(['class'=>'Rare', 'keyword'=>'Undead']);
    $nextcard = $this->drawCard(array_merge($uncommon, $rare), $mydata->Hand, $cardpos, 'drawCardList');
    if ($mydata->getToken('Undead') > 50) {
      $cur_card = $this->getCard($nextcard);
      $mydata->Bricks+= min($cur_card->getResources('Bricks'), 10);
      $mydata->Gems+= min($cur_card->getResources('Gems'), 10);
      $mydata->Recruits+= min($cur_card->getResources('Recruits'), 10);
    }
]]></code>
    <created>2006-05-01</created>
    <modified>2012-09-08</modified>
  </card>
  <card id="204">
    <name>Air elemental</name>
    <class>Uncommon</class>
    <cost>
      <gems>10</gems>
    </cost>
    <level>0</level>
    <keywords>Unliving,Aria</keywords>
    <effect><![CDATA[Enemy tower: -9]]></effect>
    <code><![CDATA[$hisdata->Tower-= 9;]]></code>
    <created>2006-05-01</created>
    <modified>2012-06-24</modified>
  </card>
  <card id="205">
    <name>Danai present</name>
    <class>Rare</class>
    <level>6</level>
    <effect><![CDATA[Enemy stock: +10<br />Replace opponent's hand with non-rare zero cost cards]]></effect>
    <code><![CDATA[
    $hisdata->addStock(10);
    $common = $this->getList(['class'=>'Common', 'cost'=>'Zero']);
    $uncommon = $this->getList(['class'=>'Uncommon', 'cost'=>'Zero']);
    $this->setHand('his', $this->drawHandList(array_merge($common, $uncommon)));
]]></code>
    <created>2006-05-01</created>
    <modified>2010-04-11</modified>
  </card>
  <card id="206">
    <name>Drought</name>
    <class>Common</class>
    <level>5</level>
    <effect><![CDATA[Stock: -8<br />Enemy stock: -8]]></effect>
    <code><![CDATA[$mydata->addStock(-8); $hisdata->addStock(-8);]]></code>
    <created>2006-05-01</created>
    <modified>2011-02-12</modified>
  </card>
  <card id="207">
    <name>Shapeshifter</name>
    <class>Uncommon</class>
    <cost>
      <gems>7</gems>
    </cost>
    <modes>8</modes>
    <level>8</level>
    <effect><![CDATA[Summons selected card in opponent's hand]]></effect>
    <code><![CDATA[$nextcard = $hisdata->Hand[$mode];]]></code>
    <created>2007-03-26</created>
    <modified>2014-04-21</modified>
  </card>
  <card id="208">
    <name>Overseer</name>
    <class>Uncommon</class>
    <level>0</level>
    <keywords>Horde</keywords>
    <effect><![CDATA[Wall: +30<br />Quarry: -1]]></effect>
    <code><![CDATA[$mydata->Wall+= 30; $mydata->Quarry-= 1;]]></code>
    <created>2006-05-01</created>
    <modified>2011-12-24</modified>
  </card>
  <card id="209">
    <name>Overlord</name>
    <class>Rare</class>
    <modes>2</modes>
    <level>4</level>
    <keywords>Horde</keywords>
    <effect><![CDATA[Wall: +70<br />Mode1:<br />Quarry: -1<br />Mode2:<br />Dungeon: -1]]></effect>
    <code><![CDATA[
    $mydata->Wall+= 70;
    if ($mode == 1) $mydata->Quarry-= 1;
    elseif ($mode == 2) $mydata->Dungeons-= 1;
]]></code>
    <created>2006-05-01</created>
    <modified>2011-12-24</modified>
  </card>
  <card id="210">
    <name>Rescue and resistance</name>
    <class>Uncommon</class>
    <level>6</level>
    <effect><![CDATA[If Enemy tower < Tower<br />Tower: -10<br />Enemy tower: -10<br />else<br />Tower: +10<br />Enemy tower: +10]]></effect>
    <code><![CDATA[
    if ($hisdata->Tower < $mydata->Tower) {
      $mydata->Tower-= 10; $hisdata->Tower-= 10;
    }
    else {
      $mydata->Tower+= 10; $hisdata->Tower+= 10;
    }
]]></code>
    <created>2006-05-01</created>
    <modified>2006-05-01</modified>
  </card>
  <card id="211">
    <name>Hectic offensive</name>
    <class>Uncommon</class>
    <cost>
      <recruits>13</recruits>
    </cost>
    <level>0</level>
    <effect><![CDATA[If Enemy wall - Wall > 10<br />Attack: 25<br />else<br />Attack: 15]]></effect>
    <code><![CDATA[
    if (($hisdata->Wall - $mydata->Wall) > 10) $hisdata->attack(25);
    else $hisdata->attack(15);
]]></code>
    <created>2006-05-01</created>
    <modified>2010-03-14</modified>
  </card>
  <card id="212">
    <name>Rogue</name>
    <class>Common</class>
    <cost>
      <recruits>1</recruits>
    </cost>
    <modes>8</modes>
    <level>5</level>
    <keywords>Brigand,Far sight</keywords>
    <effect><![CDATA[Attack: 2<br />Enemy recruits: -1<br />Replace a card in hand with self]]></effect>
    <code><![CDATA[
    $hisdata->attack(2); $hisdata->Recruits-= 1;
    if ($mode == $cardpos) $nextcard = 0;
    else $this->replaceCard('my', $mode, $card->id());
]]></code>
    <created>2006-05-01</created>
    <modified>2011-12-24</modified>
  </card>
  <card id="213">
    <name>Kidnapping</name>
    <class>Uncommon</class>
    <cost>
      <gems>6</gems>
      <recruits>7</recruits>
    </cost>
    <level>4</level>
    <effect><![CDATA[Quarry: +1<br />If Enemy quarry > 3<br />Enemy quarry: -1]]></effect>
    <code><![CDATA[$mydata->Quarry+= 1; if ($hisdata->Quarry > 3) $hisdata->Quarry-= 1;]]></code>
    <created>2006-05-01</created>
    <modified>2013-10-19</modified>
  </card>
  <card id="214">
    <name>Elder shrine</name>
    <class>Uncommon</class>
    <cost>
      <bricks>9</bricks>
      <recruits>8</recruits>
    </cost>
    <level>3</level>
    <effect><![CDATA[Magic: +1<br />If Enemy magic > 3<br />Enemy magic: -1]]></effect>
    <code><![CDATA[$mydata->Magic+= 1; if ($hisdata->Magic > 3) $hisdata->Magic-= 1;]]></code>
    <created>2006-05-01</created>
    <modified>2013-10-19</modified>
  </card>
  <card id="215">
    <name>Harpist</name>
    <class>Uncommon</class>
    <cost>
      <bricks>9</bricks>
      <gems>8</gems>
    </cost>
    <level>3</level>
    <effect><![CDATA[Dungeon: +1<br />If Enemy dungeon > 3<br />Enemy dungeon: -1]]></effect>
    <code><![CDATA[$mydata->Dungeons+= 1; if ($hisdata->Dungeons > 3) $hisdata->Dungeons-= 1;]]></code>
    <created>2006-05-01</created>
    <modified>2013-10-19</modified>
  </card>
  <card id="216">
    <name>Salvation</name>
    <class>Uncommon</class>
    <level>0</level>
    <keywords>Quick</keywords>
    <effect><![CDATA[If Tower < 15<br />Tower: +15<br />else<br />Tower: +3]]></effect>
    <code><![CDATA[if ($mydata->Tower < 15) $mydata->Tower+= 15; else $mydata->Tower+= 3;]]></code>
    <created>2006-05-01</created>
    <modified>2011-01-24</modified>
  </card>
  <card id="217">
    <name>Auxilia</name>
    <class>Uncommon</class>
    <cost>
      <recruits>1</recruits>
    </cost>
    <modes>8</modes>
    <level>9</level>
    <effect><![CDATA[Wall: +2<br />Production x0<br />Discard your hand except the selected card]]></effect>
    <code><![CDATA[
    $mydata->Wall+= 2;
    $production->multiply(0);
    for ($i = 1; $i <= 8; $i++) {
      if ($i != $mode and $i != $cardpos) {
        $this->setCard('my', $i, $this->drawCard($my_deck, $mydata->Hand, $i, 'drawCardRandom'));
      }
    }
]]></code>
    <created>2007-03-26</created>
    <modified>2011-01-24</modified>
  </card>
  <card id="218">
    <name>Mana burn</name>
    <class>Rare</class>
    <cost>
      <gems>20</gems>
    </cost>
    <level>8</level>
    <keywords>Destruction</keywords>
    <effect><![CDATA[Enemy tower: -N/2<br />Enemy wall: -N<br />Enemy gems: -N<br />N = #Enemy gems (max 30)]]></effect>
    <code><![CDATA[$tmp = min($hisdata->Gems, 30); $hisdata->Tower-= round($tmp / 2); $hisdata->Wall-= $tmp; $hisdata->Gems-= $tmp;]]></code>
    <created>2006-11-14</created>
    <modified>2012-04-07</modified>
  </card>
  <card id="219">
    <name>Rock biter</name>
    <class>Uncommon</class>
    <cost>
      <bricks>12</bricks>
      <recruits>8</recruits>
    </cost>
    <modes>2</modes>
    <level>5</level>
    <keywords>Unliving</keywords>
    <effect><![CDATA[Mode1:<br />Attack: 16<br />Mode2:<br />Wall: +13<br />Enemy wall: -13]]></effect>
    <code><![CDATA[
    if ($mode == 1) $hisdata->attack(16);
    elseif ($mode == 2) { $mydata->Wall+= 13; $hisdata->Wall-= 13; }
]]></code>
    <created>2007-03-26</created>
    <modified>2014-04-21</modified>
  </card>
  <card id="220">
    <name>Enforcer</name>
    <class>Uncommon</class>
    <cost>
      <recruits>15</recruits>
    </cost>
    <modes>2</modes>
    <level>4</level>
    <effect><![CDATA[Attack: 26<br />Mode1:<br />Stock: -2<br />Mode2:<br />Tower: -5<br />Wall: -5]]></effect>
    <code><![CDATA[
    $hisdata->attack(26);
    if ($mode == 1) {
      $mydata->addStock(-2);
    }
    elseif ($mode == 2) {
      $mydata->Tower-= 5; $mydata->Wall-= 5;
    }
]]></code>
    <created>2007-03-26</created>
    <modified>2011-01-24</modified>
  </card>
  <card id="221">
    <name>Implosion</name>
    <class>Rare</class>
    <cost>
      <gems>35</gems>
      <recruits>25</recruits>
    </cost>
    <level>8</level>
    <keywords>Destruction</keywords>
    <effect><![CDATA[Enemy tower: -N<br />Enemy wall: -N<br />N = 7#Enemy quarry + #Enemy bricks]]></effect>
    <code><![CDATA[
    $tmp = ($hisdata->Quarry * 7) + $hisdata->Bricks;
    $hisdata->Tower-= $tmp; $hisdata->Wall-= $tmp;
]]></code>
    <created>2007-03-26</created>
    <modified>2011-01-01</modified>
  </card>
  <card id="222">
    <name>Water elemental</name>
    <class>Rare</class>
    <cost>
      <gems>19</gems>
    </cost>
    <level>3</level>
    <keywords>Aqua,Unliving</keywords>
    <effect><![CDATA[If #Facilities > #Enemy facilities<br />Enemy wall = 0<br />Always:<br />Attack: #Stock - #Enemy stock]]></effect>
    <code><![CDATA[
    $tmp = max(0, $mydata->Quarry + $mydata->Magic + $mydata->Dungeons - $hisdata->Quarry - $hisdata->Magic - $hisdata->Dungeons);
    if ($tmp > 0) {
      $hisdata->Wall = 0;
    }
    $tmp = max(0, $mydata->Bricks + $mydata->Gems + $mydata->Recruits - $hisdata->Bricks - $hisdata->Gems - $hisdata->Recruits);
    $hisdata->attack($tmp);
]]></code>
    <created>2007-03-26</created>
    <modified>2010-04-11</modified>
  </card>
  <card id="223">
    <name>Phoenix</name>
    <class>Rare</class>
    <cost>
      <gems>31</gems>
      <recruits>22</recruits>
    </cost>
    <level>10</level>
    <keywords>Burning,Rebirth,Flare attack</keywords>
    <effect><![CDATA[Attack: 10N<br />N = #<b>Burning</b> in game]]></effect>
    <code><![CDATA[
    $tmp = $this->keywordCount($mydata->Hand, 'Burning') + $this->keywordCount($hisdata->Hand, 'Burning');
    $hisdata->attack(10 * $tmp);
]]></code>
    <created>2007-05-08</created>
    <modified>2012-06-24</modified>
  </card>
  <card id="224">
    <name>Tidal wave</name>
    <class>Uncommon</class>
    <cost>
      <gems>17</gems>
    </cost>
    <level>7</level>
    <effect><![CDATA[Player(s) with lowest wall suffers<br />Quarry: -1<br />Dungeon: -1]]></effect>
    <code><![CDATA[
    if ($mydata->Wall <= $hisdata->Wall) { $mydata->Quarry-= 1; $mydata->Dungeons-= 1; };
    if ($hisdata->Wall <= $mydata->Wall) { $hisdata->Quarry-= 1; $hisdata->Dungeons-= 1; };
]]></code>
    <created>2007-05-08</created>
    <modified>2015-08-01</modified>
  </card>
  <card id="225">
    <name>Cultists</name>
    <class>Uncommon</class>
    <cost>
      <recruits>10</recruits>
    </cost>
    <level>9</level>
    <effect><![CDATA[If Dungeon < Enemy dungeon<br />Enemy dungeon: -2<br />else<br />Dungeon: = 4]]></effect>
    <code><![CDATA[
    if ($mydata->Dungeons < $hisdata->Dungeons) $hisdata->Dungeons-= 2;
    else $mydata->Dungeons = 4;
]]></code>
    <created>2007-05-08</created>
    <modified>2013-10-19</modified>
  </card>
  <card id="226">
    <name>Soul cleaver</name>
    <class>Uncommon</class>
    <cost>
      <gems>10</gems>
    </cost>
    <level>6</level>
    <effect><![CDATA[If Magic < Enemy magic<br />Enemy magic: -2<br />else<br />Magic: = 4]]></effect>
    <code><![CDATA[
    if ($mydata->Magic < $hisdata->Magic) $hisdata->Magic-= 2;
    else $mydata->Magic = 4;
]]></code>
    <created>2007-05-08</created>
    <modified>2013-10-19</modified>
  </card>
  <card id="227">
    <name>Earth elemental</name>
    <class>Uncommon</class>
    <cost>
      <bricks>15</bricks>
    </cost>
    <level>9</level>
    <keywords>Unliving</keywords>
    <effect><![CDATA[If Quarry < Enemy quarry<br />Enemy quarry: -2<br />else<br />Quarry: = 4]]></effect>
    <code><![CDATA[
    if ($mydata->Quarry < $hisdata->Quarry) $hisdata->Quarry-= 2;
    else $mydata->Quarry = 4;
]]></code>
    <created>2007-05-08</created>
    <modified>2013-10-19</modified>
  </card>
  <card id="228">
    <name>Forgotten castle</name>
    <class>Uncommon</class>
    <cost>
      <bricks>46</bricks>
    </cost>
    <level>9</level>
    <keywords>Runic</keywords>
    <effect><![CDATA[Tower: +35<br/>Stock: +10]]></effect>
    <code><![CDATA[
    $mydata->Tower+= 35;
    $mydata->addStock(10);
]]></code>
    <created>2007-05-08</created>
    <modified>2013-03-31</modified>
  </card>
  <card id="229">
    <name>Apocalyptic rain</name>
    <class>Rare</class>
    <cost>
      <gems>34</gems>
    </cost>
    <level>3</level>
    <keywords>Destruction,Nature</keywords>
    <effect><![CDATA[Attack: N * M / 3<br />N = #Bricks<br />M = #Magic<br />Bricks: = 0]]></effect>
    <code><![CDATA[
    $hisdata->attack(round(($mydata->Bricks * $mydata->Magic) / 3));
    $mydata->Bricks= 0;
]]></code>
    <created>2006-05-01</created>
    <modified>2011-02-12</modified>
  </card>
  <card id="230">
    <name>Locust swarm</name>
    <class>Uncommon</class>
    <cost>
      <recruits>16</recruits>
    </cost>
    <level>0</level>
    <effect><![CDATA[If Enemy wall < 5<br />Attack: 35<br />else<br />Attack: 11]]></effect>
    <code><![CDATA[
    if ($hisdata->Wall < 5) $hisdata->attack(35);
    else $hisdata->attack(11);
]]></code>
    <created>2007-05-08</created>
    <modified>2011-12-24</modified>
  </card>
  <card id="231">
    <name>Blind guardian</name>
    <class>Uncommon</class>
    <cost>
      <bricks>4</bricks>
      <gems>4</gems>
      <recruits>4</recruits>
    </cost>
    <level>4</level>
    <effect><![CDATA[Tower: +12]]></effect>
    <code><![CDATA[$mydata->Tower+= 12;]]></code>
    <created>2006-05-01</created>
    <modified>2010-07-22</modified>
  </card>
  <card id="232">
    <name>Governour</name>
    <class>Rare</class>
    <cost>
      <recruits>20</recruits>
    </cost>
    <level>0</level>
    <effect><![CDATA[Attack: 20<br />Tower: +10<br />Wall: +10<br />Production x2]]></effect>
    <code><![CDATA[
    $hisdata->attack(20);
    $mydata->Tower+= 10; $mydata->Wall+= 10;
    $production->multiply(2);
]]></code>
    <created>2006-05-01</created>
    <modified>2010-04-11</modified>
  </card>
  <card id="233">
    <name>Magic academy</name>
    <class>Rare</class>
    <cost>
      <bricks>15</bricks>
      <gems>15</gems>
    </cost>
    <level>0</level>
    <keywords>Durable</keywords>
    <effect><![CDATA[Tower: +15<br />Magic: +1]]></effect>
    <code><![CDATA[$mydata->Tower+= 15; $mydata->Magic+= 1;]]></code>
    <created>2006-05-01</created>
    <modified>2006-05-01</modified>
  </card>
  <card id="234">
    <name>Manufactory</name>
    <class>Rare</class>
    <cost>
      <bricks>15</bricks>
      <recruits>15</recruits>
    </cost>
    <level>3</level>
    <keywords>Durable</keywords>
    <effect><![CDATA[Tower: +15<br />Dungeon: +1]]></effect>
    <code><![CDATA[$mydata->Tower+= 15; $mydata->Dungeons+= 1;]]></code>
    <created>2006-05-01</created>
    <modified>2008-12-24</modified>
  </card>
  <card id="235">
    <name>Architect academy</name>
    <class>Rare</class>
    <cost>
      <bricks>30</bricks>
    </cost>
    <level>0</level>
    <keywords>Durable</keywords>
    <effect><![CDATA[Tower: +15<br />Quarry: +1]]></effect>
    <code><![CDATA[$mydata->Tower+= 15; $mydata->Quarry+= 1;]]></code>
    <created>2006-05-01</created>
    <modified>2010-12-24</modified>
  </card>
  <card id="236">
    <name>Centaur tribe</name>
    <class>Common</class>
    <cost>
      <recruits>6</recruits>
    </cost>
    <modes>2</modes>
    <level>0</level>
    <keywords>Beast,Horde</keywords>
    <effect><![CDATA[Attack: 12<br />Mode1:<br />Tower: -2<br />Mode2:<br />Wall: -4]]></effect>
    <code><![CDATA[
    $hisdata->attack(12);
    if ($mode == 1) $mydata->Tower-= 2; elseif ($mode == 2) $mydata->Wall-= 4;
]]></code>
    <created>2006-05-01</created>
    <modified>2011-12-24</modified>
  </card>
  <card id="237">
    <name>Guard post</name>
    <class>Common</class>
    <cost>
      <bricks>2</bricks>
    </cost>
    <level>2</level>
    <keywords>Runic</keywords>
    <effect><![CDATA[Tower: +3<br />Recruits: +1]]></effect>
    <code><![CDATA[$mydata->Tower+= 3; $mydata->Recruits+= 1;]]></code>
    <created>2006-05-01</created>
    <modified>2011-04-24</modified>
  </card>
  <card id="238">
    <name>Fortified wall</name>
    <class>Common</class>
    <cost>
      <bricks>4</bricks>
    </cost>
    <level>0</level>
    <effect><![CDATA[Wall: +8]]></effect>
    <code><![CDATA[$mydata->Wall+= 8;]]></code>
    <created>2006-05-01</created>
    <modified>2011-01-24</modified>
  </card>
  <card id="239">
    <name>Golden dragon</name>
    <class>Rare</class>
    <cost>
      <gems>35</gems>
      <recruits>35</recruits>
    </cost>
    <level>6</level>
    <keywords>Dragon</keywords>
    <effect><![CDATA[Attack: 110]]></effect>
    <code><![CDATA[$hisdata->attack(110);]]></code>
    <created>2006-05-01</created>
    <modified>2010-07-22</modified>
  </card>
  <card id="240">
    <name>Orc grunt</name>
    <class>Common</class>
    <cost>
      <recruits>6</recruits>
    </cost>
    <level>0</level>
    <keywords>Horde,Frenzy</keywords>
    <effect><![CDATA[Attack: 8]]></effect>
    <code><![CDATA[$hisdata->attack(8);]]></code>
    <created>2006-05-01</created>
    <modified>2012-12-24</modified>
  </card>
  <card id="241">
    <name>Blizzard</name>
    <class>Uncommon</class>
    <cost>
      <gems>32</gems>
    </cost>
    <level>3</level>
    <keywords>Nature,Aria</keywords>
    <effect><![CDATA[Enemy stock: -20]]></effect>
    <code><![CDATA[$hisdata->addStock(-20);]]></code>
    <created>2006-05-01</created>
    <modified>2012-09-08</modified>
  </card>
  <card id="242">
    <name>Tornado</name>
    <class>Rare</class>
    <cost>
      <gems>37</gems>
    </cost>
    <level>0</level>
    <keywords>Nature</keywords>
    <effect><![CDATA[Enemy stock: = 0]]></effect>
    <code><![CDATA[$hisdata->setStock(0);]]></code>
    <created>2006-05-01</created>
    <modified>2012-09-08</modified>
  </card>
  <card id="243">
    <name>Thieves with honor</name>
    <class>Common</class>
    <cost>
      <recruits>1</recruits>
    </cost>
    <level>7</level>
    <keywords>Brigand</keywords>
    <effect><![CDATA[Enemy tower: -6<br />Enemy stock: +2]]></effect>
    <code><![CDATA[$hisdata->Tower-= 6; $hisdata->addStock(2);]]></code>
    <created>2006-05-01</created>
    <modified>2009-06-22</modified>
  </card>
  <card id="244">
    <name>Assassins</name>
    <class>Uncommon</class>
    <cost>
      <recruits>7</recruits>
    </cost>
    <level>3</level>
    <keywords>Brigand</keywords>
    <effect><![CDATA[Enemy tower: -5<br />Enemy stock: -2]]></effect>
    <code><![CDATA[$hisdata->Tower-= 5; $hisdata->addStock(-2);]]></code>
    <created>2006-05-01</created>
    <modified>2009-10-26</modified>
  </card>
  <card id="245">
    <name>Sabotage tunnel</name>
    <class>Uncommon</class>
    <cost>
      <bricks>35</bricks>
    </cost>
    <level>7</level>
    <effect><![CDATA[Enemy tower: -20<br />Enemy bricks: -10<br />Enemy recruits: -10]]></effect>
    <code><![CDATA[$hisdata->Tower-= 20; $hisdata->Bricks-= 10; $hisdata->Recruits-= 10;]]></code>
    <created>2006-05-01</created>
    <modified>2007-11-25</modified>
  </card>
  <card id="246">
    <name>Siege golem</name>
    <class>Rare</class>
    <cost>
      <bricks>24</bricks>
    </cost>
    <level>7</level>
    <keywords>Unliving,Durable,Siege</keywords>
    <effect><![CDATA[Enemy tower: -10<br />Enemy wall: -10]]></effect>
    <code><![CDATA[$hisdata->Tower-= 10; $hisdata->Wall-= 10;]]></code>
    <created>2006-05-01</created>
    <modified>2011-04-24</modified>
  </card>
  <card id="247">
    <name>Wind</name>
    <class>Common</class>
    <level>0</level>
    <keywords>Aria</keywords>
    <effect><![CDATA[Enemy wall: -1<br />Enemy stock: -1]]></effect>
    <code><![CDATA[$hisdata->Wall-= 1; $hisdata->addStock(-1);]]></code>
    <created>2006-05-01</created>
    <modified>2012-06-24</modified>
  </card>
  <card id="248">
    <name>Searing fire</name>
    <class>Common</class>
    <level>8</level>
    <keywords>Burning</keywords>
    <effect><![CDATA[Tower: -2<br />Wall: -5<br />Stock: -2<br />Enemy tower: -2<br />Enemy wall: -5<br />Enemy stock: -2]]></effect>
    <code><![CDATA[
    $mydata->addStock(-2);
    $mydata->Tower-= 2; $mydata->Wall-= 5;
    $hisdata->addStock(-2);
    $hisdata->Tower-= 2; $hisdata->Wall-= 5;
]]></code>
    <created>2007-05-08</created>
    <modified>2007-08-18</modified>
  </card>
  <card id="249">
    <name>Wall shift</name>
    <class>Rare</class>
    <cost>
      <gems>10</gems>
    </cost>
    <level>0</level>
    <keywords>Illusion</keywords>
    <effect><![CDATA[Switches wall with enemy wall]]></effect>
    <code><![CDATA[$tmp = $mydata->Wall; $mydata->Wall= $hisdata->Wall; $hisdata->Wall= $tmp;]]></code>
    <created>2006-11-14</created>
    <modified>2010-09-23</modified>
  </card>
  <card id="250">
    <name>Dragon whelp</name>
    <class>Common</class>
    <cost>
      <gems>3</gems>
    </cost>
    <level>0</level>
    <keywords>Burning,Dragon</keywords>
    <effect><![CDATA[Attack: 5]]></effect>
    <code><![CDATA[$hisdata->attack(5);]]></code>
    <created>2007-05-08</created>
    <modified>2007-05-08</modified>
  </card>
  <card id="251">
    <name>Tribute</name>
    <class>Common</class>
    <level>8</level>
    <effect><![CDATA[Players discard up to 3 non-rare cards (can't draw rare cards)]]></effect>
    <code><![CDATA[
    $my_storage = $his_storage = array();
    for ($i = 1; $i <= 8; $i++) {
      if ($i != $cardpos and $this->getCard($mydata->Hand[$i])->getClass() != 'Rare') $my_storage[] = $i;
      if ($this->getCard($hisdata->Hand[$i])->getClass() != 'Rare') $his_storage[] = $i;
    }
    $my_count = min(count($my_storage), 3);
    if ($my_count > 0) {
      shuffle($my_storage);
      for ($k = 0; $k < $my_count; $k++) {
        $i = $my_storage[$k];
        $this->setCard('my', $i, $this->drawCard($my_deck, $mydata->Hand, $i, 'drawCardNoRare'));
      }
    }
    $his_count = min(count($his_storage), 3);
    if ($his_count > 0) {
      shuffle($his_storage);
      for ($k = 0; $k < $his_count; $k++) {
        $i = $his_storage[$k];
        $this->setCard('his', $i, $this->drawCard($his_deck, $hisdata->Hand, $i, 'drawCardNoRare'));
      }
    }
]]></code>
    <created>2007-05-08</created>
    <modified>2012-09-08</modified>
  </card>
  <card id="252">
    <name>Black market</name>
    <class>Common</class>
    <modes>8</modes>
    <level>9</level>
    <effect><![CDATA[Production x0<br />Switches selected non-rare card with its matching non-rare card (can't target self)]]></effect>
    <code><![CDATA[
    $production->multiply(0);
    if ($mode != $cardpos and $this->getCard($mydata->Hand[$mode])->getClass() != 'Rare' and $this->getCard($hisdata->Hand[$mode])->getClass() != 'Rare') {
      $tmp = $mydata->Hand[$mode];
      $this->setCard('my', $mode, $hisdata->Hand[$mode], ['reveal' => true]);
      $this->setCard('his', $mode, $tmp, ['reveal' => true]);
    }
]]></code>
    <created>2007-05-08</created>
    <modified>2015-09-26</modified>
  </card>
  <card id="253">
    <name>Necropolis</name>
    <class>Rare</class>
    <cost>
      <bricks>30</bricks>
    </cost>
    <level>10</level>
    <effect><![CDATA[Tower: +10<br />Gems: +10<br />Replace your hand with 4 common, 3 uncommon and 1 rare <b>Undead</b> cards]]></effect>
    <code><![CDATA[
    $mydata->Tower+= 10; $mydata->Gems+= 10;
    $trans = ['Common', 'Common', 'Common', 'Common', 'Uncommon', 'Uncommon', 'Uncommon', 'Rare'];
    shuffle($trans);
    for ($i = 1; $i <= 8; $i++) {
      $this->setCard('my', $i, $this->drawCard($this->getList(['class'=>$trans[$i-1], 'keyword'=>'Undead']), $mydata->Hand, $i, 'drawCardList'));
    }
    $nextcard = 0;
]]></code>
    <created>2006-11-14</created>
    <modified>2012-09-08</modified>
  </card>
  <card id="254">
    <name>Lava spectre</name>
    <class>Uncommon</class>
    <cost>
      <gems>13</gems>
    </cost>
    <level>9</level>
    <keywords>Burning</keywords>
    <effect><![CDATA[Attack: 10<br />If #<b>Burning</b> in hand > 3<br />Magic: +1]]></effect>
    <code><![CDATA[
    $hisdata->attack(10);
    if ($this->keywordCount($mydata->Hand, 'Burning') > 3) $mydata->Magic+= 1;
]]></code>
    <created>2007-05-08</created>
    <modified>2012-09-08</modified>
  </card>
  <card id="255">
    <name>Evolution</name>
    <class>Rare</class>
    <cost>
      <gems>1</gems>
    </cost>
    <level>8</level>
    <keywords>Quick</keywords>
    <effect><![CDATA[Discard opponent's hand (can't draw rare cards)<br />If not New<br />Discard your hand]]></effect>
    <code><![CDATA[
    $this->setHand('his', $this->drawHandNoRare($his_deck));
    if (!isset($mynewflags[$cardpos])) {
      $this->setHand('my', $this->drawHandRandom($my_deck));
      $nextcard = 0;
    }
]]></code>
    <created>2006-05-01</created>
    <modified>2012-12-24</modified>
  </card>
  <card id="256">
    <name>Bronze golem</name>
    <class>Common</class>
    <cost>
      <bricks>4</bricks>
    </cost>
    <level>0</level>
    <keywords>Unliving,Banish</keywords>
    <effect><![CDATA[Enemy wall: -6]]></effect>
    <code><![CDATA[$hisdata->Wall-= 6;]]></code>
    <created>2007-08-19</created>
    <modified>2008-12-24</modified>
  </card>
  <card id="257">
    <name>Will o' wisp</name>
    <class>Common</class>
    <level>3</level>
    <keywords>Undead,Aria</keywords>
    <effect><![CDATA[Attack: N<br />N = #non-common cards in opponent's hand]]></effect>
    <code><![CDATA[
    $noncommon =  0;
    for ($i = 1; $i <= 8; $i++) {
      if ($this->getCard($hisdata->Hand[$i])->getClass() != 'Common') {
        $noncommon++;
      }
    }
    $hisdata->attack($noncommon);
]]></code>
    <created>2007-08-19</created>
    <modified>2013-07-27</modified>
  </card>
  <card id="258">
    <name>Giant bear</name>
    <class>Common</class>
    <cost>
      <recruits>4</recruits>
    </cost>
    <level>4</level>
    <keywords>Beast,Runic</keywords>
    <effect><![CDATA[Attack: 4<br />Recruits: +3]]></effect>
    <code><![CDATA[$hisdata->attack(4); $mydata->Recruits+= 3;]]></code>
    <created>2006-05-01</created>
    <modified>2011-04-24</modified>
  </card>
  <card id="259">
    <name>Dire wolves</name>
    <class>Common</class>
    <cost>
      <recruits>9</recruits>
    </cost>
    <level>0</level>
    <keywords>Beast,Horde</keywords>
    <effect><![CDATA[Attack: 9<br />Recruits prod x2]]></effect>
    <code><![CDATA[$hisdata->attack(9); $production->multiplyRecruits(2);]]></code>
    <created>2006-05-01</created>
    <modified>2011-12-24</modified>
  </card>
  <card id="260">
    <name>Burglar</name>
    <class>Common</class>
    <cost>
      <recruits>8</recruits>
    </cost>
    <level>0</level>
    <keywords>Brigand</keywords>
    <effect><![CDATA[Attack: 2<br />Stock: +2<br />Enemy stock: -2]]></effect>
    <code><![CDATA[
    $hisdata->attack(2);
    $mydata->addStock(2);
    $hisdata->addStock(-2);
]]></code>
    <created>2006-05-01</created>
    <modified>2010-07-22</modified>
  </card>
  <card id="261">
    <name>Absorption</name>
    <class>Common</class>
    <cost>
      <gems>4</gems>
    </cost>
    <level>0</level>
    <keywords>Destruction</keywords>
    <effect><![CDATA[Recruits: +4<br />Enemy recruits: -4]]></effect>
    <code><![CDATA[$mydata->Recruits+= 4; $hisdata->Recruits-= 4;]]></code>
    <created>2006-05-01</created>
    <modified>2011-12-24</modified>
  </card>
  <card id="262">
    <name>Magical forge</name>
    <class>Common</class>
    <cost>
      <bricks>1</bricks>
      <gems>1</gems>
      <recruits>1</recruits>
    </cost>
    <level>4</level>
    <effect><![CDATA[Wall: +7]]></effect>
    <code><![CDATA[$mydata->Wall+= 7;]]></code>
    <created>2006-05-01</created>
    <modified>2011-04-24</modified>
  </card>
  <card id="263">
    <name>Saints day</name>
    <class>Common</class>
    <level>5</level>
    <effect><![CDATA[Stock: +4<br />Production x0]]></effect>
    <code><![CDATA[$mydata->addStock(4); $production->multiply(0);]]></code>
    <created>2006-05-01</created>
    <modified>2007-09-26</modified>
  </card>
  <card id="264">
    <name>Second chance</name>
    <class>Uncommon</class>
    <cost>
      <bricks>1</bricks>
      <gems>1</gems>
      <recruits>1</recruits>
    </cost>
    <level>1</level>
    <effect><![CDATA[Discard all cards in hand]]></effect>
    <code><![CDATA[$this->setHand('my', $this->drawHandRandom($my_deck)); $nextcard = 0;]]></code>
    <created>2006-05-01</created>
    <modified>2010-07-22</modified>
  </card>
  <card id="265">
    <name>Residence of Gods</name>
    <class>Rare</class>
    <cost>
      <bricks>50</bricks>
      <gems>50</gems>
      <recruits>50</recruits>
    </cost>
    <level>9</level>
    <effect><![CDATA[Instant resource accumulation victory]]></effect>
    <code><![CDATA[$mydata->setStock(ceil($res_vic / 3));]]></code>
    <created>2006-05-01</created>
    <modified>2010-07-22</modified>
  </card>
  <card id="266">
    <name>Defense improvement</name>
    <class>Uncommon</class>
    <cost>
      <bricks>10</bricks>
    </cost>
    <modes>2</modes>
    <level>0</level>
    <effect><![CDATA[Mode1:<br />Wall: +20<br />Mode2:<br />Tower: +10]]></effect>
    <code><![CDATA[if ($mode == 1) $mydata->Wall+= 20; elseif ($mode == 2) $mydata->Tower+= 10;]]></code>
    <created>2006-05-01</created>
    <modified>2010-01-20</modified>
  </card>
  <card id="267">
    <name>University</name>
    <class>Uncommon</class>
    <cost>
      <bricks>6</bricks>
      <gems>6</gems>
      <recruits>6</recruits>
    </cost>
    <modes>3</modes>
    <level>0</level>
    <effect><![CDATA[Mode1:<br />Quarry: +1<br />Mode2:<br />Magic: +1<br />Mode3:<br />Dungeon: +1]]></effect>
    <code><![CDATA[
    if ($mode == 1) $mydata->Quarry+= 1;
    elseif ($mode == 2) $mydata->Magic+= 1;
    elseif ($mode == 3) $mydata->Dungeons+= 1;
]]></code>
    <created>2006-05-01</created>
    <modified>2009-04-11</modified>
  </card>
  <card id="268">
    <name>Reserve forces</name>
    <class>Uncommon</class>
    <cost>
      <bricks>17</bricks>
      <recruits>17</recruits>
    </cost>
    <modes>2</modes>
    <level>6</level>
    <effect><![CDATA[Mode1:<br />Attack: 34<br />Mode2:<br />Wall: +38]]></effect>
    <code><![CDATA[
    if ($mode == 1) $hisdata->attack(34);
    elseif ($mode == 2) $mydata->Wall+= 38;
]]></code>
    <created>2006-05-01</created>
    <modified>2010-12-24</modified>
  </card>
  <card id="269">
    <name>Militia</name>
    <class>Common</class>
    <modes>8</modes>
    <level>0</level>
    <effect><![CDATA[Wall: +1<br />Discard a card from hand]]></effect>
    <code><![CDATA[
    $mydata->Wall+= 1;
    if ($mode != $cardpos) {
      $this->setCard('my', $mode, $this->drawCard($my_deck, $mydata->Hand, $mode, 'drawCardRandom'));
    }
]]></code>
    <created>2006-05-01</created>
    <modified>2011-12-24</modified>
  </card>
  <card id="270">
    <name>Intrigue</name>
    <class>Uncommon</class>
    <cost>
      <bricks>6</bricks>
      <gems>6</gems>
      <recruits>6</recruits>
    </cost>
    <modes>8</modes>
    <level>0</level>
    <effect><![CDATA[Replace a card in opponent's hand with a common card from your deck]]></effect>
    <code><![CDATA[$this->setCard('his', $mode, $this->drawCard($my_deck->Common, $hisdata->Hand, $mode, 'drawCardList'));]]></code>
    <created>2006-05-01</created>
    <modified>2012-06-24</modified>
  </card>
  <card id="271">
    <name>Stone archer</name>
    <class>Common</class>
    <cost>
      <bricks>3</bricks>
    </cost>
    <level>0</level>
    <keywords>Unliving</keywords>
    <effect><![CDATA[Enemy tower: -2<br />Stock: +1]]></effect>
    <code><![CDATA[$hisdata->Tower-= 2; $mydata->addStock(1);]]></code>
    <created>2007-08-19</created>
    <modified>2007-11-25</modified>
  </card>
  <card id="272">
    <name>Elven archer</name>
    <class>Common</class>
    <cost>
      <recruits>5</recruits>
    </cost>
    <level>0</level>
    <keywords>Alliance,Far sight</keywords>
    <effect><![CDATA[If Wall > Enemy wall<br />Enemy tower: -7<br />else<br />Attack: 6]]></effect>
    <code><![CDATA[
    if ($mydata->Wall > $hisdata->Wall) $hisdata->Tower-= 7;
    else $hisdata->attack(6);
]]></code>
    <created>2007-08-19</created>
    <modified>2010-06-21</modified>
  </card>
  <card id="273">
    <name>Merchant</name>
    <class>Common</class>
    <cost>
      <bricks>1</bricks>
      <gems>1</gems>
      <recruits>1</recruits>
    </cost>
    <modes>3</modes>
    <level>4</level>
    <effect><![CDATA[Mode1:<br />Bricks: +6<br />Mode2:<br />Gems: +4<br />Mode3:<br />Recruits: +5]]></effect>
    <code><![CDATA[
    if ($mode == 1) $mydata->Bricks+= 6;
    elseif ($mode == 2) $mydata->Gems+= 4;
    elseif ($mode == 3) $mydata->Recruits+= 5;
]]></code>
    <created>2006-05-01</created>
    <modified>2010-07-22</modified>
  </card>
  <card id="274">
    <name>Hidden treasure</name>
    <class>Common</class>
    <level>0</level>
    <effect><![CDATA[Gems: +2<br />Recruits: +1<br />If last card played was a zero cost card<br />Gems: +1<br />Recruits: +1]]></effect>
    <code><![CDATA[
    if ($mylast_card->getResources() == 0 and $mylast_action == 'play' and $mylast_card->id() > 0) {
      $mydata->Gems+= 3; $mydata->Recruits+= 2;
    }
    else {
      $mydata->Gems+= 2; $mydata->Recruits+= 1;
    }
]]></code>
    <created>2006-05-01</created>
    <modified>2011-12-24</modified>
  </card>
  <card id="275">
    <name>Clay pit</name>
    <class>Common</class>
    <level>0</level>
    <effect><![CDATA[Bricks prod x2]]></effect>
    <code><![CDATA[$production->multiplyBricks(2);]]></code>
    <created>2006-05-01</created>
    <modified>2009-10-26</modified>
  </card>
  <card id="276">
    <name>Border fortress</name>
    <class>Uncommon</class>
    <cost>
      <bricks>45</bricks>
    </cost>
    <level>7</level>
    <effect><![CDATA[Tower: +25<br />Wall: +50]]></effect>
    <code><![CDATA[$mydata->Tower+= 25; $mydata->Wall+= 50;]]></code>
    <created>2006-05-01</created>
    <modified>2010-01-20</modified>
  </card>
  <card id="277">
    <name>King's elite guard</name>
    <class>Rare</class>
    <cost>
      <recruits>30</recruits>
    </cost>
    <level>0</level>
    <keywords>Soldier</keywords>
    <effect><![CDATA[Tower: +35]]></effect>
    <code><![CDATA[$mydata->Tower+= 35;]]></code>
    <created>2006-05-01</created>
    <modified>2009-10-26</modified>
  </card>
  <card id="278">
    <name>Guard tower</name>
    <class>Common</class>
    <cost>
      <bricks>5</bricks>
    </cost>
    <modes>2</modes>
    <level>1</level>
    <effect><![CDATA[Mode1:<br />Wall: +8<br />Mode2:<br />Tower: +5]]></effect>
    <code><![CDATA[if ($mode == 1) $mydata->Wall+= 8; elseif ($mode == 2) $mydata->Tower+= 5;]]></code>
    <created>2006-05-01</created>
    <modified>2007-11-25</modified>
  </card>
  <card id="279">
    <name>Heavy infantry</name>
    <class>Common</class>
    <cost>
      <recruits>5</recruits>
    </cost>
    <modes>2</modes>
    <level>3</level>
    <keywords>Soldier,Skirmisher</keywords>
    <effect><![CDATA[Mode1:<br />Attack: 7<br />Mode2:<br />Wall: +7]]></effect>
    <code><![CDATA[
    if ($mode == 1) $hisdata->attack(7);
    elseif ($mode == 2) $mydata->Wall+= 7;
]]></code>
    <created>2006-05-01</created>
    <modified>2012-06-24</modified>
  </card>
  <card id="280">
    <name>Avatar of vengeance</name>
    <class>Rare</class>
    <cost>
      <gems>16</gems>
    </cost>
    <modes>8</modes>
    <level>10</level>
    <keywords>Demonic,Rebirth</keywords>
    <effect><![CDATA[Move selected card from opponent's hand to matching position in hand]]></effect>
    <code><![CDATA[
    $this->setCard('my', $mode, $hisdata->Hand[$mode], ['reveal' => true]);
    $this->setCard('his', $mode, $this->drawCard($his_deck, $hisdata->Hand, $mode, 'drawCardDifferent'));
    if ($mode == $cardpos) $nextcard = 0;
]]></code>
    <created>2006-05-01</created>
    <modified>2015-09-26</modified>
  </card>
  <card id="281">
    <name>Berserker</name>
    <class>Common</class>
    <cost>
      <recruits>5</recruits>
    </cost>
    <level>5</level>
    <keywords>Barbarian,Frenzy</keywords>
    <effect><![CDATA[Attack: 13 - 5N<br />N = Tower / Max tower]]></effect>
    <code><![CDATA[$hisdata->attack(13 - round(5 * ($mydata->Tower / $max_tower)));]]></code>
    <created>2006-05-01</created>
    <modified>2012-12-24</modified>
  </card>
  <card id="282">
    <name>Luxury tax</name>
    <class>Uncommon</class>
    <level>10</level>
    <effect><![CDATA[Players lose N% of each resource<br />N is relative tower height]]></effect>
    <code><![CDATA[
    $my_ratio = $mydata->Tower / $max_tower;
    $mydata->Bricks-= round($mydata->Bricks * $my_ratio);
    $mydata->Gems-= round($mydata->Gems * $my_ratio);
    $mydata->Recruits-= round($mydata->Recruits * $my_ratio);
    $his_ratio = $hisdata->Tower / $max_tower;
    $hisdata->Bricks-= round($hisdata->Bricks * $his_ratio);
    $hisdata->Gems-= round($hisdata->Gems * $his_ratio);
    $hisdata->Recruits-= round($hisdata->Recruits * $his_ratio);
]]></code>
    <created>2006-05-01</created>
    <modified>2011-01-24</modified>
  </card>
  <card id="283">
    <name>Regulator</name>
    <class>Rare</class>
    <level>1</level>
    <effect><![CDATA[Tower and Wall of both players are set to the same height as was at the start of the game]]></effect>
    <code><![CDATA[
    $mydata->Tower= $init_tower; $mydata->Wall= $init_wall;
    $hisdata->Tower= $init_tower; $hisdata->Wall= $init_wall;
]]></code>
    <created>2006-05-01</created>
    <modified>2012-06-24</modified>
  </card>
  <card id="284">
    <name>Jealousy</name>
    <class>Uncommon</class>
    <cost>
      <gems>13</gems>
    </cost>
    <level>5</level>
    <effect><![CDATA[If Tower < 50 and Enemy tower > 60<br />Enemy tower: -25<br />else<br />Enemy tower: -10]]></effect>
    <code><![CDATA[
    if ($mydata->Tower < 50 and $hisdata->Tower > 60) $hisdata->Tower-= 25;
    else $hisdata->Tower-= 10;
]]></code>
    <created>2006-05-01</created>
    <modified>2007-11-25</modified>
  </card>
  <card id="285">
    <name>All-elemental attack</name>
    <class>Rare</class>
    <cost>
      <bricks>18</bricks>
      <gems>18</gems>
      <recruits>18</recruits>
    </cost>
    <level>7</level>
    <keywords>Destruction,Nature</keywords>
    <effect><![CDATA[Attack: #Stock<br />Stock: = 0]]></effect>
    <code><![CDATA[$hisdata->attack($mydata->Bricks + $mydata->Gems + $mydata->Recruits); $mydata->setStock(0);]]></code>
    <created>2006-05-01</created>
    <modified>2010-09-23</modified>
  </card>
  <card id="286">
    <name>Sabotage</name>
    <class>Uncommon</class>
    <cost>
      <recruits>25</recruits>
    </cost>
    <level>1</level>
    <effect><![CDATA[Enemy tower is halved]]></effect>
    <code><![CDATA[$hisdata->Tower-= round($hisdata->Tower / 2);]]></code>
    <created>2006-05-01</created>
    <modified>2010-12-24</modified>
  </card>
  <card id="287">
    <name>Revolt</name>
    <class>Uncommon</class>
    <level>9</level>
    <effect><![CDATA[Recruits: +12<br />Replace your hand with non-rare Recruits only no support keyword attack cards]]></effect>
    <code><![CDATA[
    $common = $this->getList(['class'=>'Common', 'cost'=>'Green', 'advanced'=>'Attack:', 'support'=>'No keywords']);
    $uncommon = $this->getList(['class'=>'Uncommon', 'cost'=>'Green', 'advanced'=>'Attack:', 'support'=>'No keywords']);
    $this->setHand('my', $this->drawHandList(array_merge($common, $uncommon)));
    $mydata->Recruits+= 12; $nextcard = 0;
]]></code>
    <created>2006-05-01</created>
    <modified>2013-01-01</modified>
  </card>
  <card id="288">
    <name>Cursed amulet</name>
    <class>Uncommon</class>
    <modes>8</modes>
    <level>10</level>
    <effect><![CDATA[Replace a card in opponent's hand with self<br />Raises opponent's stock based on replaced card rarity (C-1, U-2, R-5)]]></effect>
    <code><![CDATA[
    $rarities = ['Common' => 1, 'Uncommon' => 2, 'Rare' => 5];
    $rarity = $this->getCard($hisdata->Hand[$mode])->getClass();
    $hisdata->addStock($rarities[$rarity]);
    $this->setCard('his', $mode, $card->id(), ['reveal' => true]);
]]></code>
    <created>2006-05-01</created>
    <modified>2015-09-26</modified>
  </card>
  <card id="289">
    <name>Baron's keep</name>
    <class>Common</class>
    <cost>
      <bricks>10</bricks>
    </cost>
    <level>0</level>
    <keywords>Far sight</keywords>
    <effect><![CDATA[Tower: +3<br />Wall: +7]]></effect>
    <code><![CDATA[$mydata->Tower+= 3; $mydata->Wall+= 7;]]></code>
    <created>2006-05-01</created>
    <modified>2010-09-10</modified>
  </card>
  <card id="290">
    <name>Warlord's keep</name>
    <class>Uncommon</class>
    <cost>
      <bricks>30</bricks>
    </cost>
    <level>6</level>
    <keywords>Barbarian,Far sight</keywords>
    <effect><![CDATA[Tower: +15<br />Wall: +30]]></effect>
    <code><![CDATA[$mydata->Tower+= 15; $mydata->Wall+= 30;]]></code>
    <created>2006-05-01</created>
    <modified>2013-03-31</modified>
  </card>
  <card id="291">
    <name>General's army</name>
    <class>Rare</class>
    <cost>
      <recruits>20</recruits>
    </cost>
    <level>0</level>
    <effect><![CDATA[Recruits: +35<br />Replace your hand with 3 common and 5 uncommon <b>Soldier</b> cards]]></effect>
    <code><![CDATA[
    $mydata->Recruits+= 35;
    $trans = ['Common', 'Common', 'Common', 'Uncommon', 'Uncommon', 'Uncommon', 'Uncommon', 'Uncommon'];
    shuffle($trans);
    for ($i = 1; $i <= 8; $i++) {
      $this->setCard('my', $i, $this->drawCard($this->getList(['class'=>$trans[$i-1], 'keyword'=>'Soldier']), $mydata->Hand, $i, 'drawCardList'));
    }
    $nextcard = 0;
]]></code>
    <created>2006-05-01</created>
    <modified>2012-09-08</modified>
  </card>
  <card id="292">
    <name>Sacred forest</name>
    <class>Rare</class>
    <cost>
      <recruits>1</recruits>
    </cost>
    <level>6</level>
    <effect><![CDATA[Replace your hand with Princess of elves, Miriam and Elven: enchantress, ranger, priestesses, sorceress, warlock, market]]></effect>
    <code><![CDATA[$this->setHandShuffled('my', [687, 653, 655, 527, 190, 136, 526, 599]); $nextcard = 0;]]></code>
    <created>2006-05-01</created>
    <modified>2013-03-31</modified>
  </card>
  <card id="293">
    <name>Plague thrower</name>
    <class>Rare</class>
    <cost>
      <recruits>13</recruits>
    </cost>
    <level>0</level>
    <keywords>Durable</keywords>
    <effect><![CDATA[Recruits prod x0<br />Enemy stock: -1<br />Enemy tower: -12]]></effect>
    <code><![CDATA[$production->multiplyRecruits(0); $hisdata->addStock(-1); $hisdata->Tower-= 12;]]></code>
    <created>2006-05-01</created>
    <modified>2011-09-24</modified>
  </card>
  <card id="294">
    <name>Plan of salvation</name>
    <class>Rare</class>
    <level>9</level>
    <effect><![CDATA[Bricks: +25<br />Replace your hand with Bricks only Wall + no support keyword cards]]></effect>
    <code><![CDATA[
    $this->setHand('my', $this->drawHandList($this->getList(['cost'=>'Red', 'advanced'=>'Wall: +', 'support'=>'No keywords'])));
    $mydata->Bricks+= 25; $nextcard = 0;
]]></code>
    <created>2006-05-01</created>
    <modified>2011-01-01</modified>
  </card>
  <card id="295">
    <name>Architectural improvement</name>
    <class>Rare</class>
    <cost>
      <bricks>25</bricks>
    </cost>
    <level>4</level>
    <effect><![CDATA[Bricks: +40<br />Replace your hand with no keyword Bricks only Tower + no support keyword cards]]></effect>
    <code><![CDATA[
    $this->setHand('my', $this->drawHandList($this->getList(['keyword'=>'No keywords', 'cost'=>'Red', 'advanced'=>'Tower: +', 'support'=>'No keywords'])));
    $mydata->Bricks+= 40; $nextcard = 0;
]]></code>
    <created>2006-05-01</created>
    <modified>2009-10-26</modified>
  </card>
  <card id="296">
    <name>Hidden traps</name>
    <class>Uncommon</class>
    <cost>
      <bricks>5</bricks>
    </cost>
    <level>6</level>
    <keywords>Skirmisher</keywords>
    <effect><![CDATA[Wall: +14]]></effect>
    <code><![CDATA[$mydata->Wall+= 14;]]></code>
    <created>2006-05-01</created>
    <modified>2010-12-24</modified>
  </card>
  <card id="297">
    <name>Palisade</name>
    <class>Common</class>
    <level>1</level>
    <effect><![CDATA[Wall: +3]]></effect>
    <code><![CDATA[$mydata->Wall+= 3;]]></code>
    <created>2006-05-01</created>
    <modified>2011-12-24</modified>
  </card>
  <card id="298">
    <name>Vampire lord</name>
    <class>Rare</class>
    <cost>
      <gems>10</gems>
      <recruits>20</recruits>
    </cost>
    <modes>8</modes>
    <level>6</level>
    <keywords>Undead,Durable,Quick</keywords>
    <effect><![CDATA[Attack: 25<br />Magic: -1<br />Replace a card in hand with Vampire]]></effect>
    <code><![CDATA[
    $hisdata->attack(25);
    $mydata->Magic-= 1; $this->setCard('my', $mode, 28, ['reveal' => true]);
    if ($mode == $cardpos) $nextcard = 0;
]]></code>
    <created>2006-05-01</created>
    <modified>2015-09-26</modified>
  </card>
  <card id="299">
    <name>Angry mob</name>
    <class>Common</class>
    <level>6</level>
    <effect><![CDATA[Attack: #Facilities<br />Stock: -2]]></effect>
    <code><![CDATA[$hisdata->attack($mydata->Quarry + $mydata->Magic + $mydata->Dungeons); $mydata->addStock(-2);]]></code>
    <created>2006-05-01</created>
    <modified>2011-12-24</modified>
  </card>
  <card id="300">
    <name>Tremors</name>
    <class>Common</class>
    <cost>
      <gems>2</gems>
    </cost>
    <level>0</level>
    <keywords>Destruction</keywords>
    <effect><![CDATA[Enemy tower: -1<br />Enemy wall: -2<br />Enemy bricks: -4]]></effect>
    <code><![CDATA[$hisdata->Tower-= 1; $hisdata->Wall-= 2; $hisdata->Bricks-= 4;]]></code>
    <created>2006-05-01</created>
    <modified>2011-01-24</modified>
  </card>
  <card id="301">
    <name>Lookout towers</name>
    <class>Common</class>
    <cost>
      <bricks>8</bricks>
    </cost>
    <level>3</level>
    <keywords>Far sight</keywords>
    <effect><![CDATA[If Tower < Wall and Tower < 45<br />Tower: +12<br />else<br />Tower: +6]]></effect>
    <code><![CDATA[
    if ($mydata->Tower < $mydata->Wall and $mydata->Tower < 45) $mydata->Tower+= 12;
    else $mydata->Tower+= 6;
]]></code>
    <created>2007-08-19</created>
    <modified>2010-09-10</modified>
  </card>
  <card id="302">
    <name>Titan's left arm</name>
    <class>Common</class>
    <cost>
      <bricks>7</bricks>
    </cost>
    <level>10</level>
    <keywords>Titan,Unliving</keywords>
    <effect><![CDATA[Stock: +#<b>Unliving</b> in hand]]></effect>
    <code><![CDATA[
    $tmp = $this->keywordCount($mydata->Hand, 'Unliving');
    $mydata->Bricks+= $tmp; $mydata->Gems+= $tmp; $mydata->Recruits+= $tmp;
]]></code>
    <created>2007-08-19</created>
    <modified>2008-07-30</modified>
  </card>
  <card id="303">
    <name>Titan's right arm</name>
    <class>Common</class>
    <cost>
      <bricks>7</bricks>
    </cost>
    <level>10</level>
    <keywords>Titan,Unliving</keywords>
    <effect><![CDATA[Tower: +N<br />Wall: +N<br />N = #<b>Unliving</b> in hand]]></effect>
    <code><![CDATA[
    $tmp = $this->keywordCount($mydata->Hand, 'Unliving');
    $mydata->Tower+= $tmp; $mydata->Wall+= $tmp;
]]></code>
    <created>2007-08-19</created>
    <modified>2008-07-30</modified>
  </card>
  <card id="304">
    <name>Nightmare</name>
    <class>Uncommon</class>
    <cost>
      <gems>13</gems>
      <recruits>13</recruits>
    </cost>
    <level>2</level>
    <keywords>Burning,Charge (10)</keywords>
    <effect><![CDATA[Attack: 20]]></effect>
    <code><![CDATA[$hisdata->attack(20);]]></code>
    <created>2007-08-19</created>
    <modified>2009-11-12</modified>
  </card>
  <card id="305">
    <name>Crusader</name>
    <class>Uncommon</class>
    <cost>
      <recruits>13</recruits>
    </cost>
    <level>8</level>
    <keywords>Holy,Soldier</keywords>
    <effect><![CDATA[Attack: 12<br />If #<b>Soldier</b> in hand > 3<br />Dungeon: +1]]></effect>
    <code><![CDATA[
    $hisdata->attack(12);
    $tmp = $this->keywordCount($mydata->Hand, 'Soldier'); if ($tmp > 3) $mydata->Dungeons+= 1;
]]></code>
    <created>2007-08-19</created>
    <modified>2012-09-08</modified>
  </card>
  <card id="306">
    <name>Obsidian gargoyle</name>
    <class>Uncommon</class>
    <cost>
      <bricks>15</bricks>
    </cost>
    <level>9</level>
    <keywords>Unliving</keywords>
    <effect><![CDATA[Attack: 13<br />If #<b>Unliving</b> in hand > 4<br />Quarry: +1]]></effect>
    <code><![CDATA[
    $hisdata->attack(13);
    $tmp = $this->keywordCount($mydata->Hand, 'Unliving'); if ($tmp > 4) $mydata->Quarry+= 1;
]]></code>
    <created>2007-08-19</created>
    <modified>2011-12-24</modified>
  </card>
  <card id="307">
    <name>Necromancy amplifier</name>
    <class>Uncommon</class>
    <cost>
      <bricks>9</bricks>
      <gems>9</gems>
      <recruits>9</recruits>
    </cost>
    <level>10</level>
    <effect><![CDATA[Stock: +2<br />Replace non-rare <b>Undead</b> in hand with <b>Undead</b> cards of upgraded rarity]]></effect>
    <code><![CDATA[
    $mydata->addStock(2);
    $rarities = array();
    $upgrades = ['Common' => 'Uncommon', 'Uncommon' => 'Rare'];
    for ($i = 1; $i <= 8; $i++) {
      $cur_card = $this->getCard($mydata->Hand[$i]);
      if ($cur_card->hasKeyword('Undead')) {
        $rarities[$i] = $cur_card->getClass();
      }
    }
    foreach ($rarities as $i => $rarity) {
      if (in_array($rarity, ['Common', 'Uncommon'])) {
        $this->setCard('my', $i, $this->drawCard($this->getList(['class'=>$upgrades[$rarity], 'keyword'=>'Undead']), $mydata->Hand, $i, 'drawCardList'));
      }
    }
]]></code>
    <created>2007-08-19</created>
    <modified>2015-08-01</modified>
  </card>
  <card id="308">
    <name>Mud elemental</name>
    <class>Uncommon</class>
    <cost>
      <bricks>18</bricks>
    </cost>
    <level>10</level>
    <keywords>Unliving</keywords>
    <effect><![CDATA[Wall: +9N<br />N = #<b>Unliving</b> in hand (max 5)]]></effect>
    <code><![CDATA[$tmp = min(5, $this->keywordCount($mydata->Hand, 'Unliving')); $mydata->Wall+= 9 * $tmp;]]></code>
    <created>2007-08-19</created>
    <modified>2007-11-25</modified>
  </card>
  <card id="309">
    <name>Rock elemental</name>
    <class>Uncommon</class>
    <cost>
      <bricks>20</bricks>
    </cost>
    <level>10</level>
    <keywords>Unliving</keywords>
    <effect><![CDATA[Tower: +5N<br />N = #<b>Unliving</b> in hand (max 6)]]></effect>
    <code><![CDATA[$tmp = min(6, $this->keywordCount($mydata->Hand, 'Unliving')); $mydata->Tower+= 5 * $tmp;]]></code>
    <created>2007-08-19</created>
    <modified>2012-09-08</modified>
  </card>
  <card id="310">
    <name>Titan's head</name>
    <class>Uncommon</class>
    <cost>
      <bricks>8</bricks>
      <gems>8</gems>
    </cost>
    <level>10</level>
    <keywords>Titan,Unliving,Far sight</keywords>
    <effect><![CDATA[Tower: +8<br />If #<b>Unliving</b> in hand > 4<br />Magic: +1]]></effect>
    <code><![CDATA[
    $mydata->Tower+= 8;
    $tmp = $this->keywordCount($mydata->Hand, 'Unliving');
    if ($tmp > 4) $mydata->Magic+= 1;
]]></code>
    <created>2007-08-19</created>
    <modified>2013-10-19</modified>
  </card>
  <card id="311">
    <name>Titan's legs</name>
    <class>Uncommon</class>
    <cost>
      <bricks>12</bricks>
      <gems>12</gems>
      <recruits>12</recruits>
    </cost>
    <level>10</level>
    <keywords>Titan,Unliving</keywords>
    <effect><![CDATA[Tower: +11<br />Wall: +16<br />Stock: +2]]></effect>
    <code><![CDATA[
    $mydata->Tower+= 11; $mydata->Wall+= 16;
    $mydata->addStock(2);
]]></code>
    <created>2007-08-19</created>
    <modified>2008-07-30</modified>
  </card>
  <card id="312">
    <name>Titan's heart</name>
    <class>Uncommon</class>
    <cost>
      <bricks>7</bricks>
      <gems>7</gems>
      <recruits>7</recruits>
    </cost>
    <level>10</level>
    <keywords>Titan,Unliving</keywords>
    <effect><![CDATA[Tower: +6<br />Wall: +9<br />If #<b>Unliving</b> in hand > 4<br />Quarry: +1]]></effect>
    <code><![CDATA[
    $mydata->Tower+= 6; $mydata->Wall+= 9;
    $tmp = $this->keywordCount($mydata->Hand, 'Unliving');
    if ($tmp > 4) $mydata->Quarry+= 1;
]]></code>
    <created>2007-08-19</created>
    <modified>2008-07-30</modified>
  </card>
  <card id="313">
    <name>Tartarus gate</name>
    <class>Uncommon</class>
    <cost>
      <bricks>4</bricks>
      <gems>4</gems>
      <recruits>4</recruits>
    </cost>
    <level>8</level>
    <effect><![CDATA[Summons a non-common <b>Titan</b>]]></effect>
    <code><![CDATA[
    $uncommon = $this->getList(['class'=>'Uncommon', 'keyword'=>'Titan']);
    $rare = $this->getList(['class'=>'Rare', 'keyword'=>'Titan']);
    $nextcard = $this->drawCard(array_merge($uncommon, $rare), $mydata->Hand, $cardpos, 'drawCardList');
]]></code>
    <created>2007-08-19</created>
    <modified>2008-07-30</modified>
  </card>
  <card id="314">
    <name>Crugg the Destroyer</name>
    <class>Rare</class>
    <cost>
      <recruits>26</recruits>
    </cost>
    <level>8</level>
    <keywords>Barbarian,Siege</keywords>
    <effect><![CDATA[Enemy tower: -6N<br />Enemy wall: -9N<br />N = #<b>Barbarian</b> in hand]]></effect>
    <code><![CDATA[
    $tmp = $this->keywordCount($mydata->Hand, 'Barbarian');
    $hisdata->Tower-= 6 * $tmp; $hisdata->Wall-= 9 * $tmp;
]]></code>
    <created>2007-08-19</created>
    <modified>2011-04-24</modified>
  </card>
  <card id="315">
    <name>Completion ritual</name>
    <class>Rare</class>
    <cost>
      <gems>11</gems>
    </cost>
    <level>10</level>
    <keywords>Titan</keywords>
    <effect><![CDATA[If all <b>Titan</b> cards are present in hand<br />Instant destruction victory<br />else<br /><b>Titan</b> tokens: +60]]></effect>
    <code><![CDATA[
    if (in_array(302, $mydata->Hand) and in_array(303, $mydata->Hand) and in_array(310, $mydata->Hand) and in_array(311, $mydata->Hand) and in_array(312, $mydata->Hand)) {
      $hisdata->Tower= 0; $hisdata->Wall= 0;
    }
    else {
      $mydata->addToken('Titan', 60);
    }
]]></code>
    <created>2007-08-19</created>
    <modified>2012-12-24</modified>
  </card>
  <card id="316">
    <name>Lich</name>
    <class>Uncommon</class>
    <cost>
      <bricks>9</bricks>
      <gems>9</gems>
      <recruits>9</recruits>
    </cost>
    <modes>8</modes>
    <level>10</level>
    <keywords>Undead</keywords>
    <effect><![CDATA[Discard a card from opponent's hand<br />Summons <b>Undead</b> of the same rarity as discarded card]]></effect>
    <code><![CDATA[
    $rarity = $this->getCard($hisdata->Hand[$mode])->getClass();
    $this->setCard('his', $mode, $this->drawCard($his_deck, $hisdata->Hand, $mode, 'drawCardDifferent'));
    $nextcard = $this->drawCard($this->getList(['class'=>$rarity, 'keyword'=>'Undead']), $mydata->Hand, $cardpos, 'drawCardList');
]]></code>
    <created>2007-10-04</created>
    <modified>2012-09-08</modified>
  </card>
  <card id="317">
    <name>Heavy cavalry</name>
    <class>Uncommon</class>
    <cost>
      <recruits>25</recruits>
    </cost>
    <level>6</level>
    <keywords>Soldier,Charge (18)</keywords>
    <effect><![CDATA[Attack: 22]]></effect>
    <code><![CDATA[$hisdata->attack(22);]]></code>
    <created>2007-10-04</created>
    <modified>2009-04-11</modified>
  </card>
  <card id="318">
    <name>Fallen knight</name>
    <class>Uncommon</class>
    <cost>
      <recruits>14</recruits>
    </cost>
    <modes>8</modes>
    <level>9</level>
    <keywords>Undead,Enduring (6),Charge (7)</keywords>
    <effect><![CDATA[Attack: 10<br />Replace a card in hand with self]]></effect>
    <code><![CDATA[
    $hisdata->attack(10);
    if ($mode == $cardpos) $nextcard = 0;
    else $this->replaceCard('my', $mode, $card->id());
]]></code>
    <created>2007-10-04</created>
    <modified>2011-12-24</modified>
  </card>
  <card id="319">
    <name>Fire guardian</name>
    <class>Common</class>
    <cost>
      <gems>2</gems>
    </cost>
    <level>7</level>
    <keywords>Burning,Mage</keywords>
    <effect><![CDATA[Wall: +10<br />If last card played wasn't <b>Burning</b> or a <b>Mage</b><br />Gems: -4]]></effect>
    <code><![CDATA[
    $mydata->Wall+= 10;
    if (!(($mylast_card->hasKeyword('Burning') or $mylast_card->hasKeyword('Mage')) and ($mylast_action == 'play'))) {
      $mydata->Gems-= 4;
    }
]]></code>
    <created>2007-10-04</created>
    <modified>2013-03-31</modified>
  </card>
  <card id="320">
    <name>Last hope</name>
    <class>Uncommon</class>
    <level>0</level>
    <keywords>Quick</keywords>
    <effect><![CDATA[If Tower < 10 and Wall = 0<br />Tower:= 25<br />Wall:= 15<br />else<br />Stock: +1]]></effect>
    <code><![CDATA[
    if ($mydata->Tower < 10 and $mydata->Wall == 0) {
      $mydata->Tower= 25; $mydata->Wall= 15;
    }
    else {
      $mydata->addStock(1);
    }
]]></code>
    <created>2007-10-04</created>
    <modified>2011-12-24</modified>
  </card>
  <card id="321">
    <name>Unholy shrine</name>
    <class>Uncommon</class>
    <cost>
      <bricks>26</bricks>
    </cost>
    <modes>8</modes>
    <level>10</level>
    <keywords>Undead</keywords>
    <effect><![CDATA[Discard up to 5 <b>Undead</b> from hand except the selected card<br />Wall: +10N<br />N = #discarded cards]]></effect>
    <code><![CDATA[
    $storage = array();
    for ($i = 1; $i <= 8; $i++) {
      if ($this->getCard($mydata->Hand[$i])->hasKeyword('Undead') and $i != $mode and $i != $cardpos) {
        $storage[$i] = $i;
      }
    }
    shuffle($storage); $tmp = 0;
    for ($i = 0; ($i < count($storage) and $i < 5); $i++) {
      $this->setCard('my', $storage[$i], $this->drawCard($my_deck, $mydata->Hand, $storage[$i], 'drawCardRandom'));
      $tmp++;
    }
    $mydata->Wall+= 10 * $tmp;
]]></code>
    <created>2007-11-25</created>
    <modified>2011-12-24</modified>
  </card>
  <card id="322">
    <name>Siege breakers</name>
    <class>Uncommon</class>
    <cost>
      <recruits>20</recruits>
    </cost>
    <level>9</level>
    <keywords>Soldier,Siege</keywords>
    <effect><![CDATA[Attack: 8N<br />If N > 4<br />Wall: +15<br />N = #<b>Soldier</b> in hand (max 4)]]></effect>
    <code><![CDATA[
    $soldiers = $this->keywordCount($mydata->Hand, 'Soldier');
    $tmp = min(4, $soldiers);
    $hisdata->attack(8 * $tmp);
    if ($soldiers > 4) $mydata->Wall+= 15;
]]></code>
    <created>2007-10-04</created>
    <modified>2011-04-24</modified>
  </card>
  <card id="323">
    <name>Beastmaster</name>
    <class>Rare</class>
    <cost>
      <gems>10</gems>
      <recruits>15</recruits>
    </cost>
    <level>8</level>
    <keywords>Beast,Durable</keywords>
    <effect><![CDATA[Replace a non-<b>Beast</b> highest rarity card in opponent's hand with common <b>Beast</b><br />Attack: 5N<br />N = #<b>Beast</b> in game]]></effect>
    <code><![CDATA[
    $storage = ['Common' => array(), 'Uncommon' => array(), 'Rare' => array()];
    for ($i = 1; $i <= 8; $i++) {
      $cur_card = $this->getCard($hisdata->Hand[$i]);
      $rarity = $cur_card->getClass();
      if (!$cur_card->hasKeyword('Beast')) $storage[$rarity][] = $i;
    }
    if ((count($storage['Common']) + count($storage['Uncommon']) + count($storage['Rare'])) > 0) {
      shuffle($storage['Common']); shuffle($storage['Uncommon']); shuffle($storage['Rare']);
      $storage_temp = array_merge($storage['Common'], $storage['Uncommon'], $storage['Rare']);
      $discarded_pos = array_pop($storage_temp);
      $this->setCard('his', $discarded_pos, $this->drawCard($this->getList(['class'=>'Common', 'keyword'=>'Beast']), $hisdata->Hand, $discarded_pos, 'drawCardList'));
    }
    $tmp = $this->keywordCount($mydata->Hand, 'Beast') + $this->keywordCount($hisdata->Hand, 'Beast');
    $hisdata->attack(5 * $tmp);
]]></code>
    <created>2007-10-04</created>
    <modified>2012-04-07</modified>
  </card>
  <card id="324">
    <name>Wolf raiders</name>
    <class>Uncommon</class>
    <cost>
      <recruits>12</recruits>
    </cost>
    <modes>2</modes>
    <level>9</level>
    <keywords>Beast,Horde</keywords>
    <effect><![CDATA[Mode1:<br />Recruits: +3N<br />Mode2:<br />Attack: 3N<br />N = #<b>Beast</b> + #<b>Horde</b> in hand (max 7)]]></effect>
    <code><![CDATA[
    $tmp = $this->keywordCount($mydata->Hand, 'Beast') + $this->keywordCount($mydata->Hand, 'Horde');
    $tmp = min(7, $tmp);
    if ($mode == 1) $mydata->Recruits+= 3 * $tmp;
    elseif ($mode == 2) $hisdata->attack(3 * $tmp);
]]></code>
    <created>2007-10-04</created>
    <modified>2013-07-27</modified>
  </card>
  <card id="325">
    <name>Cleansing</name>
    <class>Common</class>
    <cost>
      <gems>5</gems>
    </cost>
    <level>9</level>
    <keywords>Holy</keywords>
    <effect><![CDATA[Replace up to N common non-<b>Holy</b> keyword cards in opponent's hand with common <b>Holy</b><br />N = #<b>Holy</b> in hand (max 4)]]></effect>
    <code><![CDATA[
    $count = min(4, $this->keywordCount($mydata->Hand, 'Holy'));
    $storage = array();
    for ($i = 1; $i <= 8; $i++) {
      $cur_card = $this->getCard($hisdata->Hand[$i]);
      if ($cur_card->hasKeyword('any') and !$cur_card->hasKeyword('Holy') and $cur_card->getClass() == 'Common') {
        $storage[] = $i;
      }
    }
    if (count($storage) > 0) {
      shuffle($storage);
      for ($i = 0; ($i < count($storage)) and ($i < $count); $i++) {
        $cur_pos = $storage[$i];
        $this->setCard('his', $cur_pos, $this->drawCard($this->getList(['class'=>'Common', 'keyword'=>'Holy']), $hisdata->Hand, $cur_pos, 'drawCardList'));
      }
    }
]]></code>
    <created>2007-11-25</created>
    <modified>2010-10-03</modified>
  </card>
  <card id="326">
    <name>Guardian angel</name>
    <class>Uncommon</class>
    <cost>
      <gems>16</gems>
      <recruits>12</recruits>
    </cost>
    <level>8</level>
    <keywords>Holy</keywords>
    <effect><![CDATA[Attack: 2N<br />Wall: +4N<br />N = #<b>Soldier</b> + #<b>Holy</b> in hand (max 8)]]></effect>
    <code><![CDATA[
    $tmp = $this->keywordCount($mydata->Hand, 'Soldier') + $this->keywordCount($mydata->Hand, 'Holy');
    $tmp = min(8 ,$tmp);
    $hisdata->attack(2 * $tmp); $mydata->Wall+= 4 * $tmp;
]]></code>
    <created>2007-11-25</created>
    <modified>2011-09-24</modified>
  </card>
  <card id="327">
    <name>Temple of light</name>
    <class>Common</class>
    <cost>
      <bricks>6</bricks>
    </cost>
    <modes>8</modes>
    <level>5</level>
    <keywords>Holy</keywords>
    <effect><![CDATA[Tower: +4<br />Replace a card in hand with <b>Holy</b>]]></effect>
    <code><![CDATA[
    $mydata->Tower+= 4;
    $this->setCard('my', $mode, $this->drawCard($this->getList(['keyword'=>'Holy']), $mydata->Hand, $mode, 'drawCardList'));
    if ($mode == $cardpos) $nextcard = 0;
]]></code>
    <created>2007-10-04</created>
    <modified>2012-12-24</modified>
  </card>
  <card id="328">
    <name>Tribes of east</name>
    <class>Common</class>
    <cost>
      <bricks>2</bricks>
      <gems>2</gems>
      <recruits>2</recruits>
    </cost>
    <level>9</level>
    <effect><![CDATA[Summons a <b>Barbarian</b><br />If <b>Barbarian</b> tokens are set<br />Stock: +3]]></effect>
    <code><![CDATA[
    $nextcard = $this->drawCard($this->getList(['keyword'=>'Barbarian']), $mydata->Hand, $cardpos, 'drawCardList');
    if ($mydata->findToken('Barbarian')) {
      $mydata->addStock(3);
    }
]]></code>
    <created>2007-10-04</created>
    <modified>2009-06-22</modified>
  </card>
  <card id="329">
    <name>Conjurer</name>
    <class>Common</class>
    <cost>
      <gems>1</gems>
    </cost>
    <modes>8</modes>
    <level>6</level>
    <keywords>Mage,Nature</keywords>
    <effect><![CDATA[Gems: +6<br />Wall: +3<br />Production x0<br />Replace a card in hand with self]]></effect>
    <code><![CDATA[
    $mydata->Gems+= 6; $mydata->Wall+= 3;
    $production->multiply(0);
    if ($mode == $cardpos) $nextcard = 0;
    else $this->replaceCard('my', $mode, $card->id());
]]></code>
    <created>2007-10-04</created>
    <modified>2011-12-24</modified>
  </card>
  <card id="330">
    <name>Emissary of the afterlife</name>
    <class>Uncommon</class>
    <cost>
      <bricks>16</bricks>
      <recruits>12</recruits>
    </cost>
    <level>10</level>
    <keywords>Undead</keywords>
    <effect><![CDATA[Attack: 14<br />Tower: +16<br />Gain N random resources<br />N = #<b>Undead</b> in your graveyard]]></effect>
    <code><![CDATA[
    $hisdata->attack(14);
    $mydata->Tower+= 16;
    $dis_cards = array();
    if (count($discarded_cards[0]) > 0) $dis_cards = array_merge($discarded_cards[0], $dis_cards);
    if (count($hisdata->DisCards[1]) > 0) $dis_cards = array_merge($hisdata->DisCards[1], $dis_cards);
    $undead = 0;
    for ($i = 0; $i < count($dis_cards); $i++) {
      if ($this->getCard($dis_cards[$i])->hasKeyword('Undead')) {
        $undead++;
      }
    }
    if ($undead > 0) {
      $mydata->addRandomResources($undead);
    }
]]></code>
    <created>2007-11-25</created>
    <modified>2015-09-26</modified>
  </card>
  <card id="331">
    <name>Benediction</name>
    <class>Common</class>
    <cost>
      <gems>1</gems>
    </cost>
    <level>8</level>
    <keywords>Holy,Restoration</keywords>
    <effect><![CDATA[Each player's stock raised by #<b>Holy</b> in his hand (max 4)]]></effect>
    <code><![CDATA[
    $mydata->addStock(min(4, $this->keywordCount($mydata->Hand, 'Holy')));
    $hisdata->addStock(min(4, $this->keywordCount($hisdata->Hand, 'Holy')));
]]></code>
    <created>2007-11-25</created>
    <modified>2009-04-11</modified>
  </card>
  <card id="332">
    <name>Retribution</name>
    <class>Common</class>
    <cost>
      <gems>2</gems>
    </cost>
    <level>10</level>
    <effect><![CDATA[Recruits prod x2<br />If Tower or Wall was damaged during opponent's last round<br />Enemy stock: -2]]></effect>
    <code><![CDATA[
    $production->multiplyRecruits(2);
    if ($mychanges['Tower'] < 0 or $mychanges['Wall'] < 0) {
      $hisdata->addStock(-2);
    }
]]></code>
    <created>2007-11-25</created>
    <modified>2010-12-24</modified>
  </card>
  <card id="333">
    <name>Death wave</name>
    <class>Common</class>
    <cost>
      <gems>7</gems>
    </cost>
    <level>9</level>
    <effect><![CDATA[Enemy wall: -4N<br />N = #<b>Undead</b> in hand (max 6) - #<b>Holy</b> in opponent's hand]]></effect>
    <code><![CDATA[
    $undead = $this->keywordCount($mydata->Hand, 'Undead');
    $holy = $this->keywordCount($hisdata->Hand, 'Holy');
    $hisdata->Wall-= max(min($undead, 6) - $holy, 0) * 4;
]]></code>
    <created>2007-11-25</created>
    <modified>2012-09-08</modified>
  </card>
  <card id="334">
    <name>Tarkhan</name>
    <class>Common</class>
    <cost>
      <recruits>7</recruits>
    </cost>
    <level>8</level>
    <keywords>Barbarian,Siege</keywords>
    <effect><![CDATA[If last card played was a <b>Barbarian</b><br />Enemy wall: -7<br />Always:<br />Attack: 7]]></effect>
    <code><![CDATA[
    if ($mylast_card->hasKeyword('Barbarian') and $mylast_action == 'play') $hisdata->Wall-= 7;
    $hisdata->attack(7);
]]></code>
    <created>2007-11-25</created>
    <modified>2011-04-24</modified>
  </card>
  <card id="335">
    <name>Flaming mirage</name>
    <class>Uncommon</class>
    <cost>
      <gems>11</gems>
      <recruits>11</recruits>
    </cost>
    <level>10</level>
    <keywords>Burning</keywords>
    <effect><![CDATA[Attack: 21<br />If last card was <b>Burning</b> up to 2 copies of that card will replace non-rare non-<b>Burning</b> cards in hand]]></effect>
    <code><![CDATA[
    $hisdata->attack(21);
    if ($mylast_card->hasKeyword('Burning')) {
      $storage = array();
      for ($i = 1; $i <= 8; $i++) {
        $cur_card = $this->getCard($mydata->Hand[$i]);
        if (!$cur_card->hasKeyword('Burning') and $cur_card->getClass() != 'Rare') {
          $storage[] = $i;
        }
      }
      $count = min(count($storage), 2);
      if ($count > 0) {
        shuffle($storage);
        for ($k = 0; $k < $count; $k++) {
          $i = $storage[$k];
          $this->setCard('my', $i, $mydata->LastCard[$mylastcardindex], ['reveal' => true]);
        }
      }
    }
]]></code>
    <created>2007-11-25</created>
    <modified>2015-09-26</modified>
  </card>
  <card id="336">
    <name>Eternal flame</name>
    <class>Common</class>
    <cost>
      <bricks>2</bricks>
      <gems>2</gems>
      <recruits>2</recruits>
    </cost>
    <level>10</level>
    <keywords>Burning</keywords>
    <effect><![CDATA[Summons <b>Burning</b><br />If last card played was <b>Burning</b> it will be that card]]></effect>
    <code><![CDATA[
    if ($mylast_card->hasKeyword('Burning') and $mylast_action == 'play') {
      $nextcard = $mydata->LastCard[$mylastcardindex];
    }
    else {
      $nextcard = $this->drawCard($this->getList(['keyword'=>'Burning']), $mydata->Hand, $cardpos, 'drawCardList');
    }
]]></code>
    <created>2007-11-25</created>
    <modified>2007-11-25</modified>
  </card>
  <card id="337">
    <name>Warlord</name>
    <class>Uncommon</class>
    <cost>
      <recruits>19</recruits>
    </cost>
    <level>9</level>
    <keywords>Barbarian</keywords>
    <effect><![CDATA[If last card played was a <b>Barbarian</b><br />Enemy wall: -17<br />Always:<br />Attack: 20]]></effect>
    <code><![CDATA[
    if ($mylast_card->hasKeyword('Barbarian') and $mylast_action == 'play') {
      $hisdata->Wall-= 17;
    }
    $hisdata->attack(20);
]]></code>
    <created>2007-11-25</created>
    <modified>2008-01-29</modified>
  </card>
  <card id="338">
    <name>Moonlight unicorn</name>
    <class>Uncommon</class>
    <cost>
      <gems>30</gems>
    </cost>
    <level>9</level>
    <keywords>Legend,Swift</keywords>
    <effect><![CDATA[Attack: 26<br />If last card played was a <b>Mage</b><br />Gems prod x4]]></effect>
    <code><![CDATA[
    if ($mylast_card->hasKeyword('Mage') and $mylast_action == 'play') {
      $production->multiplyGems(4);
    }
    $hisdata->attack(26);
]]></code>
    <created>2007-11-25</created>
    <modified>2009-12-24</modified>
  </card>
  <card id="339">
    <name>Prince of thieves</name>
    <class>Rare</class>
    <cost>
      <recruits>10</recruits>
    </cost>
    <level>5</level>
    <keywords>Brigand</keywords>
    <effect><![CDATA[If not New<br />Steals the difference between opponent's stock and stock (max 15, min 5)]]></effect>
    <code><![CDATA[
    if (!isset($mynewflags[$cardpos])) {
      $tmp = min(15, max(5, $hisdata->Bricks - $mydata->Bricks));
      $mydata->Bricks+= $tmp; $hisdata->Bricks-= $tmp;
      $tmp = min(15, max(5, $hisdata->Gems - $mydata->Gems));
      $mydata->Gems+= $tmp; $hisdata->Gems-= $tmp;
      $tmp = min(15, max(5, $hisdata->Recruits - $mydata->Recruits));
      $mydata->Recruits+= $tmp; $hisdata->Recruits-= $tmp;
    }
]]></code>
    <created>2007-11-25</created>
    <modified>2010-07-22</modified>
  </card>
  <card id="340">
    <name>Fanatic</name>
    <class>Common</class>
    <cost>
      <recruits>8</recruits>
    </cost>
    <level>3</level>
    <keywords>Soldier,Frenzy</keywords>
    <effect><![CDATA[Attack: 6<br />Recruits prod x2]]></effect>
    <code><![CDATA[$hisdata->attack(6); $production->multiplyRecruits(2);]]></code>
    <created>2008-02-12</created>
    <modified>2012-12-24</modified>
  </card>
  <card id="341">
    <name>Zealot</name>
    <class>Uncommon</class>
    <cost>
      <gems>11</gems>
      <recruits>15</recruits>
    </cost>
    <level>9</level>
    <keywords>Holy,Soldier</keywords>
    <effect><![CDATA[Attack: 10 + 3N<br />N = #<b>Soldier</b> + #<b>Holy</b> in hand (max 7)]]></effect>
    <code><![CDATA[
    $tmp = $this->keywordCount($mydata->Hand, 'Soldier') + $this->keywordCount($mydata->Hand, 'Holy');
    $hisdata->attack(10 + 3 * min(7, $tmp));
]]></code>
    <created>2008-02-12</created>
    <modified>2011-09-24</modified>
  </card>
  <card id="342">
    <name>Heresy</name>
    <class>Common</class>
    <level>10</level>
    <effect><![CDATA[Replace up to 3 non-<b>Frenzy</b> common cards in hand with Fanatics]]></effect>
    <code><![CDATA[
    $temp_array = array();
    for ($i = 1; $i <= 8; $i++) {
      $cur_card = $this->getCard($mydata->Hand[$i]);
      if (!$cur_card->hasKeyword('Frenzy') and $cur_card->getClass() == 'Common' and $i != $cardpos) {
        $temp_array[] = $i;
      }
    }
    if (count($temp_array) > 0) {
      shuffle($temp_array);
      for ($i = 0; $i < count($temp_array) and $i < 3; $i++) {
        $this->setCard('my', $temp_array[$i], 340, ['reveal' => true]);
      }
    }
]]></code>
    <created>2008-02-12</created>
    <modified>2015-09-26</modified>
  </card>
  <card id="343">
    <name>Death before dishonor</name>
    <class>Uncommon</class>
    <cost>
      <bricks>5</bricks>
      <gems>5</gems>
      <recruits>5</recruits>
    </cost>
    <level>9</level>
    <effect><![CDATA[Discard all non-rare <b>Barbarian</b> or <b>Soldier</b> from hand<br />Wall: +8N<br />N = #discarded cards (max 5)]]></effect>
    <code><![CDATA[
    $discarded = 0;
    for ($i = 1; $i <= 8; $i++) {
      $my_card = $this->getCard($mydata->Hand[$i]);
      if ($i != $cardpos and $my_card->getClass() != 'Rare' and ($my_card->hasKeyword('Barbarian') or $my_card->hasKeyword('Soldier'))) {
        $this->setCard('my', $i, $this->drawCard($my_deck, $mydata->Hand, $i, 'drawCardRandom'));
        $discarded++;
      }
    }
    $mydata->Wall+= min($discarded, 5) * 8;
]]></code>
    <created>2008-02-12</created>
    <modified>2012-04-07</modified>
  </card>
  <card id="344">
    <name>Warchief</name>
    <class>Uncommon</class>
    <cost>
      <recruits>15</recruits>
    </cost>
    <level>10</level>
    <keywords>Barbarian</keywords>
    <effect><![CDATA[Wall: +20<br />If last card played was a <b>Barbarian</b><br />Attack: 5 + N<br />N = recruits cost of last card played (max 15)]]></effect>
    <code><![CDATA[
    $mydata->Wall+= 20;
    if ($mylast_card->hasKeyword('Barbarian') and $mylast_action == 'play') {
      $hisdata->attack(5 + min(15, $mylast_card->getResources('Recruits')));
    }
]]></code>
    <created>2008-02-12</created>
    <modified>2015-08-01</modified>
  </card>
  <card id="345">
    <name>Devastator</name>
    <class>Uncommon</class>
    <cost>
      <recruits>46</recruits>
    </cost>
    <level>9</level>
    <keywords>Barbarian</keywords>
    <effect><![CDATA[Enemy wall: -10N<br />N = #<b>Barbarian</b> in hand<br />Attack: 40]]></effect>
    <code><![CDATA[
    $tmp = $this->keywordCount($mydata->Hand, 'Barbarian');
    $hisdata->Wall-= $tmp * 10;
    $hisdata->attack(40);
]]></code>
    <created>2008-02-12</created>
    <modified>2008-02-12</modified>
  </card>
  <card id="346">
    <name>Overpower</name>
    <class>Uncommon</class>
    <level>6</level>
    <effect><![CDATA[Summons a <b>Frenzy</b><br />Gems: -N<br />Recruits: +N<br />N = recruits cost of the summoned card (max 10)]]></effect>
    <code><![CDATA[
    $nextcard = $this->drawCard($this->getList(['keyword'=>'Frenzy']), $mydata->Hand, $cardpos, 'drawCardList');
    $cost = min(10, $this->getCard($nextcard)->getResources('Recruits'));
    $mydata->Gems-= $cost;
    $mydata->Recruits+= $cost;
]]></code>
    <created>2008-02-12</created>
    <modified>2013-03-31</modified>
  </card>
  <card id="347">
    <name>Call of the wilds</name>
    <class>Uncommon</class>
    <cost>
      <recruits>5</recruits>
    </cost>
    <level>10</level>
    <effect><![CDATA[Replace non-rare <b>Beast</b> in hand with <b>Beast</b> cards of upgraded rarity<br />Production x0]]></effect>
    <code><![CDATA[
    $production->multiply(0);
    $rarities = array();
    $upgrades = ['Common' => 'Uncommon', 'Uncommon' => 'Rare'];
    for ($i = 1; $i <= 8; $i++) {
      if ($this->getCard($mydata->Hand[$i])->hasKeyword('Beast')) {
        $rarities[$i] = $this->getCard($mydata->Hand[$i])->getClass();
      }
    }
    foreach ($rarities as $i => $val) {
      if (in_array($val, ['Common', 'Uncommon'])) {
        $this->setCard('my', $i, $this->drawCard($this->getList(['class'=>$upgrades[$val], 'keyword'=>'Beast']), $mydata->Hand, $i, 'drawCardList'));
      }
    }
]]></code>
    <created>2008-02-12</created>
    <modified>2015-08-01</modified>
  </card>
  <card id="348">
    <name>Time lock</name>
    <class>Uncommon</class>
    <cost>
      <gems>10</gems>
    </cost>
    <level>9</level>
    <keywords>Illusion</keywords>
    <effect><![CDATA[Enemy stock: -5<br />If opponent played <b>Swift</b> last round<br />Enemy stock: -7]]></effect>
    <code><![CDATA[
    $hisdata->addStock(-5);
    for ($i = 1; $i <= $hislastcardindex; $i++) {
      if ($this->getCard($hisdata->LastCard[$i])->hasKeyword('Swift') and $hisdata->LastAction[$i] == 'play') {
        $hisdata->addStock(-7); break;
      }
    }
]]></code>
    <created>2008-02-12</created>
    <modified>2010-09-23</modified>
  </card>
  <card id="349">
    <name>Reuse the rubble</name>
    <class>Common</class>
    <level>10</level>
    <effect><![CDATA[If last card was <b>Unliving</b><br />Tower: +N / 3<br />Wall: +N / 2<br />N = bricks cost of last card (max 40)]]></effect>
    <code><![CDATA[
    if ($mylast_card->hasKeyword('Unliving')) {
      $tmp = min(40, $mylast_card->getResources('Bricks'));
      $mydata->Tower+= round($tmp / 3); $mydata->Wall+= round($tmp / 2);
    }
]]></code>
    <created>2008-02-12</created>
    <modified>2013-12-24</modified>
  </card>
  <card id="350">
    <name>Eternal guardian</name>
    <class>Uncommon</class>
    <cost>
      <bricks>1</bricks>
      <gems>1</gems>
      <recruits>1</recruits>
    </cost>
    <level>10</level>
    <keywords>Undead,Durable</keywords>
    <effect><![CDATA[If last card played was <b>Undead</b><br />Tower: +N / 3<br />Wall: +N / 2<br />N = cost of last card played]]></effect>
    <code><![CDATA[
    if ($mylast_card->hasKeyword('Undead') and $mylast_action == 'play') {
      $tmp = $mylast_card->getResources();
      $mydata->Tower+= round($tmp / 3); $mydata->Wall+= round($tmp / 2);
    }
]]></code>
    <created>2008-02-12</created>
    <modified>2012-09-08</modified>
  </card>
  <card id="351">
    <name>Golden scepter</name>
    <class>Common</class>
    <cost>
      <bricks>1</bricks>
      <gems>1</gems>
      <recruits>1</recruits>
    </cost>
    <level>9</level>
    <effect><![CDATA[Summons<br />If New<br />Scepter of summoning<br />else<br />Golden scepter]]></effect>
    <code><![CDATA[
    $this->setCard('my', $cardpos, (isset($mynewflags[$cardpos])) ? 159 : 351, ['reveal' => true]);
    $nextcard = 0;
]]></code>
    <created>2008-02-12</created>
    <modified>2015-09-26</modified>
  </card>
  <card id="352">
    <name>Azure unicorn</name>
    <class>Uncommon</class>
    <cost>
      <gems>12</gems>
      <recruits>15</recruits>
    </cost>
    <level>7</level>
    <keywords>Legend</keywords>
    <effect><![CDATA[Attack: 15<br />If Magic > Enemy magic<br />Attack: 19]]></effect>
    <code><![CDATA[
    if ($mydata->Magic > $hisdata->Magic) $hisdata->attack(34);
    else $hisdata->attack(15);
]]></code>
    <created>2008-02-12</created>
    <modified>2008-07-30</modified>
  </card>
  <card id="353">
    <name>Glacial temple</name>
    <class>Uncommon</class>
    <modes>2</modes>
    <level>3</level>
    <effect><![CDATA[Magic: -1<br />Mode1:<br />Quarry: +1<br />Mode2:<br />Dungeon: +1]]></effect>
    <code><![CDATA[
    $mydata->Magic-= 1;
    if ($mode == 1) $mydata->Quarry+= 1;
    elseif ($mode == 2) $mydata->Dungeons+= 1;
]]></code>
    <created>2008-02-12</created>
    <modified>2008-07-30</modified>
  </card>
  <card id="354">
    <name>Sorcerer's outpost</name>
    <class>Uncommon</class>
    <cost>
      <bricks>10</bricks>
      <gems>10</gems>
    </cost>
    <level>7</level>
    <effect><![CDATA[Tower: +9<br />Wall: +15<br />If #<b>Legend</b> in hand > 0<br />Magic: +1]]></effect>
    <code><![CDATA[
    $mydata->Tower+= 9; $mydata->Wall+= 15;
    if ($this->keywordCount($mydata->Hand, 'Legend') > 0) $mydata->Magic+= 1;
]]></code>
    <created>2008-02-12</created>
    <modified>2008-07-30</modified>
  </card>
  <card id="355">
    <name>Witcher</name>
    <class>Rare</class>
    <cost>
      <recruits>10</recruits>
    </cost>
    <level>10</level>
    <effect><![CDATA[Players discard all keyword cards<br />Players suffer 7 damage for each card they discarded]]></effect>
    <code><![CDATA[
    $j = 0;
    for ($i = 1; $i <= 8; $i++) {
      if ($this->getCard($mydata->Hand[$i])->hasKeyword('any') and $i != $cardpos) {
        $this->setCard('my', $i, $this->drawCard($my_deck, $mydata->Hand, $i, 'drawCardRandom'));
        $j++;
      }
    }
    $mydata->attack($j * 7);
    $j = 0;
    for ($i = 1; $i <= 8; $i++) {
      if ($this->getCard($hisdata->Hand[$i])->hasKeyword('any')) {
        $this->setCard('his', $i, $this->drawCard($his_deck, $hisdata->Hand, $i, 'drawCardRandom'));
        $j++;
      }
    }
    $hisdata->attack($j * 7);
]]></code>
    <created>2008-02-12</created>
    <modified>2008-02-12</modified>
  </card>
  <card id="356">
    <name>Abyssal viper</name>
    <class>Common</class>
    <cost>
      <recruits>1</recruits>
    </cost>
    <modes>8</modes>
    <level>4</level>
    <keywords>Beast</keywords>
    <effect><![CDATA[If targeting self, gain recruits cost of the matching card (max 10), else replace a card in hand with self]]></effect>
    <code><![CDATA[
    if ($mode == $cardpos) {
      $mydata->Recruits+= min($this->getCard($hisdata->Hand[$cardpos])->getResources('Recruits'), 10);
    }
    else {
      $this->replaceCard('my', $mode, $card->id());
    }
]]></code>
    <created>2008-02-12</created>
    <modified>2011-12-24</modified>
  </card>
  <card id="357">
    <name>Warlock</name>
    <class>Common</class>
    <cost>
      <gems>6</gems>
      <recruits>6</recruits>
    </cost>
    <modes>2</modes>
    <level>8</level>
    <keywords>Mage,Undead</keywords>
    <effect><![CDATA[Tower: +2<br />Wall: +5<br />Mode1:<br />Gems: +6<br />Mode2:<br />Recruits: +6]]></effect>
    <code><![CDATA[
    $mydata->Tower+= 2;
    $mydata->Wall+= 5;
    if ($mode == 1) $mydata->Gems+=6; elseif ($mode == 2) $mydata->Recruits+= 6;
]]></code>
    <created>2008-02-12</created>
    <modified>2015-09-26</modified>
  </card>
  <card id="358">
    <name>Sandworm</name>
    <class>Uncommon</class>
    <cost>
      <bricks>18</bricks>
      <recruits>18</recruits>
    </cost>
    <level>3</level>
    <keywords>Siege</keywords>
    <effect><![CDATA[Enemy tower: -16<br />Enemy wall: -20]]></effect>
    <code><![CDATA[$hisdata->Tower-= 16; $hisdata->Wall-= 20;]]></code>
    <created>2008-02-12</created>
    <modified>2011-04-24</modified>
  </card>
  <card id="359">
    <name>Determined defense</name>
    <class>Common</class>
    <cost>
      <bricks>8</bricks>
      <recruits>2</recruits>
    </cost>
    <level>0</level>
    <effect><![CDATA[Wall: +10<br />If #<b>Charge</b> in opponent's hand > 0 or #<b>Enduring</b> in hand > 0<br />Wall: +8]]></effect>
    <code><![CDATA[
    $tmp = $this->keywordCount($mydata->Hand, 'Enduring') + $this->keywordCount($hisdata->Hand, 'Charge');
    $mydata->Wall+= ($tmp > 0) ? 18 : 10;
]]></code>
    <created>2008-02-12</created>
    <modified>2010-10-11</modified>
  </card>
  <card id="360">
    <name>Wildfire gem</name>
    <class>Common</class>
    <cost>
      <gems>1</gems>
    </cost>
    <level>3</level>
    <keywords>Flare attack</keywords>
    <effect><![CDATA[Stock: -3]]></effect>
    <code><![CDATA[$mydata->addStock(-3);]]></code>
    <created>2008-07-30</created>
    <modified>2009-06-22</modified>
  </card>
  <card id="361">
    <name>Devilkin</name>
    <class>Common</class>
    <cost>
      <gems>6</gems>
    </cost>
    <level>6</level>
    <keywords>Burning,Aria</keywords>
    <effect><![CDATA[Attack: 5<br />If last card played was <b>Burning</b> or a <b>Mage</b><br />Enemy stock: -3]]></effect>
    <code><![CDATA[
    $hisdata->attack(5);
    if (($mylast_card->hasKeyword('Burning') or $mylast_card->hasKeyword('Mage')) and $mylast_action == 'play') {
      $hisdata->addStock(-3);
    }
]]></code>
    <created>2008-07-30</created>
    <modified>2012-06-24</modified>
  </card>
  <card id="362">
    <name>Petrified minotaur</name>
    <class>Common</class>
    <cost>
      <bricks>7</bricks>
      <recruits>5</recruits>
    </cost>
    <level>0</level>
    <keywords>Beast,Unliving</keywords>
    <effect><![CDATA[Wall: +5<br />Enemy wall: -5<br />Attack: 5]]></effect>
    <code><![CDATA[
    $mydata->Wall+= 5; $hisdata->Wall-= 5;
    $hisdata->attack(5);
]]></code>
    <created>2008-07-30</created>
    <modified>2008-07-30</modified>
  </card>
  <card id="363">
    <name>Supply units</name>
    <class>Common</class>
    <cost>
      <recruits>1</recruits>
    </cost>
    <level>10</level>
    <effect><![CDATA[Discard lowest recruits cost lowest rarity <b>Barbarian</b> or <b>Soldier</b> from hand to gain<br />Stock: +3]]></effect>
    <code><![CDATA[
    $min = 1000;
    $storage = $min_array = ['Common' => array(), 'Uncommon' => array(), 'Rare' => array()];
    for ($i = 1; $i <= 8; $i++) {
      $cur_card = $this->getCard($mydata->Hand[$i]);
      $rarity = $cur_card->getClass();
      if ($i != $cardpos and ($cur_card->hasKeyword('Barbarian') or $cur_card->hasKeyword('Soldier'))) {
        $recruits_cost = $cur_card->getResources('Recruits');
        $storage[$rarity][$i] = $recruits_cost;
        $min = min($recruits_cost, $min);
      }
    }
    if ((count($storage['Common']) + count($storage['Uncommon']) + count($storage['Rare'])) > 0) {
      foreach ($storage as $rarity => $rarity_cards) {
        foreach ($rarity_cards as $c_pos => $c_cost) {
          if ($c_cost == $min) {
            $min_array[$rarity][] = $c_pos;
          }
        }
      }

      shuffle($min_array['Common']); shuffle($min_array['Uncommon']); shuffle($min_array['Rare']);
      $min_array = array_merge($min_array['Common'], $min_array['Uncommon'], $min_array['Rare']);
      $discarded_pos = array_shift($min_array);
      $this->setCard('my', $discarded_pos, $this->drawCard($my_deck, $mydata->Hand, $discarded_pos, 'drawCardRandom'));
      $mydata->addStock(3);
    }
]]></code>
    <created>2008-07-30</created>
    <modified>2012-06-24</modified>
  </card>
  <card id="364">
    <name>Judge</name>
    <class>Common</class>
    <level>10</level>
    <effect><![CDATA[If opponent lowered your stock last round he loses twice the amount of lost stock (max 8)<br />No effect on Judge]]></effect>
    <code><![CDATA[
    if (($mychanges['Bricks'] < 0 or $mychanges['Gems'] < 0 or $mychanges['Recruits'] < 0) and $hislast_card->id() != 364) {
      $hisdata->Bricks+= min(0, max(-8, 2 * $mychanges['Bricks']));
      $hisdata->Gems+= min(0, max(-8, 2 * $mychanges['Gems']));
      $hisdata->Recruits+= min(0, max(-8, 2 * $mychanges['Recruits']));
    }
]]></code>
    <created>2008-07-30</created>
    <modified>2010-11-01</modified>
  </card>
  <card id="365">
    <name>Infiltrator</name>
    <class>Common</class>
    <cost>
      <recruits>6</recruits>
    </cost>
    <modes>2</modes>
    <level>5</level>
    <keywords>Brigand</keywords>
    <effect><![CDATA[Mode1:<br />Enemy tower: -5<br />Mode2:<br />Recruits: +4<br />Enemy recruits: -6]]></effect>
    <code><![CDATA[
    if ($mode == 1) $hisdata->Tower-= 5;
    elseif ($mode == 2) {
      $mydata->Recruits+= 4;
      $hisdata->Recruits-= 6;
    }
]]></code>
    <created>2008-07-30</created>
    <modified>2011-12-24</modified>
  </card>
  <card id="366">
    <name>Graceful charity</name>
    <class>Common</class>
    <level>10</level>
    <keywords>Holy</keywords>
    <effect><![CDATA[If opponent lowered your stock last round you regain lost stock (max 6)]]></effect>
    <code><![CDATA[
    if ($mychanges['Bricks'] < 0 or $mychanges['Gems'] < 0 or $mychanges['Recruits'] < 0) {
      $mydata->Bricks-= min(0, max(-6, $mychanges['Bricks']));
      $mydata->Gems-= min(0, max(-6, $mychanges['Gems']));
      $mydata->Recruits-= min(0, max(-6, $mychanges['Recruits']));
    }
]]></code>
    <created>2008-07-30</created>
    <modified>2010-11-01</modified>
  </card>
  <card id="367">
    <name>Light infantry</name>
    <class>Common</class>
    <cost>
      <recruits>5</recruits>
    </cost>
    <level>5</level>
    <keywords>Soldier</keywords>
    <effect><![CDATA[If #<b>Charge</b> in opponent's hand > 0<br />Attack: 4<br />else<br />Attack: 10]]></effect>
    <code><![CDATA[$hisdata->attack((($this->keywordCount($hisdata->Hand, 'Charge') > 0) ? 4 : 10));]]></code>
    <created>2008-07-30</created>
    <modified>2008-12-24</modified>
  </card>
  <card id="368">
    <name>Goblin saboteur</name>
    <class>Common</class>
    <cost>
      <recruits>5</recruits>
    </cost>
    <level>7</level>
    <keywords>Horde</keywords>
    <effect><![CDATA[Attack: 4<br />If opponent raised his wall by more than 8 last round<br />Enemy wall: -12]]></effect>
    <code><![CDATA[
    $hisdata->attack(4);
    if ($hischanges['Wall'] > 8) $hisdata->Wall-= 12;
]]></code>
    <created>2008-07-30</created>
    <modified>2012-09-08</modified>
  </card>
  <card id="369">
    <name>Keeper of souls</name>
    <class>Uncommon</class>
    <cost>
      <gems>16</gems>
      <recruits>10</recruits>
    </cost>
    <level>9</level>
    <keywords>Beast,Burning</keywords>
    <effect><![CDATA[Attack: 13 + 2N<br />Recruits: + N<br />N = #<b>Burning</b> + #<b>Beast</b> in game]]></effect>
    <code><![CDATA[
    $tmp = $this->keywordCount($mydata->Hand, 'Beast') + $this->keywordCount($mydata->Hand, 'Burning') + $this->keywordCount($hisdata->Hand, 'Beast') + $this->keywordCount($hisdata->Hand, 'Burning');
    $hisdata->attack(13 + 2 * $tmp);
    $mydata->Recruits+= $tmp;
]]></code>
    <created>2008-07-30</created>
    <modified>2008-07-30</modified>
  </card>
  <card id="370">
    <name>Dragon patrol</name>
    <class>Uncommon</class>
    <cost>
      <gems>16</gems>
      <recruits>16</recruits>
    </cost>
    <level>9</level>
    <keywords>Dragon,Soldier</keywords>
    <effect><![CDATA[Attack: 35<br />If #<b>Dragon</b> in hand > 1<br />Gems prod x2]]></effect>
    <code><![CDATA[
    $hisdata->attack(35);
    if ($this->keywordCount($mydata->Hand, 'Dragon') > 1) $production->multiplyGems(2);
]]></code>
    <created>2008-07-30</created>
    <modified>2012-06-24</modified>
  </card>
  <card id="371">
    <name>Frost unicorn</name>
    <class>Uncommon</class>
    <cost>
      <gems>32</gems>
    </cost>
    <level>10</level>
    <keywords>Legend</keywords>
    <effect><![CDATA[Attack: 35<br />If #<b>Legend</b> in hand > 1 and #<b>Mage</b> in hand > 0<br />Gems: +20<br />Magic: +1]]></effect>
    <code><![CDATA[
    $hisdata->attack(35);
    if ($this->keywordCount($mydata->Hand, 'Legend') > 1 and $this->keywordCount($mydata->Hand, 'Mage') > 0) {
      $mydata->Magic+= 1; $mydata->Gems+= 20;
    }
]]></code>
    <created>2008-07-30</created>
    <modified>2008-07-30</modified>
  </card>
  <card id="372">
    <name>Corpses behemoth</name>
    <class>Uncommon</class>
    <cost>
      <gems>22</gems>
      <recruits>22</recruits>
    </cost>
    <modes>8</modes>
    <level>10</level>
    <keywords>Undead</keywords>
    <effect><![CDATA[Discard all <b>Undead</b> from hand except the selected card<br />Attack: 9N<br />N = #discarded cards]]></effect>
    <code><![CDATA[
    $tmp = 0;
    for ($i = 1; $i <= 8; $i++) {
      if ($this->getCard($mydata->Hand[$i])->hasKeyword('Undead') and $i != $mode and $i != $cardpos) {
        $this->setCard('my', $i, $this->drawCard($my_deck, $mydata->Hand, $i, 'drawCardRandom'));
        $tmp++;
      }
    }
    $hisdata->attack(9 * $tmp);
]]></code>
    <created>2008-07-30</created>
    <modified>2008-07-30</modified>
  </card>
  <card id="373">
    <name>Sphinx</name>
    <class>Uncommon</class>
    <cost>
      <bricks>16</bricks>
      <gems>12</gems>
    </cost>
    <modes>8</modes>
    <level>10</level>
    <keywords>Unliving</keywords>
    <effect><![CDATA[Discard a card from opponent's hand<br />If #<b>Unliving</b> in hand > 3<br />Gain half cost of the discarded card (max 20)]]></effect>
    <code><![CDATA[
    $tmp = $this->keywordCount($mydata->Hand, 'Unliving');
    if ($tmp > 3) {
      $mydata->Bricks+= min(round($this->getCard($hisdata->Hand[$mode])->getResources('Bricks') / 2),20);
      $mydata->Gems+= min(round($this->getCard($hisdata->Hand[$mode])->getResources('Gems') / 2),20);
      $mydata->Recruits+= min(round($this->getCard($hisdata->Hand[$mode])->getResources('Recruits') / 2),20);
    }
    $this->setCard('his', $mode, $this->drawCard($his_deck, $hisdata->Hand, $mode, 'drawCardDifferent'));
]]></code>
    <created>2008-07-30</created>
    <modified>2008-07-30</modified>
  </card>
  <card id="374">
    <name>Chain lightning</name>
    <class>Uncommon</class>
    <cost>
      <gems>16</gems>
    </cost>
    <level>9</level>
    <keywords>Destruction,Nature</keywords>
    <effect><![CDATA[Enemy tower: -11<br />If last card played was a <b>Mage</b><br />Enemy stock: -5]]></effect>
    <code><![CDATA[
    $hisdata->Tower-= 11;
    if ($mylast_card->hasKeyword('Mage') and $mylast_action == 'play') {
      $hisdata->addStock(-5);
    }
]]></code>
    <created>2008-07-30</created>
    <modified>2008-07-30</modified>
  </card>
  <card id="375">
    <name>Stilshrine of Miriam</name>
    <class>Uncommon</class>
    <cost>
      <bricks>13</bricks>
      <gems>12</gems>
    </cost>
    <level>5</level>
    <keywords>Alliance</keywords>
    <effect><![CDATA[Tower: +7<br />Wall: +11<br />Production x3]]></effect>
    <code><![CDATA[$mydata->Tower+= 7; $mydata->Wall+= 11; $production->multiply(3);]]></code>
    <created>2008-07-30</created>
    <modified>2009-04-11</modified>
  </card>
  <card id="376">
    <name>Imperial griffin</name>
    <class>Uncommon</class>
    <cost>
      <recruits>30</recruits>
    </cost>
    <level>8</level>
    <keywords>Beast,Soldier</keywords>
    <effect><![CDATA[Attack: 30<br />If #<b>Beast</b> in hand > 1<br />Recruits: +12]]></effect>
    <code><![CDATA[
    $hisdata->attack(30);
    if ($this->keywordCount($mydata->Hand, 'Beast') > 1) $mydata->Recruits+= 12;
]]></code>
    <created>2008-07-30</created>
    <modified>2012-06-24</modified>
  </card>
  <card id="377">
    <name>Mountain king</name>
    <class>Rare</class>
    <cost>
      <gems>14</gems>
      <recruits>16</recruits>
    </cost>
    <level>6</level>
    <keywords>Runic,Durable</keywords>
    <effect><![CDATA[Attack: 24<br />Negates the negative effect of opponent's last round on tower and wall]]></effect>
    <code><![CDATA[
    $hisdata->attack(24);
    $mydata->Tower-= min(0, $mychanges['Tower']); $mydata->Wall-= min(0, $mychanges['Wall']);
]]></code>
    <created>2008-07-30</created>
    <modified>2011-04-24</modified>
  </card>
  <card id="378">
    <name>Ice revenant</name>
    <class>Rare</class>
    <cost>
      <gems>28</gems>
      <recruits>28</recruits>
    </cost>
    <level>7</level>
    <keywords>Undead</keywords>
    <effect><![CDATA[Attack: 60<br />If last card played was summoning or replacing <b>Undead</b> support card<br />Attack: 45]]></effect>
    <code><![CDATA[
    $bonus = false;
    $target_cards = array_merge($this->getList(['advanced'=>"Summons", 'support'=>'Undead']), $this->getList(['advanced'=>'Replace ', 'support'=>'Undead']));
    if (in_array($mydata->LastCard[$mylastcardindex], $target_cards) and $mylast_action == 'play') {
      $bonus = true;
    }
    $hisdata->attack(60 + (($bonus) ? 45 : 0));
]]></code>
    <created>2008-07-30</created>
    <modified>2012-09-08</modified>
  </card>
  <card id="379">
    <name>Castle beyond looking glass</name>
    <class>Rare</class>
    <cost>
      <bricks>20</bricks>
      <gems>20</gems>
      <recruits>20</recruits>
    </cost>
    <level>2</level>
    <effect><![CDATA[Tower: = Max tower / 2<br />Wall: = Max wall / 2<br />Stock: +5]]></effect>
    <code><![CDATA[
    $mydata->Tower = round($max_tower / 2); $mydata->Wall = round($max_wall / 2);
    $mydata->addStock(5);
]]></code>
    <created>2008-07-30</created>
    <modified>2010-09-10</modified>
  </card>
  <card id="380">
    <name>Order of the White Lotus</name>
    <class>Rare</class>
    <level>10</level>
    <effect><![CDATA[If not New<br />Balances (average) both players' tower, wall, facilities and stock]]></effect>
    <code><![CDATA[
    if (!isset($mynewflags[$cardpos])) {
      $temp_array = ['Tower', 'Wall', 'Quarry', 'Magic', 'Dungeons', 'Bricks', 'Gems', 'Recruits'];
      foreach ($temp_array as $attribute) {
        $mydata->$attribute = $hisdata->$attribute = round(($mydata->$attribute + $hisdata->$attribute) / 2);
      }
    }
]]></code>
    <created>2008-07-30</created>
    <modified>2009-04-11</modified>
  </card>
  <card id="381">
    <name>Purified ashes</name>
    <class>Common</class>
    <level>4</level>
    <effect><![CDATA[Gain 1 random resource]]></effect>
    <code><![CDATA[$mydata->addRandomResources(1);]]></code>
    <created>2008-12-24</created>
    <modified>2011-09-24</modified>
  </card>
  <card id="382">
    <name>Priest</name>
    <class>Common</class>
    <cost>
      <gems>1</gems>
    </cost>
    <level>7</level>
    <keywords>Holy,Banish</keywords>
    <effect><![CDATA[If #<b>Holy</b> in hand > 1<br />Gems: +3<br />If #<b>Soldier</b> in hand > 1<br />Recruits: +3]]></effect>
    <code><![CDATA[
      if ($this->keywordCount($mydata->Hand, 'Holy') > 1) $mydata->Gems+= 3;
      if ($this->keywordCount($mydata->Hand, 'Soldier') > 1) $mydata->Recruits+= 3;
]]></code>
    <created>2008-12-24</created>
    <modified>2010-11-01</modified>
  </card>
  <card id="383">
    <name>Mountain of faith</name>
    <class>Rare</class>
    <cost>
      <bricks>12</bricks>
      <gems>12</gems>
      <recruits>12</recruits>
    </cost>
    <level>5</level>
    <effect><![CDATA[Replace your hand with Temple guard, Fairy, Heavenly warrior, Paladin, Cathedral, Knight Templar, Seraphim and Angel]]></effect>
    <code><![CDATA[$this->setHandShuffled('my', [503, 27, 85, 90, 175, 473, 137, 44]); $nextcard = 0;]]></code>
    <created>2008-12-24</created>
    <modified>2010-07-22</modified>
  </card>
  <card id="384">
    <name>Last order</name>
    <class>Uncommon</class>
    <modes>3</modes>
    <level>9</level>
    <effect><![CDATA[Summons<br />Mode1:<br />Earth elemental<br />Mode2:<br />Soul cleaver<br />Mode3:<br />Cultists]]></effect>
    <code><![CDATA[
    if ($mode == 1) $nextcard = 227;
    elseif ($mode == 2) $nextcard = 226;
    elseif ($mode == 3) $nextcard = 225;
]]></code>
    <created>2008-12-24</created>
    <modified>2008-12-24</modified>
  </card>
  <card id="385">
    <name>Sharpshooters</name>
    <class>Uncommon</class>
    <cost>
      <recruits>13</recruits>
    </cost>
    <modes>2</modes>
    <level>10</level>
    <keywords>Soldier,Far sight</keywords>
    <effect><![CDATA[Mode1:<br />Enemy recruits: -15<br />Mode2:<br />Enemy tower: -10]]></effect>
    <code><![CDATA[if ($mode == 1) $hisdata->Recruits-= 15; elseif ($mode == 2) $hisdata->Tower-= 10;]]></code>
    <created>2008-12-24</created>
    <modified>2010-06-21</modified>
  </card>
  <card id="386">
    <name>Sheath your swords</name>
    <class>Uncommon</class>
    <cost>
      <recruits>1</recruits>
    </cost>
    <level>10</level>
    <effect><![CDATA[Replace all non-rare recruits or mixed cost attack cards with Saints day, Merchant, Caravan or Ambassador]]></effect>
    <code><![CDATA[
    $green_c = $this->getList(['class'=>'Common', 'cost'=>'Green', 'advanced'=>'Attack:']);
    $green_u = $this->getList(['class'=>'Uncommon', 'cost'=>'Green', 'advanced'=>'Attack:']);
    $mixed_c = $this->getList(['class'=>'Common', 'cost'=>"Mixed", 'advanced'=>'Attack:']);
    $mixed_u = $this->getList(['class'=>'Uncommon', 'cost'=>"Mixed", 'advanced'=>'Attack:']);
    $attack_cards = array_unique(array_merge($green_c, $green_u, $mixed_c, $mixed_u));
    for ($i = 1; $i <= 8; $i++) {
      if (in_array($mydata->Hand[$i], $attack_cards) and $i != $cardpos) {
        $this->setCard('my', $i, $this->drawCard([263, 273, 23, 660], $mydata->Hand, $i, 'drawCardList'));
      }
    }
    for ($i = 1; $i <= 8; $i++) {
      if (in_array($hisdata->Hand[$i], $attack_cards)) {
        $this->setCard('his', $i, $this->drawCard([263, 273, 23, 660], $hisdata->Hand, $i, 'drawCardList'));
      }
    }
]]></code>
    <created>2008-12-24</created>
    <modified>2015-08-01</modified>
  </card>
  <card id="387">
    <name>Corrosion cloud</name>
    <class>Common</class>
    <cost>
      <gems>4</gems>
    </cost>
    <level>0</level>
    <keywords>Destruction,Aria</keywords>
    <effect><![CDATA[If Enemy wall = 0<br />Enemy stock: -4<br />else<br />Enemy wall: -9]]></effect>
    <code><![CDATA[
    if ($hisdata->Wall <= 0) {
      $hisdata->addStock(-4);
    }
    else $hisdata->Wall-= 9;
]]></code>
    <created>2008-12-24</created>
    <modified>2012-06-24</modified>
  </card>
  <card id="388">
    <name>Greed is good</name>
    <class>Uncommon</class>
    <level>10</level>
    <effect><![CDATA[Player(s) with highest stock (total sum) gains 25% of his current stock]]></effect>
    <code><![CDATA[
    $my_res = $mydata->Bricks + $mydata->Gems + $mydata->Recruits;
    $his_res = $hisdata->Bricks + $hisdata->Gems + $hisdata->Recruits;
    if ($my_res >= $his_res) {
      $mydata->Bricks+= round($mydata->Bricks * 0.25);
      $mydata->Gems+= round($mydata->Gems * 0.25);
      $mydata->Recruits+= round($mydata->Recruits * 0.25);
    }
    if ($my_res <= $his_res) {
      $hisdata->Bricks+= round($hisdata->Bricks * 0.25);
      $hisdata->Gems+= round($hisdata->Gems * 0.25);
      $hisdata->Recruits+= round($hisdata->Recruits * 0.25);
    }
]]></code>
    <created>2008-12-24</created>
    <modified>2008-12-24</modified>
  </card>
  <card id="389">
    <name>Bank</name>
    <class>Rare</class>
    <cost>
      <bricks>10</bricks>
      <recruits>4</recruits>
    </cost>
    <level>8</level>
    <keywords>Durable</keywords>
    <effect><![CDATA[Gain 25% of your stock (max 25 of each)]]></effect>
    <code><![CDATA[
    $mydata->Bricks+= min(round($mydata->Bricks * 0.25), 25);
    $mydata->Gems+= min(round($mydata->Gems * 0.25), 25);
    $mydata->Recruits+= min(round($mydata->Recruits * 0.25), 25);
]]></code>
    <created>2008-12-24</created>
    <modified>2010-11-01</modified>
  </card>
  <card id="390">
    <name>Anomaly sphere</name>
    <class>Rare</class>
    <cost>
      <gems>10</gems>
    </cost>
    <level>9</level>
    <keywords>Illusion</keywords>
    <effect><![CDATA[Negates the positive effect of opponent's last round on his tower, wall, facilities and stock]]></effect>
    <code><![CDATA[
    $hisdata->Tower-= max(0, $hischanges['Tower']); $hisdata->Wall-= max(0, $hischanges['Wall']);
    $hisdata->Quarry-= max(0, $hischanges['Quarry']); $hisdata->Magic-= max(0, $hischanges['Magic']); $hisdata->Dungeons-= max(0, $hischanges['Dungeons']);
    $hisdata->Bricks-= max(0, $hischanges['Bricks']); $hisdata->Gems-= max(0, $hischanges['Gems']); $hisdata->Recruits-= max(0, $hischanges['Recruits']);]]></code>
    <created>2008-12-24</created>
    <modified>2013-03-31</modified>
  </card>
  <card id="391">
    <name>Road to Valhalla</name>
    <class>Common</class>
    <level>4</level>
    <effect><![CDATA[Tower: -10<br />Wall: +20]]></effect>
    <code><![CDATA[$mydata->Tower-= 10; $mydata->Wall+= 20;]]></code>
    <created>2008-12-24</created>
    <modified>2010-04-11</modified>
  </card>
  <card id="392">
    <name>Road to Tartarus</name>
    <class>Common</class>
    <cost>
      <bricks>1</bricks>
      <gems>1</gems>
      <recruits>1</recruits>
    </cost>
    <modes>8</modes>
    <level>10</level>
    <effect><![CDATA[Replace a card in hand with Tartarus gate]]></effect>
    <code><![CDATA[$this->setCard('my', $mode, 313, ['reveal' => true]); if ($mode == $cardpos) $nextcard = 0;]]></code>
    <created>2008-12-24</created>
    <modified>2015-09-26</modified>
  </card>
  <card id="393">
    <name>Druid</name>
    <class>Common</class>
    <cost>
      <gems>6</gems>
    </cost>
    <modes>2</modes>
    <level>9</level>
    <keywords>Alliance,Mage</keywords>
    <effect><![CDATA[Attack: 5<br />Summons<br />Mode1:<br /><b>Nature</b><br />Mode2:<br /><b>Restoration</b>]]></effect>
    <code><![CDATA[
    $hisdata->attack(5);
    $selected = ($mode == 1) ? 'Nature' : 'Restoration';
    $nextcard = $this->drawCard($this->getList(['keyword'=>$selected]), $mydata->Hand, $cardpos, 'drawCardList');
]]></code>
    <effect><![CDATA[Summons<br />Mode1:<br />Master bricklayer<br />Mode2:<br />Book of magic<br />Mode3:<br />Blacksmith]]></effect>
    <created>2008-12-24</created>
    <modified>2013-03-31</modified>
  </card>
  <card id="394">
    <name>Ranger</name>
    <class>Common</class>
    <cost>
      <gems>6</gems>
      <recruits>4</recruits>
    </cost>
    <modes>8</modes>
    <level>7</level>
    <keywords>Alliance</keywords>
    <effect><![CDATA[Attack: 7<br />Recruits prod x2<br />Replace a card in hand with <b>Alliance</b>]]></effect>
    <code><![CDATA[
    $hisdata->attack(7);
    $production->multiplyRecruits(2);
    $this->setCard('my', $mode, $this->drawCard($this->getList(['keyword'=>'Alliance']), $mydata->Hand, $mode, 'drawCardList'));
    if ($mode == $cardpos) $nextcard = 0;
]]></code>
    <created>2008-12-24</created>
    <modified>2011-12-24</modified>
  </card>
  <card id="395">
    <name>Frontier outpost</name>
    <class>Common</class>
    <cost>
      <bricks>6</bricks>
    </cost>
    <level>10</level>
    <effect><![CDATA[If Wall > 7<br />Tower: +10<br />Wall: -7<br />else<br />Wall: +7]]></effect>
    <code><![CDATA[if ($mydata->Wall > 7) { $mydata->Wall-= 7; $mydata->Tower+= 10; } else $mydata->Wall+= 7;]]></code>
    <created>2008-12-24</created>
    <modified>2009-06-22</modified>
  </card>
  <card id="396">
    <name>Crystal golem</name>
    <class>Common</class>
    <cost>
      <bricks>5</bricks>
      <gems>5</gems>
      <recruits>5</recruits>
    </cost>
    <level>9</level>
    <keywords>Holy,Unliving</keywords>
    <effect><![CDATA[Gain N random resources<br />Wall: +2N<br />N = #<b>Holy</b> + #<b>Unliving</b> in hand]]></effect>
    <code><![CDATA[
    $count = $this->keywordCount($mydata->Hand, 'Holy') + $this->keywordCount($mydata->Hand, 'Unliving');
    $mydata->addRandomResources($count);
    $mydata->Wall+= 2 * $count;
]]></code>
    <created>2008-12-24</created>
    <modified>2012-04-07</modified>
  </card>
  <card id="397">
    <name>Rainbow dragon</name>
    <class>Rare</class>
    <cost>
      <gems>26</gems>
      <recruits>26</recruits>
    </cost>
    <level>8</level>
    <keywords>Dragon,Legend</keywords>
    <effect><![CDATA[Attack: 8N<br />Stock: +2N<br />N = #different keywords in hand]]></effect>
    <code><![CDATA[
    $tmp = $this->countDistinctKeywords($mydata->Hand);
    $hisdata->attack($tmp * 8);
    $mydata->addStock($tmp * 2);
]]></code>
    <created>2008-12-24</created>
    <modified>2008-12-24</modified>
  </card>
  <card id="398">
    <name>Shadow unicorn</name>
    <class>Rare</class>
    <cost>
      <gems>15</gems>
      <recruits>15</recruits>
    </cost>
    <level>5</level>
    <keywords>Legend</keywords>
    <effect><![CDATA[Attack: 25<br />Magic: +1<br />Enemy magic: -1<br />Discard a <b>Mage</b> from hand to gain<br />Gems: +30]]></effect>
    <code><![CDATA[
    $hisdata->attack(25); $mydata->Magic+= 1; $hisdata->Magic-= 1;
    $storage = array();
    for ($i = 1; $i <= 8; $i++) {
      if ($this->getCard($mydata->Hand[$i])->hasKeyword('Mage')) {
        $storage[] = $i;
      }
    }
    if (count($storage) > 0) {
      $discarded_pos = $storage[$this->arrayRand($storage)];
      $this->setCard('my', $discarded_pos, $this->drawCard($my_deck, $mydata->Hand, $discarded_pos, 'drawCardRandom'));
      $mydata->Gems+= 30;
    }
]]></code>
    <created>2008-12-24</created>
    <modified>2008-12-24</modified>
  </card>
  <card id="399">
    <name>Wizard's cottage</name>
    <class>Common</class>
    <cost>
      <bricks>3</bricks>
      <gems>1</gems>
    </cost>
    <modes>8</modes>
    <level>7</level>
    <effect><![CDATA[Tower: +2<br />Wall: +3<br />Replace a card in hand with non-rare <b>Mage</b>]]></effect>
    <code><![CDATA[
    $mydata->Tower+= 2; $mydata->Wall+= 3;
    $common = $this->getList(['class'=>'Common', 'keyword'=>'Mage']);
    $uncommon = $this->getList(['class'=>'Uncommon', 'keyword'=>'Mage']);
    $this->setCard('my', $mode, $this->drawCard(array_merge($common, $uncommon), $mydata->Hand, $mode, 'drawCardList'));
    if ($mode == $cardpos) $nextcard = 0;
]]></code>
    <created>2008-12-24</created>
    <modified>2013-03-31</modified>
  </card>
  <card id="400">
    <name>Mask of the phantasm</name>
    <class>Uncommon</class>
    <cost>
      <gems>8</gems>
    </cost>
    <modes>8</modes>
    <level>8</level>
    <keywords>Illusion</keywords>
    <effect><![CDATA[Summons selected card in hand]]></effect>
    <code><![CDATA[if ($mode != $cardpos) $nextcard = $mydata->Hand[$mode];]]></code>
    <created>2008-12-24</created>
    <modified>2011-12-24</modified>
  </card>
  <card id="401">
    <name>Invocation</name>
    <class>Rare</class>
    <level>8</level>
    <effect><![CDATA[Tower: +N<br />Wall: +N<br />N = #Bricks / 5<br />Enemy stock: -M<br />M = #Gems / 5]]></effect>
    <code><![CDATA[
    $tmp = round($mydata->Bricks / 5); $mydata->Tower+= $tmp; $mydata->Wall+= $tmp;
    $hisdata->addStock(-round($mydata->Gems / 5));
]]></code>
    <created>2008-12-24</created>
    <modified>2008-12-24</modified>
  </card>
  <card id="402">
    <name>Abyssal scavenger</name>
    <class>Common</class>
    <level>9</level>
    <keywords>Demonic,Far sight</keywords>
    <effect><![CDATA[Returns 1/3 of cost of opponent's last card (max 4)]]></effect>
    <code><![CDATA[
    $tmp_card = $hislast_card;
    $mydata->Bricks+= min(round($tmp_card->getResources('Bricks') / 3), 4);
    $mydata->Gems+= min(round($tmp_card->getResources('Gems') / 3), 4);
    $mydata->Recruits+= min(round($tmp_card->getResources('Recruits') / 3), 4);
]]></code>
    <created>2008-12-24</created>
    <modified>2013-12-24</modified>
  </card>
  <card id="403">
    <name>Dark legion</name>
    <class>Rare</class>
    <cost>
      <recruits>40</recruits>
    </cost>
    <level>8</level>
    <keywords>Horde</keywords>
    <effect><![CDATA[Recruits: +80<br />Replace your hand with <b>Horde</b> cards (can't summon self)]]></effect>
    <code><![CDATA[
    $horde = $this->getList(['keyword'=>'Horde']);
    $horde = array_diff($horde, [$card->id()]);
    $this->setHand('my', $this->drawHandList($horde));
    $nextcard = 0; $mydata->Recruits+= 80;
]]></code>
    <created>2008-12-24</created>
    <modified>2012-06-24</modified>
  </card>
  <card id="404">
    <name>Thor</name>
    <class>Rare</class>
    <cost>
      <gems>12</gems>
      <recruits>21</recruits>
    </cost>
    <level>6</level>
    <keywords>Barbarian,Mage,Swift</keywords>
    <effect><![CDATA[Attack: 20<br />Enemy tower: -15<br />Summons Chain lightning]]></effect>
    <code><![CDATA[$hisdata->attack(20); $hisdata->Tower-= 15; $nextcard = 374;]]></code>
    <created>2008-12-24</created>
    <modified>2009-04-11</modified>
  </card>
  <card id="405">
    <name>Mountain sentry</name>
    <class>Uncommon</class>
    <cost>
      <bricks>4</bricks>
      <gems>4</gems>
      <recruits>4</recruits>
    </cost>
    <level>8</level>
    <keywords>Runic,Durable,Skirmisher</keywords>
    <effect><![CDATA[Production x0<br />Negates the negative effect of opponent's last round on wall (max 20)]]></effect>
    <code><![CDATA[$production->multiply(0); $mydata->Wall-= min(0, max(-20, $mychanges['Wall']));]]></code>
    <created>2008-12-24</created>
    <modified>2011-04-24</modified>
  </card>
  <card id="406">
    <name>War elephant</name>
    <class>Uncommon</class>
    <cost>
      <recruits>38</recruits>
    </cost>
    <level>7</level>
    <keywords>Barbarian,Beast,Frenzy</keywords>
    <effect><![CDATA[Attack: 35<br />Recruits prod x2]]></effect>
    <code><![CDATA[$hisdata->attack(35); $production->multiplyRecruits(2);]]></code>
    <created>2008-12-24</created>
    <modified>2013-07-27</modified>
  </card>
  <card id="407">
    <name>Dwarven fortress</name>
    <class>Rare</class>
    <cost>
      <bricks>32</bricks>
    </cost>
    <level>10</level>
    <keywords>Runic</keywords>
    <effect><![CDATA[Tower: = 40<br />Wall: +50<br />If last card played was non-common <b>Runic</b><br />Wall: = Max wall]]></effect>
    <code><![CDATA[
    $mydata->Tower = 40;
    if ($mylast_card->hasKeyword('Runic') and $mylast_action == 'play' and $mylast_card->getClass() != 'Common') {
      $mydata->Wall = $max_wall;
    }
    else $mydata->Wall+= 50;
]]></code>
    <created>2008-12-24</created>
    <modified>2011-04-24</modified>
  </card>
  <card id="408">
    <name>Bounty hunter</name>
    <class>Uncommon</class>
    <cost>
      <recruits>14</recruits>
    </cost>
    <level>9</level>
    <keywords>Barbarian,Banish</keywords>
    <effect><![CDATA[Attack: 13<br />Discard a <b>Legend</b> from opponent's hand to gain<br />Enemy magic: -1]]></effect>
    <code><![CDATA[
    $hisdata->attack(13);
    $storage = array();
    for ($i = 1; $i <= 8; $i++) {
      if ($this->getCard($hisdata->Hand[$i])->hasKeyword('Legend')) {
        $storage[] = $i;
      }
    }
    if (count($storage) > 0) {
      $discarded_pos = $storage[$this->arrayRand($storage)];
      $this->setCard('his', $discarded_pos, $this->drawCard($his_deck, $hisdata->Hand, $discarded_pos, 'drawCardDifferent'));
      $hisdata->Magic-= 1;
    }
]]></code>
    <created>2008-12-24</created>
    <modified>2010-11-01</modified>
  </card>
  <card id="409">
    <name>Monster slayer</name>
    <class>Uncommon</class>
    <cost>
      <recruits>15</recruits>
    </cost>
    <level>10</level>
    <keywords>Far sight</keywords>
    <effect><![CDATA[Attack: 16<br />Discard highest rarity <b>Unliving</b>, <b>Undead</b> or <b>Dragon</b> from opponent's hand]]></effect>
    <code><![CDATA[
    $hisdata->attack(16);
    $storage = ['Common' => array(), 'Uncommon' => array(), 'Rare' => array()];
    for ($i = 1; $i <= 8; $i++) {
      $cur_card = $this->getCard($hisdata->Hand[$i]);
      $rarity = $cur_card->getClass();
      if ($cur_card->hasKeyword('Dragon') or $cur_card->hasKeyword('Undead') or $cur_card->hasKeyword('Unliving')) {
        $storage[$rarity][] = $i;
      }
    }
    if ((count($storage['Common']) + count($storage['Uncommon']) + count($storage['Rare'])) > 0) {
      shuffle($storage['Common']); shuffle($storage['Uncommon']); shuffle($storage['Rare']);
      $storage_temp = array_merge($storage['Common'], $storage['Uncommon'], $storage['Rare']);
      $discarded_pos = array_pop($storage_temp);
      $this->setCard('his', $discarded_pos, $this->drawCard($his_deck, $hisdata->Hand, $discarded_pos, 'drawCardDifferent'));
    }
]]></code>
    <created>2008-12-24</created>
    <modified>2012-06-24</modified>
  </card>
  <card id="410">
    <name>Shadow fairy</name>
    <class>Common</class>
    <cost>
      <gems>1</gems>
    </cost>
    <level>8</level>
    <keywords>Holy,Far sight</keywords>
    <effect><![CDATA[If #<b>Holy</b> in opponent's hand > 0<br />Enemy tower: -1<br />else<br />Stock: +1<br />Enemy stock: -1]]></effect>
    <code><![CDATA[
    if ($this->keywordCount($hisdata->Hand, 'Holy') > 0) $hisdata->Tower-= 1;
    else {
      $mydata->addStock(1);
      $hisdata->addStock(-1);
    }
]]></code>
    <created>2008-12-24</created>
    <modified>2010-06-21</modified>
  </card>
  <card id="411">
    <name>Wolf spirit</name>
    <class>Common</class>
    <cost>
      <gems>4</gems>
    </cost>
    <level>8</level>
    <keywords>Beast,Illusion</keywords>
    <effect><![CDATA[Attack: 5<br />If last card played was a <b>Beast</b><br />Recruits: +3]]></effect>
    <code><![CDATA[
    $hisdata->attack(5);
    if ($mylast_card->hasKeyword('Beast') and $mylast_action == 'play') $mydata->Recruits+= 3;
]]></code>
    <created>2008-12-24</created>
    <modified>2008-12-24</modified>
  </card>
  <card id="412">
    <name>Hungry dead</name>
    <class>Uncommon</class>
    <cost>
      <gems>8</gems>
      <recruits>8</recruits>
    </cost>
    <level>6</level>
    <keywords>Brigand,Undead,Durable,Enduring (12)</keywords>
    <effect><![CDATA[Opponent loses 10 random resources]]></effect>
    <code><![CDATA[$hisdata->addRandomResources(-10);]]></code>
    <created>2009-04-11</created>
    <modified>2015-08-01</modified>
  </card>
  <card id="413">
    <name>Colonialism</name>
    <class>Common</class>
    <cost>
      <bricks>3</bricks>
      <recruits>2</recruits>
    </cost>
    <level>7</level>
    <effect><![CDATA[If Recruits < 11<br />Recruits x2<br />else<br />Recruits: +6]]></effect>
    <code><![CDATA[
    if ($mydata->Recruits < 11) $mydata->Recruits = 2 * $mydata->Recruits;
    else $mydata->Recruits+= 6;
]]></code>
    <created>2009-04-11</created>
    <modified>2009-06-22</modified>
  </card>
  <card id="414">
    <name>Mediator</name>
    <class>Uncommon</class>
    <modes>8</modes>
    <level>6</level>
    <effect><![CDATA[Discard a card from opponent's hand and pay half its cost<br />If not enough stock<br />Matching facility: -1]]></effect>
    <code><![CDATA[
    $dis_card = $this->getCard($hisdata->Hand[$mode]);
    $this->setCard('his', $mode, $this->drawCard($his_deck, $hisdata->Hand, $mode, 'drawCardDifferent'));
    $resources = ['Quarry' => 'Bricks', 'Magic' => 'Gems', 'Dungeons' => 'Recruits'];
    foreach ($resources as $facility => $resource) {
      $mydata->$resource-= round($dis_card->getResources($resource) / 2);
      if ($mydata->$resource < 0) $mydata->$facility-= 1;
    }
]]></code>
    <created>2009-04-11</created>
    <modified>2010-07-22</modified>
  </card>
  <card id="415">
    <name>Goblin intruder</name>
    <class>Common</class>
    <cost>
      <recruits>1</recruits>
    </cost>
    <level>10</level>
    <keywords>Horde</keywords>
    <effect><![CDATA[Replace a non-rare highest rarity card in opponent's hand with Goblin intruder]]></effect>
    <code><![CDATA[
    $storage = ['Common' => array(), 'Uncommon' => array()];
    for ($i = 1; $i <= 8; $i++) {
      $cur_card = $this->getCard($hisdata->Hand[$i]);
      $rarity = $cur_card->getClass();
      if ($rarity != 'Rare' and $cur_card->id() != 415) $storage[$rarity][] = $i;
    }
    if ((count($storage['Common']) + count($storage['Uncommon'])) > 0) {
      shuffle($storage['Common']); shuffle($storage['Uncommon']);
      $storage_temp = array_merge($storage['Common'], $storage['Uncommon']);
      $discarded_pos = array_pop($storage_temp);
      $this->setCard('his', $discarded_pos, 415, ['reveal' => true]);
    }
]]></code>
    <created>2009-04-11</created>
    <modified>2015-09-26</modified>
  </card>
  <card id="416">
    <name>Perfect shot</name>
    <class>Common</class>
    <cost>
      <gems>7</gems>
    </cost>
    <level>7</level>
    <keywords>Destruction,Siege</keywords>
    <effect><![CDATA[If New<br />Enemy tower: -6<br />else<br />Attack: 6]]></effect>
    <code><![CDATA[
    if (isset($mynewflags[$cardpos])) $hisdata->Tower-= 6;
    else $hisdata->attack(6);
]]></code>
    <created>2009-04-11</created>
    <modified>2011-04-24</modified>
  </card>
  <card id="417">
    <name>New development</name>
    <class>Common</class>
    <cost>
      <bricks>10</bricks>
    </cost>
    <level>6</level>
    <effect><![CDATA[Tower: +7<br />If New<br />Tower: +3<br />Bricks: +3]]></effect>
    <code><![CDATA[
    if (isset($mynewflags[$cardpos])) {
      $mydata->Tower+= 10; $mydata->Bricks+= 3;
    }
    else $mydata->Tower+= 7;
]]></code>
    <created>2009-04-11</created>
    <modified>2009-04-11</modified>
  </card>
  <card id="418">
    <name>Power surge</name>
    <class>Uncommon</class>
    <cost>
      <gems>1</gems>
    </cost>
    <level>4</level>
    <effect><![CDATA[Tower: -8<br />If New<br />Magic: +1<br />else<br />Gems: +12]]></effect>
    <code><![CDATA[
    $mydata->Tower-= 8;
    if (isset($mynewflags[$cardpos])) $mydata->Magic+= 1; else $mydata->Gems+= 12;
]]></code>
    <created>2009-04-11</created>
    <modified>2009-04-11</modified>
  </card>
  <card id="419">
    <name>Elementalist</name>
    <class>Uncommon</class>
    <cost>
      <gems>11</gems>
    </cost>
    <level>10</level>
    <keywords>Mage,Swift,Banish</keywords>
    <effect><![CDATA[Players discard up to 6 <b>Unliving</b> cards<br />Players lose 10 bricks and 1 quarry for each card they discarded above 4]]></effect>
    <code><![CDATA[
    $my_temp = $his_temp = array();
    for ($i = 1; $i <= 8; $i++) {
      if ($this->getCard($mydata->Hand[$i])->hasKeyword('Unliving')) $my_temp[$i] = $i;
      if ($this->getCard($hisdata->Hand[$i])->hasKeyword('Unliving')) $his_temp[$i] = $i;
    }
    shuffle($my_temp); shuffle($his_temp);
    if (count($my_temp) > 0) {
      for ($i = 0; $i < count($my_temp) and $i < 6; $i++) {
        $this->setCard('my', $my_temp[$i], $this->drawCard($my_deck, $mydata->Hand, $my_temp[$i], 'drawCardRandom'));
      }
      $amount = max(($i - 4), 0); $mydata->Bricks-= $amount * 10; $mydata->Quarry-= $amount;
    }
    if (count($his_temp) > 0) {
      for ($j = 0; $j < count($his_temp) and $j < 6; $j++) {
        $this->setCard('his', $his_temp[$j], $this->drawCard($his_deck, $hisdata->Hand, $his_temp[$j], 'drawCardRandom'));
      }
      $amount = max(($j - 4), 0); $hisdata->Bricks-= $amount * 10; $hisdata->Quarry-= $amount;
    }
]]></code>
    <created>2009-04-11</created>
    <modified>2010-11-01</modified>
  </card>
  <card id="420">
    <name>Shrine</name>
    <class>Common</class>
    <cost>
      <bricks>2</bricks>
      <gems>1</gems>
    </cost>
    <level>10</level>
    <effect><![CDATA[If Wall is divisible by 5<br />Wall: +9<br />Gems: +4<br />else<br />Wall: +4]]></effect>
    <code><![CDATA[
    if (($mydata->Wall % 5) == 0) {
      $mydata->Wall+= 9; $mydata->Gems+= 4;
    }
    else $mydata->Wall+= 4;
]]></code>
    <created>2009-04-11</created>
    <modified>2012-12-24</modified>
  </card>
  <card id="421">
    <name>Gleaners</name>
    <class>Common</class>
    <cost>
      <bricks>1</bricks>
      <gems>1</gems>
      <recruits>1</recruits>
    </cost>
    <level>10</level>
    <effect><![CDATA[Gain resources equal to opponent's lowest and highest facility prod]]></effect>
    <code><![CDATA[
    $maximum = max($hisdata->Quarry, $hisdata->Magic, $hisdata->Dungeons);
    $minimum = min($hisdata->Quarry, $hisdata->Magic, $hisdata->Dungeons);
    $facilities = ['Quarry' => 'Bricks', 'Magic' => 'Gems', 'Dungeons' => 'Recruits'];
    $top = $bottom = array();
    foreach ($facilities as $facility => $resource) {
      if ($hisdata->$facility == $maximum) $top[] = $facility;
      if ($hisdata->$facility == $minimum) $bottom[] = $facility;
    }
    if (count($top) == 3) {
      shuffle($top);
      $chosen_facility_max = array_pop($top);
      $chosen_facility_min = array_pop($top);
    }
    else {
      $chosen_facility_max = $top[$this->arrayRand($top)];
      $chosen_facility_min = $bottom[$this->arrayRand($bottom)];
    }
    $mydata->$facilities[$chosen_facility_max]+= $hisdata->$chosen_facility_max;
    $mydata->$facilities[$chosen_facility_min]+= $hisdata->$chosen_facility_min;
]]></code>
    <created>2009-04-11</created>
    <modified>2011-01-24</modified>
  </card>
  <card id="422">
    <name>Death prophet</name>
    <class>Common</class>
    <level>9</level>
    <effect><![CDATA[Production x0<br />Summons Plague, Catastrophe or Death prophet]]></effect>
    <code><![CDATA[$production->multiply(0); $nextcard = $this->drawCard([15, 80, 422], $mydata->Hand, $cardpos, 'drawCardList');]]></code>
    <created>2009-04-11</created>
    <modified>2012-06-24</modified>
  </card>
  <card id="423">
    <name>Pirate ghostship</name>
    <class>Common</class>
    <cost>
      <gems>5</gems>
    </cost>
    <level>9</level>
    <keywords>Brigand,Undead</keywords>
    <effect><![CDATA[Enemy stock: -2<br />If #<b>Brigand</b> in hand + #<b>Undead</b> in hand > 3<br />Stock: +2]]></effect>
    <code><![CDATA[
    $hisdata->addStock(-2);
    if (($this->keywordCount($mydata->Hand, 'Brigand') + $this->keywordCount($mydata->Hand, 'Undead')) > 3) {
      $mydata->addStock(2);
    }
]]></code>
    <created>2009-04-11</created>
    <modified>2011-12-24</modified>
  </card>
  <card id="424">
    <name>Corsairs</name>
    <class>Uncommon</class>
    <cost>
      <gems>4</gems>
      <recruits>13</recruits>
    </cost>
    <level>9</level>
    <keywords>Brigand</keywords>
    <effect><![CDATA[Attack: 11<br />Steals resources equal to opponent's normal production<br />Summons a <b>Brigand</b>]]></effect>
    <code><![CDATA[
    $hisdata->attack(11);
    $resources = ['Quarry' => 'Bricks', 'Magic' => 'Gems', 'Dungeons' => 'Recruits'];
    foreach ($resources as $facility => $resource) {
      $mydata->$resource+= $hisdata->$facility;
      $hisdata->$resource-= $hisdata->$facility;
    }
    $nextcard = $this->drawCard($this->getList(['keyword'=>'Brigand']), $mydata->Hand, $cardpos, 'drawCardList');
]]></code>
    <created>2009-04-11</created>
    <modified>2012-09-08</modified>
  </card>
  <card id="425">
    <name>Ice queen</name>
    <class>Uncommon</class>
    <cost>
      <gems>12</gems>
    </cost>
    <level>10</level>
    <effect><![CDATA[Discard all <b>Mage</b> cards<br />Players gain 4 gems, 4 tower and 8 wall for each card they discarded]]></effect>
    <code><![CDATA[
    $my_counter = $his_counter = 0;
    for ($i = 1; $i <= 8; $i++) {
      if ($this->getCard($mydata->Hand[$i])->hasKeyword('Mage') and $i != $cardpos) {
        $this->setCard('my', $i, $this->drawCard($my_deck, $mydata->Hand, $i, 'drawCardRandom'));
        $my_counter++;
      }
      if ($this->getCard($hisdata->Hand[$i])->hasKeyword('Mage')) {
        $this->setCard('his', $i, $this->drawCard($his_deck, $hisdata->Hand, $i, 'drawCardRandom'));
        $his_counter++;
      }
    }
    $mydata->Tower+= $my_counter * 4; $mydata->Wall+= $my_counter * 8; $mydata->Gems+= $my_counter * 4;
    $hisdata->Tower+= $his_counter * 4; $hisdata->Wall+= $his_counter * 8; $hisdata->Gems+= $his_counter * 4;
]]></code>
    <created>2009-04-11</created>
    <modified>2009-12-24</modified>
  </card>
  <card id="426">
    <name>Arthoria the Saber</name>
    <class>Rare</class>
    <cost>
      <gems>20</gems>
      <recruits>20</recruits>
    </cost>
    <modes>8</modes>
    <level>10</level>
    <keywords>Legend,Swift,Enduring (10)</keywords>
    <effect><![CDATA[Attack: 30<br />Replace a card in hand with self]]></effect>
    <code><![CDATA[
    $hisdata->attack(30);
    if ($mode == $cardpos) $nextcard = 0;
    else $this->replaceCard('my', $mode, $card->id());
]]></code>
    <created>2009-04-11</created>
    <modified>2012-01-06</modified>
  </card>
  <card id="427">
    <name>Darkforge</name>
    <class>Rare</class>
    <cost>
      <bricks>18</bricks>
      <gems>9</gems>
    </cost>
    <level>5</level>
    <keywords>Alliance</keywords>
    <effect><![CDATA[Tower: +7<br />Recruits prod x10]]></effect>
    <code><![CDATA[$mydata->Tower+= 7; $production->multiplyRecruits(10);]]></code>
    <created>2009-04-11</created>
    <modified>2013-07-27</modified>
  </card>
  <card id="428">
    <name>Spectral dragon</name>
    <class>Rare</class>
    <cost>
      <gems>40</gems>
      <recruits>50</recruits>
    </cost>
    <level>2</level>
    <keywords>Dragon,Undead</keywords>
    <effect><![CDATA[Attack: 150<br />Gems: +20]]></effect>
    <code><![CDATA[$hisdata->attack(150); $mydata->Gems+= 20;]]></code>
    <created>2009-04-11</created>
    <modified>2009-04-11</modified>
  </card>
  <card id="429">
    <name>Valley of thousand rivers</name>
    <class>Uncommon</class>
    <cost>
      <gems>6</gems>
    </cost>
    <level>7</level>
    <effect><![CDATA[Player(s) with most <b>Alliance</b>, <b>Legend</b> and <b>Mage</b> gains<br />Lowest facility: +1]]></effect>
    <code><![CDATA[
    $my_count = $this->keywordCount($mydata->Hand, 'Alliance') + $this->keywordCount($mydata->Hand, 'Legend') + $this->keywordCount($mydata->Hand, 'Mage');
    $his_count = $this->keywordCount($hisdata->Hand, 'Alliance') + $this->keywordCount($hisdata->Hand, 'Legend') + $this->keywordCount($hisdata->Hand, 'Mage');
    if ($my_count >= $his_count) {
      $mydata->addLowestFacility(1);
    }
    if ($my_count <= $his_count) {
      $hisdata->addLowestFacility(1);
    }
]]></code>
    <created>2009-04-11</created>
    <modified>2009-04-11</modified>
  </card>
  <card id="430">
    <name>Messenger</name>
    <class>Common</class>
    <level>10</level>
    <keywords>Far sight</keywords>
    <effect><![CDATA[Summons an uncommon card not from your deck]]></effect>
    <code><![CDATA[$nextcard = $this->drawCard(array_diff($this->getList(['class'=>'Uncommon']), $my_deck->Uncommon), $mydata->Hand, $cardpos, 'drawCardList');]]></code>
    <created>2009-04-11</created>
    <modified>2010-06-21</modified>
  </card>
  <card id="431">
    <name>Divine intervention</name>
    <class>Uncommon</class>
    <cost>
      <gems>10</gems>
    </cost>
    <level>6</level>
    <effect><![CDATA[Player(s) with most <b>Holy</b> in hand gains<br />Tower: +9<br />Wall: +17]]></effect>
    <code><![CDATA[
    $my_count = $this->keywordCount($mydata->Hand, 'Holy');
    $his_count = $this->keywordCount($hisdata->Hand, 'Holy');
    if ($my_count >= $his_count) {
      $mydata->Tower+= 9; $mydata->Wall+= 17;
    }
    if ($my_count <= $his_count) {
      $hisdata->Tower+= 9; $hisdata->Wall+= 17;
    }
]]></code>
    <created>2009-04-11</created>
    <modified>2011-09-24</modified>
  </card>
  <card id="432">
    <name>Fair trade</name>
    <class>Uncommon</class>
    <level>10</level>
    <effect><![CDATA[Player(s) with lowest stock gains<br />Stock: +15<br />His opponent gains<br />Facilities: +1]]></effect>
    <code><![CDATA[
    $my_count = $mydata->Bricks + $mydata->Gems + $mydata->Recruits;
    $his_count = $hisdata->Bricks + $hisdata->Gems + $hisdata->Recruits;
    if ($my_count >= $his_count) {
      $mydata->addFacilities(1);
      $hisdata->addStock(15);
    }
    if ($my_count <= $his_count) {
      $hisdata->addFacilities(1);
      $mydata->addStock(15);
    }
]]></code>
    <created>2009-04-11</created>
    <modified>2010-07-22</modified>
  </card>
  <card id="433">
    <name>Moon priestess</name>
    <class>Uncommon</class>
    <cost>
      <gems>1</gems>
    </cost>
    <level>9</level>
    <effect><![CDATA[Replace highest and lowest cost card in opponent's hand with Moon shrine, Moon castle or Magic sanctuary]]></effect>
    <code><![CDATA[
    $low = $high = $costs = array();
    $min = 1000; $max = 0;
    for ($i = 1; $i <= 8; $i++) {
      $cur_cost = $costs[$i] = $this->getCard($hisdata->Hand[$i])->getResources();
      if ($cur_cost < $min) $min = $cur_cost;
      if ($cur_cost > $max) $max = $cur_cost;
    }
    for ($i = 1; $i <= 8; $i++) {
      $cur_cost = $costs[$i];
      if ($cur_cost == $min) $low[] = $i;
      if ($cur_cost == $max) $high[] = $i;
    }

    if ($min == $max) {
      shuffle($high);
      $low_dis = array_pop($high);
      $high_dis = array_pop($high);
    }
    else {
      $low_dis = $low[$this->arrayRand($low)];
      $high_dis = $high[$this->arrayRand($high)];
    }
    $storage = [487, 583, 486];
    $chosen = $storage[$this->arrayRand($storage)];
    $storage = array_diff($storage, [$chosen]);
    $this->setCard('his', $low_dis, $chosen);
    $this->setCard('his', $high_dis, $storage[$this->arrayRand($storage)]);
]]></code>
    <created>2009-04-11</created>
    <modified>2015-09-26</modified>
  </card>
  <card id="434">
    <name>Outnumbered and outmatched</name>
    <class>Rare</class>
    <level>10</level>
    <effect><![CDATA[If Recruits - Enemy recruits > 35<br />Recruits: -35<br />Enemy tower: = 1<br />Enemy wall: = 0]]></effect>
    <code><![CDATA[
    if (($mydata->Recruits - $hisdata->Recruits) > 35) {
      $mydata->Recruits-= 35; $hisdata->Tower = 1; $hisdata->Wall = 0;
    }
]]></code>
    <created>2009-04-11</created>
    <modified>2011-01-01</modified>
  </card>
  <card id="435">
    <name>Alastor flame of heavens</name>
    <class>Rare</class>
    <cost>
      <gems>25</gems>
    </cost>
    <level>7</level>
    <keywords>Burning,Holy,Banish</keywords>
    <effect><![CDATA[Gems: +50<br />Magic: +1]]></effect>
    <code><![CDATA[$mydata->Gems+= 50; $mydata->Magic+= 1;]]></code>
    <created>2009-04-11</created>
    <modified>2010-09-10</modified>
  </card>
  <card id="436">
    <name>Watchtower</name>
    <class>Uncommon</class>
    <cost>
      <bricks>18</bricks>
      <recruits>13</recruits>
    </cost>
    <level>8</level>
    <effect><![CDATA[Tower: +16<br />Enemy tower: -6<br />If #<b>Far sight</b> in hand > 0 and #<b>Siege</b> in hand > 0<br />Enemy tower: -10]]></effect>
    <code><![CDATA[
    $mydata->Tower+= 16;
    if ($this->keywordCount($mydata->Hand, 'Far sight') > 0 and $this->keywordCount($mydata->Hand, 'Siege') > 0) {
      $hisdata->Tower-= 16;
    }
    else $hisdata->Tower-= 6;
]]></code>
    <created>2009-04-11</created>
    <modified>2015-08-01</modified>
  </card>
  <card id="437">
    <name>Battlements</name>
    <class>Common</class>
    <cost>
      <bricks>7</bricks>
      <recruits>2</recruits>
    </cost>
    <level>6</level>
    <effect><![CDATA[Tower: +7<br />If #<b>Siege</b> in hand > 0<br />Enemy tower: -4]]></effect>
    <code><![CDATA[
    $mydata->Tower+= 7;
    if ($this->keywordCount($mydata->Hand, 'Siege') > 0) $hisdata->Tower-= 4;
]]></code>
    <created>2009-04-11</created>
    <modified>2011-04-24</modified>
  </card>
  <card id="438">
    <name>Phoenix feather</name>
    <class>Common</class>
    <cost>
      <bricks>6</bricks>
      <gems>6</gems>
      <recruits>6</recruits>
    </cost>
    <level>10</level>
    <keywords>Burning</keywords>
    <effect><![CDATA[If #<b>Burning</b> in hand = 2<br />Summons Phoenix<br />else<br />Gems: +14]]></effect>
    <code><![CDATA[
    if ($this->keywordCount($mydata->Hand, 'Burning') == 2) $nextcard = 223;
    else $mydata->Gems+= 14;
]]></code>
    <created>2009-04-11</created>
    <modified>2009-06-22</modified>
  </card>
  <card id="439">
    <name>Revenge of the fallen</name>
    <class>Uncommon</class>
    <cost>
      <gems>9</gems>
    </cost>
    <level>8</level>
    <effect><![CDATA[Player(s) with fewest <b>Brigand</b> or <b>Undead</b> in hand suffers<br />Highest facility: -1]]></effect>
    <code><![CDATA[
    $my_count = $this->keywordCount($mydata->Hand, 'Brigand') + $this->keywordCount($mydata->Hand, 'Undead');
    $his_count = $this->keywordCount($hisdata->Hand, 'Brigand') + $this->keywordCount($hisdata->Hand, 'Undead');
    if ($my_count <= $his_count) {
      $mydata->addHighestFacility(-1);
    }
    if ($my_count >= $his_count) {
      $hisdata->addHighestFacility(-1);
    }
]]></code>
    <created>2009-04-11</created>
    <modified>2012-09-08</modified>
  </card>
  <card id="440">
    <name>Dragonling</name>
    <class>Common</class>
    <cost>
      <recruits>2</recruits>
    </cost>
    <level>3</level>
    <keywords>Dragon</keywords>
    <effect><![CDATA[Gems prod x2]]></effect>
    <code><![CDATA[$production->multiplyGems(2);]]></code>
    <created>2009-07-22</created>
    <modified>2009-07-22</modified>
  </card>
  <card id="441">
    <name>Troll bridge</name>
    <class>Uncommon</class>
    <cost>
      <bricks>22</bricks>
    </cost>
    <level>10</level>
    <keywords>Horde</keywords>
    <effect><![CDATA[Wall: +15<br />Dungeon: +1<br />If #Troll in hand > 0<br />Attack: 15]]></effect>
    <code><![CDATA[
    $mydata->Wall+= 15; $mydata->Dungeons+= 1;
    for ($i = 1; $i <= 8; $i++) {
      if ($mydata->Hand[$i] == 106) {
        $hisdata->attack(15); break;
      }
    }
]]></code>
    <created>2009-07-22</created>
    <modified>2011-12-24</modified>
  </card>
  <card id="442">
    <name>Dark forest</name>
    <class>Uncommon</class>
    <cost>
      <gems>10</gems>
      <recruits>9</recruits>
    </cost>
    <level>10</level>
    <keywords>Nature</keywords>
    <effect><![CDATA[Wall: +24<br />Gems: +#<b>Nature</b> in hand<br />Recruits: +#<b>Beast</b> in hand]]></effect>
    <code><![CDATA[
    $mydata->Wall+= 24;
    $mydata->Gems+= $this->keywordCount($mydata->Hand, 'Nature');
    $mydata->Recruits+= $this->keywordCount($mydata->Hand, 'Beast');
]]></code>
    <created>2009-07-22</created>
    <modified>2013-07-27</modified>
  </card>
  <card id="443">
    <name>Vulture</name>
    <class>Uncommon</class>
    <cost>
      <recruits>11</recruits>
    </cost>
    <level>10</level>
    <keywords>Beast,Aria</keywords>
    <effect><![CDATA[Attack: 10<br />If last card was discarded bonus attack based on discarded card rarity (C-8, U-16, R-28)]]></effect>
    <code><![CDATA[
    $hisdata->attack(10);
    if ($mylast_action == 'discard') {
      $damage = ['Common' => 8, 'Uncommon' => 16, 'Rare' => 28];
      $hisdata->attack($damage[$mylast_card->getClass()]);
    }
]]></code>
    <created>2009-07-22</created>
    <modified>2012-06-24</modified>
  </card>
  <card id="444">
    <name>Firewall</name>
    <class>Uncommon</class>
    <cost>
      <gems>30</gems>
    </cost>
    <level>10</level>
    <keywords>Burning</keywords>
    <effect><![CDATA[Wall: +35<br />Attack: 5N<br />N = #<b>Burning</b> in hand]]></effect>
    <code><![CDATA[
    $mydata->Wall+= 35;
    $hisdata->attack(5 * $this->keywordCount($mydata->Hand, 'Burning'));
]]></code>
    <created>2009-07-22</created>
    <modified>2012-09-08</modified>
  </card>
  <card id="445">
    <name>Poltergeist</name>
    <class>Common</class>
    <cost>
      <gems>5</gems>
    </cost>
    <level>8</level>
    <keywords>Illusion,Undead</keywords>
    <effect><![CDATA[Opponent's lowest resource: -7]]></effect>
    <code><![CDATA[$hisdata->addLowestResource(-7);]]></code>
    <created>2009-07-22</created>
    <modified>2012-09-08</modified>
  </card>
  <card id="446">
    <name>Treant</name>
    <class>Uncommon</class>
    <cost>
      <recruits>25</recruits>
    </cost>
    <level>7</level>
    <keywords>Nature,Siege</keywords>
    <effect><![CDATA[Enemy wall: -22<br />Attack: 18]]></effect>
    <code><![CDATA[$hisdata->Wall-= 22; $hisdata->attack(18);]]></code>
    <created>2006-05-01</created>
    <modified>2011-04-24</modified>
  </card>
  <card id="447">
    <name>Imperial army</name>
    <class>Rare</class>
    <cost>
      <recruits>45</recruits>
    </cost>
    <level>4</level>
    <keywords>Soldier,Charge (45),Siege</keywords>
    <effect><![CDATA[Attack: 45]]></effect>
    <code><![CDATA[$hisdata->attack(45);]]></code>
    <created>2009-07-22</created>
    <modified>2011-04-24</modified>
  </card>
  <card id="448">
    <name>Giant</name>
    <class>Uncommon</class>
    <cost>
      <recruits>25</recruits>
    </cost>
    <level>10</level>
    <effect><![CDATA[Attack: 35<br />Discard all common cards (opponent can't draw rare cards)]]></effect>
    <code><![CDATA[
    $hisdata->attack(35);
    for ($i = 1; $i <= 8; $i++) {
      if ($i != $cardpos and $this->getCard($mydata->Hand[$i])->getClass() == 'Common') {
        $this->setCard('my', $i, $this->drawCard($my_deck, $mydata->Hand, $i, 'drawCardRandom'));
      }
    }
    for ($i = 1; $i <= 8; $i++) {
      if ($this->getCard($hisdata->Hand[$i])->getClass() == 'Common') {
        $this->setCard('his', $i, $this->drawCard($his_deck, $hisdata->Hand, $i, 'drawCardNoRare'));
      }
    }
]]></code>
    <created>2009-07-22</created>
    <modified>2012-09-08</modified>
  </card>
  <card id="449">
    <name>Halfling rogue</name>
    <class>Common</class>
    <modes>8</modes>
    <level>10</level>
    <effect><![CDATA[Summons selected zero cost card in hand (can't summon self)]]></effect>
    <code><![CDATA[
    if ($cardpos != $mode and $this->getCard($mydata->Hand[$mode])->getResources() == 0) {
      $nextcard = $mydata->Hand[$mode];
    }
]]></code>
    <created>2009-07-22</created>
    <modified>2011-02-12</modified>
  </card>
  <card id="450">
    <name>White shrine</name>
    <class>Rare</class>
    <cost>
      <bricks>22</bricks>
      <gems>12</gems>
    </cost>
    <level>6</level>
    <keywords>Holy,Restoration</keywords>
    <effect><![CDATA[Tower: +10<br />Highest facility: +1<br />Lowest facility: +2]]></effect>
    <code><![CDATA[
    $mydata->Tower+= 10;
    $mydata->addHighestFacility(1);
    $mydata->addLowestFacility(2);
]]></code>
    <created>2009-07-22</created>
    <modified>2010-09-10</modified>
  </card>
  <card id="451">
    <name>Siege preparations</name>
    <class>Common</class>
    <cost>
      <recruits>2</recruits>
    </cost>
    <level>5</level>
    <effect><![CDATA[Recruits: +9<br />Enemy wall: +8]]></effect>
    <code><![CDATA[$mydata->Recruits+= 9; $hisdata->Wall+= 8;]]></code>
    <created>2009-07-22</created>
    <modified>2009-07-22</modified>
  </card>
  <card id="452">
    <name>Invaders</name>
    <class>Common</class>
    <cost>
      <recruits>2</recruits>
    </cost>
    <modes>8</modes>
    <level>6</level>
    <keywords>Horde</keywords>
    <effect><![CDATA[Attack: 3<br />Replace a card in hand with self]]></effect>
    <code><![CDATA[
    $hisdata->attack(3);
    if ($mode == $cardpos) $nextcard = 0;
    else $this->replaceCard('my', $mode, $card->id());
]]></code>
    <created>2009-07-22</created>
    <modified>2015-09-26</modified>
  </card>
  <card id="453">
    <name>Ancient sage</name>
    <class>Rare</class>
    <cost>
      <bricks>8</bricks>
      <gems>8</gems>
      <recruits>8</recruits>
    </cost>
    <level>8</level>
    <keywords>Legend,Nature</keywords>
    <effect><![CDATA[Production xN<br />N = #<b>Alliance</b> + #<b>Nature</b> in hand (max 5)]]></effect>
    <code><![CDATA[$production->multiply(min(5, $this->keywordCount($mydata->Hand, 'Alliance') + $this->keywordCount($mydata->Hand, 'Nature')));]]></code>
    <created>2009-07-22</created>
    <modified>2015-08-01</modified>
  </card>
  <card id="454">
    <name>Dryad</name>
    <class>Common</class>
    <cost>
      <recruits>2</recruits>
    </cost>
    <level>0</level>
    <keywords>Nature,Banish</keywords>
    <effect><![CDATA[Enemy wall: -6]]></effect>
    <code><![CDATA[$hisdata->Wall-= 6;]]></code>
    <created>2009-07-22</created>
    <modified>2010-11-01</modified>
  </card>
  <card id="455">
    <name>Imp</name>
    <class>Common</class>
    <cost>
      <gems>4</gems>
    </cost>
    <level>9</level>
    <keywords>Demonic</keywords>
    <effect><![CDATA[Gems: +N<br />Enemy gems: -2N<br />N = #Enemy magic]]></effect>
    <code><![CDATA[$mydata->Gems+= $hisdata->Magic; $hisdata->Gems-= 2 * $hisdata->Magic;]]></code>
    <created>2009-07-22</created>
    <modified>2013-12-24</modified>
  </card>
  <card id="456">
    <name>Prosperity</name>
    <class>Rare</class>
    <level>10</level>
    <keywords>Restoration</keywords>
    <effect><![CDATA[If Stock < Enemy stock<br />Stock: +12<br />else<br />Stock: +6<br />Enemy stock: +6]]></effect>
    <code><![CDATA[
    $my_count = $mydata->Bricks + $mydata->Gems + $mydata->Recruits;
    $his_count = $hisdata->Bricks + $hisdata->Gems + $hisdata->Recruits;
    if ($my_count < $his_count) {
      $mydata->addStock(12);
    }
    else {
      $mydata->addStock(6);
      $hisdata->addStock(6);
    }
]]></code>
    <created>2009-07-22</created>
    <modified>2011-02-12</modified>
  </card>
  <card id="457">
    <name>Chaos wizard</name>
    <class>Common</class>
    <cost>
      <gems>4</gems>
    </cost>
    <level>4</level>
    <keywords>Mage,Durable</keywords>
    <effect><![CDATA[Attack: 5<br />Discard a common card from hand]]></effect>
    <code><![CDATA[
    $hisdata->attack(5);
    $storage = array();
    for ($i = 1; $i <= 8; $i++) {
      if ($i != $cardpos and $this->getCard($mydata->Hand[$i])->getClass() == 'Common') {
        $storage[] = $i;
      }
    }
    if (count($storage) > 0) {
      $dis_index = $storage[$this->arrayRand($storage)];
      $this->setCard('my', $dis_index, $this->drawCard($my_deck, $mydata->Hand, $dis_index, 'drawCardRandom'));
    }
]]></code>
    <created>2009-07-22</created>
    <modified>2010-07-22</modified>
  </card>
  <card id="458">
    <name>Dark warrior</name>
    <class>Common</class>
    <cost>
      <recruits>6</recruits>
    </cost>
    <level>8</level>
    <keywords>Frenzy</keywords>
    <effect><![CDATA[Attack: Opponent's lowest resource (max 12)]]></effect>
    <code><![CDATA[$hisdata->attack(min($hisdata->Bricks, $hisdata->Gems, $hisdata->Recruits, 12));]]></code>
    <created>2009-07-22</created>
    <modified>2012-12-24</modified>
  </card>
  <card id="459">
    <name>Dark flame</name>
    <class>Common</class>
    <cost>
      <gems>1</gems>
    </cost>
    <level>9</level>
    <keywords>Burning</keywords>
    <effect><![CDATA[Discard all common zero cost cards (can't draw rare cards)]]></effect>
    <code><![CDATA[
    for ($i = 1; $i <= 8; $i++) {
      if ($i != $cardpos) {
        $cur_card = $this->getCard($mydata->Hand[$i]);
        if ($cur_card->getResources() == 0 and $cur_card->getClass() == 'Common') {
          $this->setCard('my', $i, $this->drawCard($my_deck, $mydata->Hand, $i, 'drawCardNoRare'));
        }
      }
    }
    for ($i = 1; $i <= 8; $i++) {
      $cur_card = $this->getCard($hisdata->Hand[$i]);
      if ($cur_card->getResources() == 0 and $cur_card->getClass() == 'Common') {
        $this->setCard('his', $i, $this->drawCard($his_deck, $hisdata->Hand, $i, 'drawCardNoRare'));
      }
    }
]]></code>
    <created>2009-07-22</created>
    <modified>2010-07-22</modified>
  </card>
  <card id="460">
    <name>Work in progress</name>
    <class>Common</class>
    <cost>
      <bricks>3</bricks>
    </cost>
    <level>6</level>
    <keywords>Runic,Durable,Far sight</keywords>
    <effect><![CDATA[Tower: +3]]></effect>
    <code><![CDATA[$mydata->Tower+= 3;]]></code>
    <created>2009-07-22</created>
    <modified>2011-12-24</modified>
  </card>
  <card id="461">
    <name>Avenging angel</name>
    <class>Rare</class>
    <cost>
      <gems>25</gems>
      <recruits>30</recruits>
    </cost>
    <level>7</level>
    <keywords>Holy,Banish</keywords>
    <effect><![CDATA[Attack: Max tower - Tower]]></effect>
    <code><![CDATA[$hisdata->attack($max_tower - $mydata->Tower);]]></code>
    <created>2009-07-22</created>
    <modified>2010-12-24</modified>
  </card>
  <card id="462">
    <name>Relic hunter</name>
    <class>Uncommon</class>
    <cost>
      <bricks>1</bricks>
      <gems>1</gems>
      <recruits>1</recruits>
    </cost>
    <level>10</level>
    <effect><![CDATA[If #<b>Titan</b> in hand > 0<br />Discard all cards from hand except <b>Titan</b> and <b>Titan</b> support cards]]></effect>
    <code><![CDATA[
    if ($this->keywordCount($mydata->Hand, 'Titan') > 0) {
      $support = $this->getList(['support'=>'Titan']);

      for ($i = 1; $i <= 8; $i++) {
        if ($i != $cardpos and !$this->getCard($mydata->Hand[$i])->hasKeyword('Titan') and !in_array($mydata->Hand[$i], $support)) {
          $this->setCard('my', $i, $this->drawCard($my_deck, $mydata->Hand, $i, 'drawCardRandom'));
        }
      }
    }
]]></code>
    <created>2009-07-22</created>
    <modified>2012-12-24</modified>
  </card>
  <card id="463">
    <name>Fire elemental</name>
    <class>Uncommon</class>
    <cost>
      <gems>18</gems>
      <recruits>8</recruits>
    </cost>
    <level>7</level>
    <keywords>Burning,Rebirth,Enduring (8)</keywords>
    <effect><![CDATA[Attack: 17<br />Gems prod x2]]></effect>
    <code><![CDATA[$hisdata->attack(17); $production->multiplyGems(2);]]></code>
    <created>2009-07-22</created>
    <modified>2012-06-24</modified>
  </card>
  <card id="464">
    <name>Chimera</name>
    <class>Rare</class>
    <cost>
      <gems>30</gems>
      <recruits>20</recruits>
    </cost>
    <level>3</level>
    <keywords>Beast,Frenzy</keywords>
    <effect><![CDATA[Enemy tower: -20<br />Enemy wall: -20<br />Attack: 20]]></effect>
    <code><![CDATA[
    $hisdata->Tower-= 20; $hisdata->Wall-= 20;
    $hisdata->attack(20);
]]></code>
    <created>2009-07-22</created>
    <modified>2009-07-22</modified>
  </card>
  <card id="465">
    <name>Merchant ship</name>
    <class>Uncommon</class>
    <cost>
      <bricks>7</bricks>
      <gems>7</gems>
      <recruits>7</recruits>
    </cost>
    <level>5</level>
    <effect><![CDATA[Lowest facility: +1<br />Lowest resource prod x3]]></effect>
    <code><![CDATA[$mydata->addLowestFacility(1); $production->multiply(3, $mydata->detectLowestResource());]]></code>
    <created>2009-07-22</created>
    <modified>2010-02-27</modified>
  </card>
  <card id="466">
    <name>Oasis</name>
    <class>Uncommon</class>
    <cost>
      <gems>3</gems>
    </cost>
    <level>1</level>
    <keywords>Restoration</keywords>
    <effect><![CDATA[Player(s) with lowest wall gains<br />Stock: +6]]></effect>
    <code><![CDATA[
    if ($mydata->Wall <= $hisdata->Wall) {
      $mydata->addStock(6);
    }
    if ($mydata->Wall >= $hisdata->Wall) {
      $hisdata->addStock(6);
    }
]]></code>
    <created>2009-07-22</created>
    <modified>2010-09-23</modified>
  </card>
  <card id="467">
    <name>Wind witch</name>
    <class>Rare</class>
    <cost>
      <gems>24</gems>
    </cost>
    <modes>8</modes>
    <level>7</level>
    <keywords>Mage,Swift,Aria</keywords>
    <effect><![CDATA[Attack: 18<br />Gems prod x3<br />Replace a card in opponent's hand with Wind]]></effect>
    <code><![CDATA[$hisdata->attack(18); $production->multiplyGems(3); $this->setCard('his', $mode, 247, ['reveal' => true]);]]></code>
    <created>2009-10-24</created>
    <modified>2015-09-26</modified>
  </card>
  <card id="468">
    <name>Strive for height</name>
    <class>Common</class>
    <cost>
      <bricks>4</bricks>
    </cost>
    <level>10</level>
    <effect><![CDATA[If Wall is not divisible by 15<br />Wall is raised up to the next height that is divisible by 15]]></effect>
    <code><![CDATA[$mydata->Wall = ceil($mydata->Wall / 15) * 15;]]></code>
    <created>2009-10-24</created>
    <modified>2011-12-24</modified>
  </card>
  <card id="469">
    <name>Soul sacrifice</name>
    <class>Uncommon</class>
    <modes>2</modes>
    <level>4</level>
    <keywords>Demonic</keywords>
    <effect><![CDATA[Mode1:<br />Tower: -5<br />Stock: +4<br />Mode2:<br />Tower: -10<br />Stock: +8]]></effect>
    <code><![CDATA[
    if ($mode == 1) {
      $mydata->Tower-=5; $mydata->addStock(4);
    }
    elseif ($mode == 2) {
      $mydata->Tower-=10; $mydata->addStock(8);
    }
]]></code>
    <created>2009-10-24</created>
    <modified>2013-12-24</modified>
  </card>
  <card id="470">
    <name>Dark templar</name>
    <class>Uncommon</class>
    <cost>
      <gems>10</gems>
    </cost>
    <level>10</level>
    <effect><![CDATA[Discard all cards with cost below 10 (can't draw rare cards)<br />Stock: +N/2<br />N = #discarded cards]]></effect>
    <code><![CDATA[
    $discarded = 0;
    for ($i = 1; $i <= 8; $i++) {
      if ($i != $cardpos and $this->getCard($mydata->Hand[$i])->getResources() < 10) {
        $this->setCard('my', $i, $this->drawCard($my_deck, $mydata->Hand, $i, 'drawCardNoRare'));
        $discarded++;
      }
      if ($this->getCard($hisdata->Hand[$i])->getResources() < 10) {
        $this->setCard('his', $i, $this->drawCard($his_deck, $hisdata->Hand, $i, 'drawCardNoRare'));
        $discarded++;
      }
    }
    $mydata->addStock(round($discarded / 2));
]]></code>
    <created>2009-10-24</created>
    <modified>2012-09-08</modified>
  </card>
  <card id="471">
    <name>Mysterious egg</name>
    <class>Uncommon</class>
    <level>7</level>
    <effect><![CDATA[Stock: +2<br />Summons Griffin, Roc or Rainbow Dragon]]></effect>
    <code><![CDATA[$mydata->addStock(2); $nextcard = $this->drawCard([25, 202, 397], $mydata->Hand, $cardpos, 'drawCardList');]]></code>
    <created>2009-10-24</created>
    <modified>2015-08-01</modified>
  </card>
  <card id="472">
    <name>Pirate bay</name>
    <class>Uncommon</class>
    <cost>
      <bricks>25</bricks>
    </cost>
    <level>10</level>
    <effect><![CDATA[Wall: +10<br />Enemy stock: -3<br />Replace up to 3 non-<b>Brigand</b> non-rare cards in hand with non-common <b>Brigand</b>]]></effect>
    <code><![CDATA[
    $mydata->Wall+= 10;
    $hisdata->addStock(-3);
    $storage = array();
    for ($i = 1; $i <= 8; $i++) {
      $cur_card = $this->getCard($mydata->Hand[$i]);
      if (!$cur_card->hasKeyword('Brigand') and $cur_card->getClass() != 'Rare' and $i != $cardpos) {
        $storage[] = $i;
      }
    }
    if (count($storage) > 0) {
      shuffle($storage);
      $brigand_list = array_merge($this->getList(['class'=>'Uncommon', 'keyword'=>'Brigand']), $this->getList(['class'=>'Rare', 'keyword'=>'Brigand']));
      for ($i = 0; $i < count($storage) and $i < 3; $i++) {
        $this->setCard('my', $storage[$i], $this->drawCard($brigand_list, $mydata->Hand, $storage[$i], 'drawCardList'));
      }
    }
]]></code>
    <created>2009-10-24</created>
    <modified>2009-10-24</modified>
  </card>
  <card id="473">
    <name>Knight templar</name>
    <class>Uncommon</class>
    <cost>
      <recruits>27</recruits>
    </cost>
    <level>8</level>
    <keywords>Holy,Soldier</keywords>
    <effect><![CDATA[Attack: 48<br />Won't lower enemy tower below 15]]></effect>
    <code><![CDATA[
    $tmp = min($hisdata->Tower, 15);
    $hisdata->attack(48); $hisdata->Tower = max($hisdata->Tower, $tmp);
]]></code>
    <created>2009-10-24</created>
    <modified>2009-10-24</modified>
  </card>
  <card id="474">
    <name>Market week</name>
    <class>Rare</class>
    <level>5</level>
    <effect><![CDATA[Replace your hand with Merchant, Caravan, Wealth, Merchant ship, Fair trade, Greed is good, Prosperity and Bank]]></effect>
    <code><![CDATA[$this->setHandShuffled('my', [273, 23, 129, 465, 432, 388, 456, 389]); $nextcard = 0;]]></code>
    <created>2009-10-24</created>
    <modified>2012-12-24</modified>
  </card>
  <card id="475">
    <name>Wishing lagoon</name>
    <class>Uncommon</class>
    <cost>
      <bricks>6</bricks>
      <gems>6</gems>
      <recruits>6</recruits>
    </cost>
    <modes>3</modes>
    <level>10</level>
    <effect><![CDATA[Summons<br />Mode1:<br />Pyramids<br />Mode2:<br />Gateway<br />Mode3:<br />Orc Regiment]]></effect>
    <code><![CDATA[
    if ($mode == 1) $nextcard = 87;
    elseif ($mode == 2) $nextcard = 118;
    elseif ($mode == 3) $nextcard = 89;
]]></code>
    <created>2009-10-24</created>
    <modified>2014-12-24</modified>
  </card>
  <card id="476">
    <name>Doppelganger</name>
    <class>Common</class>
    <cost>
      <gems>5</gems>
    </cost>
    <modes>8</modes>
    <level>10</level>
    <keywords>Illusion</keywords>
    <effect><![CDATA[If targeting self and not New, summons the matching card, else replace a card in hand with self]]></effect>
    <code><![CDATA[
    if (!isset($mynewflags[$cardpos]) and $mode == $cardpos) {
      $nextcard = $hisdata->Hand[$cardpos];
    }
    else {
      if ($mode == $cardpos) $nextcard = 0;
      else $this->replaceCard('my', $mode, $card->id());
    }
]]></code>
    <created>2009-10-24</created>
    <modified>2011-12-24</modified>
  </card>
  <card id="477">
    <name>Trigger trap</name>
    <class>Common</class>
    <cost>
      <bricks>5</bricks>
    </cost>
    <level>10</level>
    <effect><![CDATA[Enemy tower: -3<br />If not New and matching card is New<br />Enemy tower: -5]]></effect>
    <code><![CDATA[
    if (!isset($mynewflags[$cardpos]) and isset($hisnewflags[$cardpos])) $hisdata->Tower-=8;
    else $hisdata->Tower-=3;
]]></code>
    <created>2009-10-24</created>
    <modified>2009-10-26</modified>
  </card>
  <card id="478">
    <name>Renewal</name>
    <class>Common</class>
    <modes>8</modes>
    <level>10</level>
    <keywords>Restoration,Aria</keywords>
    <effect><![CDATA[Adds New flag to the selected card in hand<br />Gems: +2]]></effect>
    <code><![CDATA[$mydata->NewCards[$mode] = 1; $mydata->Gems+= 2;]]></code>
    <created>2009-10-24</created>
    <modified>2012-06-24</modified>
  </card>
  <card id="479">
    <name>Mirror golem</name>
    <class>Common</class>
    <cost>
      <bricks>5</bricks>
      <gems>5</gems>
    </cost>
    <level>10</level>
    <keywords>Illusion,Unliving</keywords>
    <effect><![CDATA[Attack: 5 + N<br />N based on matching card rarity (C-2, U-9, R-16)]]></effect>
    <code><![CDATA[
    $damage = ['Common' => 7, 'Uncommon' => 14, 'Rare' => 21];
    $hisdata->attack($damage[$this->getCard($hisdata->Hand[$cardpos])->getClass()]);
]]></code>
    <created>2009-10-24</created>
    <modified>2012-04-07</modified>
  </card>
  <card id="480">
    <name>Ambush</name>
    <class>Common</class>
    <cost>
      <recruits>4</recruits>
    </cost>
    <modes>8</modes>
    <level>10</level>
    <effect><![CDATA[If targeting self and not New, discard the matching card, else replace a card in hand with self]]></effect>
    <code><![CDATA[
    if (!isset($mynewflags[$cardpos]) and $mode == $cardpos) {
      $this->setCard('his', $cardpos, $this->drawCard($his_deck, $hisdata->Hand, $cardpos, 'drawCardDifferent'));
    }
    else {
      if ($mode == $cardpos) $nextcard = 0;
      else $this->replaceCard('my', $mode, $card->id());
    }
]]></code>
    <created>2009-10-24</created>
    <modified>2011-12-24</modified>
  </card>
  <card id="481">
    <name>Ghost rider</name>
    <class>Common</class>
    <cost>
      <gems>6</gems>
    </cost>
    <level>6</level>
    <keywords>Illusion,Undead,Charge (1)</keywords>
    <effect><![CDATA[If Enemy wall > 20<br />Gems: +3<br />Always:<br />Attack: 7]]></effect>
    <code><![CDATA[
    if ($hisdata->Wall > 20) $mydata->Gems+= 3;
    $hisdata->attack(7);
]]></code>
    <created>2009-10-24</created>
    <modified>2010-12-24</modified>
  </card>
  <card id="482">
    <name>Wicked ritual</name>
    <class>Rare</class>
    <cost>
      <gems>18</gems>
      <recruits>14</recruits>
    </cost>
    <level>9</level>
    <effect><![CDATA[Discard all <b>Titan</b> cards from hand<br />Attack: 30N<br />N = #unique discarded cards]]></effect>
    <code><![CDATA[
    $storage = array();
    for ($i = 1; $i <= 8; $i++) {
      if ($i != $cardpos and $this->getCard($mydata->Hand[$i])->hasKeyword('Titan')) {
        $storage[] = $mydata->Hand[$i];
        $this->setCard('my', $i, $this->drawCard($my_deck, $mydata->Hand, $i, 'drawCardRandom'));
      }
    }
    if (count($storage) > 0) {
      $storage = array_unique($storage);
      $discarded = count($storage);
      $hisdata->attack(30 * $discarded);
    }
]]></code>
    <created>2009-10-24</created>
    <modified>2012-04-07</modified>
  </card>
  <card id="483">
    <name>Mentor</name>
    <class>Uncommon</class>
    <cost>
      <gems>2</gems>
    </cost>
    <level>5</level>
    <keywords>Alliance</keywords>
    <effect><![CDATA[Magic: +1<br />Enemy magic: +1]]></effect>
    <code><![CDATA[$mydata->Magic+= 1; $hisdata->Magic+= 1;]]></code>
    <created>2009-10-24</created>
    <modified>2011-04-24</modified>
  </card>
  <card id="484">
    <name>Treant sapling</name>
    <class>Common</class>
    <cost>
      <recruits>6</recruits>
    </cost>
    <level>7</level>
    <keywords>Nature</keywords>
    <effect><![CDATA[Enemy wall: -6<br />Attack: 5]]></effect>
    <code><![CDATA[$hisdata->Wall-= 6; $hisdata->attack(5);]]></code>
    <created>2009-07-22</created>
    <modified>2009-07-22</modified>
  </card>
  <card id="485">
    <name>Undead cavalry</name>
    <class>Uncommon</class>
    <cost>
      <gems>18</gems>
      <recruits>18</recruits>
    </cost>
    <level>7</level>
    <keywords>Undead,Charge (16)</keywords>
    <effect><![CDATA[Attack: 29]]></effect>
    <code><![CDATA[$hisdata->attack(29);]]></code>
    <created>2009-10-24</created>
    <modified>2009-10-24</modified>
  </card>
  <card id="486">
    <name>Magic sanctuary</name>
    <class>Common</class>
    <level>8</level>
    <effect><![CDATA[Player(s) with lowest gems gains<br />Gems: +6<br />His opponent gains<br />Gems: +2]]></effect>
    <code><![CDATA[
    if ($mydata->Gems < $hisdata->Gems) {
      $mydata->Gems+= 6; $hisdata->Gems+= 2;
    }
    elseif ($hisdata->Gems < $mydata->Gems) {
      $hisdata->Gems+= 6; $mydata->Gems+= 2;
    }
    else {
      $mydata->Gems+= 8; $hisdata->Gems+= 8;
    }
]]></code>
    <created>2009-10-24</created>
    <modified>2010-12-24</modified>
  </card>
  <card id="487">
    <name>Moon shrine</name>
    <class>Uncommon</class>
    <cost>
      <gems>1</gems>
    </cost>
    <level>10</level>
    <effect><![CDATA[Players gain 1 stock for each zero cost card and lose 1 stock for each non zero cost card in their hand]]></effect>
    <code><![CDATA[
    $my_gain = $his_gain = 0;
    for ($i = 1; $i <= 8; $i++) {
      if ($i != $cardpos) {
        if ($this->getCard($mydata->Hand[$i])->getResources() == 0) $my_gain++;
        else $my_gain--;
      }
      if ($this->getCard($hisdata->Hand[$i])->getResources() == 0) $his_gain++;
      else $his_gain--;
    }
    $mydata->addStock($my_gain);
    $hisdata->addStock($his_gain);
]]></code>
    <created>2009-10-24</created>
    <modified>2010-02-27</modified>
  </card>
  <card id="488">
    <name>Gate guardian</name>
    <class>Uncommon</class>
    <cost>
      <bricks>16</bricks>
      <recruits>16</recruits>
    </cost>
    <level>1</level>
    <keywords>Horde</keywords>
    <effect><![CDATA[Attack: 24<br />Wall: +16]]></effect>
    <code><![CDATA[$hisdata->attack(24); $mydata->Wall+= 16;]]></code>
    <created>2009-10-24</created>
    <modified>2015-08-01</modified>
  </card>
  <card id="489">
    <name>Imp cache</name>
    <class>Common</class>
    <cost>
      <bricks>2</bricks>
    </cost>
    <level>4</level>
    <effect><![CDATA[Wall: +4<br />Highest resource: -3<br />Lowest resource: +4]]></effect>
    <code><![CDATA[
    $mydata->Wall+= 4;
    $mydata->addHighestResource(-3);
    $mydata->addLowestResource(4);
]]></code>
    <created>2009-10-24</created>
    <modified>2010-12-24</modified>
  </card>
  <card id="490">
    <name>Magic portal</name>
    <class>Common</class>
    <cost>
      <gems>5</gems>
    </cost>
    <modes>8</modes>
    <level>9</level>
    <effect><![CDATA[Move selected card in hand to current position<br />Summons uncommon card from your deck to selected position]]></effect>
    <code><![CDATA[
    if ($mode != $cardpos) {
      $this->setCard('my', $cardpos, $this->drawCard($my_deck->Uncommon, $mydata->Hand, $mode, 'drawCardList'));
      $mydata->switchCards($cardpos, $mode);
      $nextcard = 0;
    }
    else $nextcard = $this->drawCard($my_deck->Uncommon, $mydata->Hand, $cardpos, 'drawCardList');
]]></code>
    <created>2009-10-24</created>
    <modified>2015-08-01</modified>
  </card>
  <card id="491">
    <name>Dark pegasus</name>
    <class>Uncommon</class>
    <cost>
      <gems>13</gems>
    </cost>
    <level>9</level>
    <keywords>Swift,Aria</keywords>
    <effect><![CDATA[If Wall > Enemy wall<br />Enemy tower: -8<br />else<br />Gems prod x2]]></effect>
    <code><![CDATA[
    if ($mydata->Wall > $hisdata->Wall) $hisdata->Tower-= 8;
    else $production->multiplyGems(2);
]]></code>
    <created>2009-11-16</created>
    <modified>2012-06-24</modified>
  </card>
  <card id="492">
    <name>Lighthouse</name>
    <class>Uncommon</class>
    <cost>
      <bricks>10</bricks>
    </cost>
    <level>10</level>
    <keywords>Far sight</keywords>
    <effect><![CDATA[Tower: +6<br />If matching card is Revealed<br />Tower: +6<br />else<br />Reveal matching card]]></effect>
    <code><![CDATA[$mydata->Tower+= 6; if (!$hidden_cards or isset($hisdata->Revealed[$cardpos])) $mydata->Tower+= 6; else $this->revealCard('his', $cardpos);]]></code>
    <created>2010-01-20</created>
    <modified>2012-06-24</modified>
  </card>
  <card id="493">
    <name>Oracle</name>
    <class>Common</class>
    <cost>
      <gems>1</gems>
    </cost>
    <level>4</level>
    <keywords>Far sight</keywords>
    <effect><![CDATA[Gems: +#revealed cards in opponent's hand (max 4)]]></effect>
    <code><![CDATA[
    $tmp = 0;
    for ($i = 1; $i <= 8; $i++) {
      if (!$hidden_cards or isset($hisdata->Revealed[$i])) {
        $tmp++;
      }
    }
    $tmp = min($tmp, 4); $mydata->Gems+= $tmp;
]]></code>
    <created>2010-01-20</created>
    <modified>2010-06-21</modified>
  </card>
  <card id="494">
    <name>Scepter of evolution</name>
    <class>Uncommon</class>
    <cost>
      <bricks>8</bricks>
      <gems>8</gems>
      <recruits>8</recruits>
    </cost>
    <level>8</level>
    <effect><![CDATA[Replace your hand with 4 commons, 3 uncommons and 1 rare from your deck]]></effect>
    <code><![CDATA[
    $trans = ['Common', 'Common', 'Common', 'Common', 'Uncommon', 'Uncommon', 'Uncommon', 'Rare'];
    shuffle($trans);
    for ($i = 1; $i <= 8; $i++) {
      $this->setCard('my', $i, $this->drawCard($my_deck->$trans[$i-1], $mydata->Hand, $i, 'drawCardList'));
    }
    $nextcard = 0;
]]></code>
    <created>2010-01-20</created>
    <modified>2010-01-20</modified>
  </card>
  <card id="495">
    <name>Globe of Myr</name>
    <class>Rare</class>
    <cost>
      <gems>6</gems>
    </cost>
    <modes>8</modes>
    <level>9</level>
    <keywords>Rebirth</keywords>
    <effect><![CDATA[Replace a card in hand with <b>Swift</b>]]></effect>
    <code><![CDATA[
    $this->setCard('my', $mode, $this->drawCard($this->getList(['keyword'=>'Swift']), $mydata->Hand, $mode, 'drawCardList'));
    if ($mode == $cardpos) $nextcard = 0;
]]></code>
    <created>2010-01-20</created>
    <modified>2013-03-31</modified>
  </card>
  <card id="496">
    <name>Spring wood</name>
    <class>Common</class>
    <cost>
      <recruits>1</recruits>
    </cost>
    <level>10</level>
    <keywords>Nature,Restoration</keywords>
    <effect><![CDATA[Wall: +3<br />If opponent lowered your stock last round<br />Production x2]]></effect>
    <code><![CDATA[
    $mydata->Wall+= 3;
    if ($mychanges['Bricks'] < 0 or $mychanges['Gems'] < 0 or $mychanges['Recruits'] < 0) {
      $production->multiply(2);
    }
]]></code>
    <created>2010-01-20</created>
    <modified>2010-01-20</modified>
  </card>
  <card id="497">
    <name>Elemental storm</name>
    <class>Uncommon</class>
    <cost>
      <gems>13</gems>
    </cost>
    <level>10</level>
    <keywords>Destruction</keywords>
    <effect><![CDATA[Replace matching card in opponent's hand and its neigbouring cards with Wind]]></effect>
    <code><![CDATA[
    $this->setCard('his', $cardpos, 247, ['reveal' => true]);
    if ($cardpos > 1) {
      $this->setCard('his', $cardpos - 1, 247, ['reveal' => true]);
    }
    if ($cardpos < 8) {
      $this->setCard('his', $cardpos + 1, 247, ['reveal' => true]);
    }
]]></code>
    <created>2010-01-20</created>
    <modified>2015-09-26</modified>
  </card>
  <card id="498">
    <name>Thief hideout</name>
    <class>Uncommon</class>
    <cost>
      <bricks>20</bricks>
    </cost>
    <level>2</level>
    <effect><![CDATA[Tower: +10<br />Wall: +15<br />Enemy stock: -3]]></effect>
    <code><![CDATA[
    $mydata->Tower+= 10; $mydata->Wall+= 15;
    $hisdata->addStock(-3);
]]></code>
    <created>2010-01-20</created>
    <modified>2010-01-20</modified>
  </card>
  <card id="499">
    <name>Citadel of Myr</name>
    <class>Rare</class>
    <cost>
      <gems>38</gems>
    </cost>
    <level>1</level>
    <effect><![CDATA[Tower x2]]></effect>
    <code><![CDATA[$mydata->Tower*= 2;]]></code>
    <created>2010-01-20</created>
    <modified>2010-01-20</modified>
  </card>
  <card id="500">
    <name>Forest dragon</name>
    <class>Rare</class>
    <cost>
      <recruits>30</recruits>
    </cost>
    <level>9</level>
    <keywords>Dragon,Nature</keywords>
    <effect><![CDATA[Attack: 15 + 7N<br />N = #<b>Nature</b> in game]]></effect>
    <code><![CDATA[$hisdata->attack(15 + 7 * ($this->keywordCount($mydata->Hand, 'Nature') + $this->keywordCount($hisdata->Hand, 'Nature')));]]></code>
    <created>2010-01-20</created>
    <modified>2012-09-08</modified>
  </card>
  <card id="501">
    <name>Secret temple</name>
    <class>Common</class>
    <cost>
      <bricks>4</bricks>
    </cost>
    <modes>3</modes>
    <level>4</level>
    <effect><![CDATA[Mode1:<br />Wall: +6<br />Mode2:<br />Gems: +4<br />Mode3:<br />Enemy recruits: -3]]></effect>
    <code><![CDATA[
    if ($mode == 1) $mydata->Wall+= 6;
    elseif ($mode == 2) $mydata->Gems+= 4;
    elseif ($mode == 3) $hisdata->Recruits-= 3;
]]></code>
    <created>2010-01-20</created>
    <modified>2010-01-20</modified>
  </card>
  <card id="502">
    <name>Orc brute</name>
    <class>Common</class>
    <cost>
      <recruits>5</recruits>
    </cost>
    <level>6</level>
    <keywords>Horde,Siege</keywords>
    <effect><![CDATA[Enemy tower: -3<br />Enemy wall: -4]]></effect>
    <code><![CDATA[$hisdata->Tower-= 3; $hisdata->Wall-= 4;]]></code>
    <created>2010-01-20</created>
    <modified>2011-12-24</modified>
  </card>
  <card id="503">
    <name>Temple guard</name>
    <class>Common</class>
    <cost>
      <recruits>6</recruits>
    </cost>
    <level>8</level>
    <keywords>Holy,Soldier</keywords>
    <effect><![CDATA[Wall: +5<br />If #<b>Holy</b> in hand > 1<br />Tower: +3<br />If #<b>Soldier</b> in hand > 1<br />Attack: 5]]></effect>
    <code><![CDATA[
    $mydata->Wall+= 5;
    if ($this->keywordCount($mydata->Hand, 'Holy') > 1) $mydata->Tower+= 3;
    if ($this->keywordCount($mydata->Hand, 'Soldier') > 1) $hisdata->attack(5);
]]></code>
    <created>2010-01-20</created>
    <modified>2010-01-20</modified>
  </card>
  <card id="504">
    <name>Piranhas</name>
    <class>Common</class>
    <level>7</level>
    <keywords>Aqua,Skirmisher</keywords>
    <effect><![CDATA[Attack: 1<br />If New<br />Attack: 4]]></effect>
    <code><![CDATA[$hisdata->attack(((isset($mynewflags[$cardpos])) ? 5 : 1));]]></code>
    <created>2010-01-20</created>
    <modified>2010-12-24</modified>
  </card>
  <card id="505">
    <name>Kraken</name>
    <class>Uncommon</class>
    <cost>
      <recruits>25</recruits>
    </cost>
    <level>6</level>
    <keywords>Aqua</keywords>
    <effect><![CDATA[Attack: 25<br />Enemy highest facility: -1]]></effect>
    <code><![CDATA[$hisdata->attack(25); $hisdata->addHighestFacility(-1);]]></code>
    <created>2010-01-20</created>
    <modified>2010-03-14</modified>
  </card>
  <card id="506">
    <name>Water dragon</name>
    <class>Rare</class>
    <cost>
      <gems>30</gems>
    </cost>
    <level>0</level>
    <keywords>Aqua,Dragon</keywords>
    <effect><![CDATA[Attack: 40<br />Stock: +10]]></effect>
    <code><![CDATA[$hisdata->attack(40); $mydata->addStock(10);]]></code>
    <created>2010-01-20</created>
    <modified>2010-03-14</modified>
  </card>
  <card id="507">
    <name>Sea lord</name>
    <class>Uncommon</class>
    <cost>
      <gems>20</gems>
      <recruits>20</recruits>
    </cost>
    <level>3</level>
    <keywords>Aqua,Far sight</keywords>
    <effect><![CDATA[Attack: 20<br />Gems: +15<br />Recruits: +15]]></effect>
    <code><![CDATA[
    $hisdata->attack(20);
    $mydata->Gems+= 15; $mydata->Recruits+= 15;
]]></code>
    <created>2010-01-20</created>
    <modified>2010-06-21</modified>
  </card>
  <card id="508">
    <name>Javeliner</name>
    <class>Common</class>
    <cost>
      <recruits>7</recruits>
    </cost>
    <level>10</level>
    <effect><![CDATA[Enemy tower: -N<br />N = 2 + #Enemy tower / 10]]></effect>
    <code><![CDATA[$hisdata->Tower-= round($hisdata->Tower / 10) + 2;]]></code>
    <created>2010-01-20</created>
    <modified>2013-12-24</modified>
  </card>
  <card id="509">
    <name>Breeze</name>
    <class>Common</class>
    <level>10</level>
    <keywords>Aria</keywords>
    <effect><![CDATA[Gain 1 random resource for each New card in game]]></effect>
    <code><![CDATA[
    $count = 0;
    for ($i = 1; $i <= 8; $i++) {
      if (isset($mynewflags[$i])) $count++;
      if (isset($hisnewflags[$i])) $count++;
    }
    $mydata->addRandomResources($count);
]]></code>
    <created>2010-01-20</created>
    <modified>2012-06-24</modified>
  </card>
  <card id="510">
    <name>Master hunter</name>
    <class>Uncommon</class>
    <cost>
      <recruits>13</recruits>
    </cost>
    <level>10</level>
    <keywords>Far sight,Banish</keywords>
    <effect><![CDATA[Attack: 13<br />Discard highest cost Recruits only card from opponent's hand]]></effect>
    <code><![CDATA[$hisdata->attack(13);
    $card_costs = $max_cards = array(); $max = 0;
    for ($i = 1; $i <= 8; $i++) {
      $cur_card = $this->getCard($hisdata->Hand[$i]);
      if ($cur_card->getResources('Bricks') == 0 and $cur_card->getResources('Gems') == 0 and $cur_card->getResources('Recruits') > 0) {
        $cur_cost = $card_costs[$i] = $cur_card->getResources('Recruits');
        if ($cur_cost > $max) $max = $cur_cost;
      }
    }
    if (count($card_costs) > 0) {
      foreach ($card_costs as $i => $cost) if ($cost == $max) $max_cards[] = $i;
      $dis_pos = $max_cards[$this->arrayRand($max_cards)];
      $this->setCard('his', $dis_pos, $this->drawCard($his_deck, $hisdata->Hand, $dis_pos, 'drawCardDifferent'));
    }
]]></code>
    <created>2010-01-20</created>
    <modified>2012-06-24</modified>
  </card>
  <card id="511">
    <name>Farm</name>
    <class>Common</class>
    <cost>
      <bricks>2</bricks>
      <recruits>2</recruits>
    </cost>
    <level>5</level>
    <effect><![CDATA[Tower: +2<br />Wall: +2<br />If last card was discarded<br />Stock: +4]]></effect>
    <code><![CDATA[
    $mydata->Tower+= 2; $mydata->Wall+= 2;
    if ($mylast_action == 'discard') {
      $mydata->addStock(4);
    }
]]></code>
    <created>2010-01-20</created>
    <modified>2010-12-24</modified>
  </card>
  <card id="512">
    <name>Reinforced gate</name>
    <class>Common</class>
    <cost>
      <bricks>7</bricks>
    </cost>
    <level>7</level>
    <effect><![CDATA[Wall: +12<br />If Wall > 30<br />Tower: -2]]></effect>
    <code><![CDATA[$mydata->Wall+= 12; if ($mydata->Wall > 30) $mydata->Tower-= 2;]]></code>
    <created>2010-03-14</created>
    <modified>2013-10-19</modified>
  </card>
  <card id="513">
    <name>Veteran militia</name>
    <class>Uncommon</class>
    <cost>
      <recruits>5</recruits>
    </cost>
    <modes>8</modes>
    <level>5</level>
    <keywords>Quick</keywords>
    <effect><![CDATA[Replace a card in hand with a card from your deck of the same rarity (can't summon self)]]></effect>
    <code><![CDATA[
    $class = $this->getCard($mydata->Hand[$mode])->getClass();
    $this->setCard('my', $mode, $this->drawCard(array_diff($my_deck->$class, [$card->id(), $mydata->Hand[$mode]]), $mydata->Hand, $mode, 'drawCardList'));
    if ($mode == $cardpos) $nextcard = 0;
]]></code>
    <created>2010-03-14</created>
    <modified>2014-12-24</modified>
  </card>
  <card id="514">
    <name>Firestorm</name>
    <class>Uncommon</class>
    <cost>
      <gems>24</gems>
    </cost>
    <level>10</level>
    <keywords>Burning,Destruction</keywords>
    <effect><![CDATA[Player(s) with fewest <b>Burning</b> cards gains<br />Stock: -7<br />Respective player suffers 1 damage for each resource lost]]></effect>
    <code><![CDATA[
    $my_count = $this->keywordCount($mydata->Hand, 'Burning');
    $his_count = $this->keywordCount($hisdata->Hand, 'Burning');
    $res = ['Bricks', 'Gems', 'Recruits'];
    $my_dmg = $his_dmg = 0;
    if ($my_count <= $his_count) {
      foreach ($res as $resource) {
        $lowered = $mydata->$resource - max($mydata->$resource - 7, 0);
        $mydata->$resource-= $lowered;
        $my_dmg+= $lowered;
      }
    }
    if ($my_count >= $his_count) {
      foreach ($res as $resource) {
        $lowered = $hisdata->$resource - max($hisdata->$resource - 7, 0);
        $hisdata->$resource-= $lowered;
        $his_dmg+= $lowered;
      }
    }
    if ($my_dmg > 0) $mydata->attack($my_dmg);
    if ($his_dmg > 0) $hisdata->attack($his_dmg);
]]></code>
    <created>2010-03-14</created>
    <modified>2012-09-08</modified>
  </card>
  <card id="515">
    <name>Koschei the Deathless</name>
    <class>Rare</class>
    <cost>
      <recruits>17</recruits>
    </cost>
    <level>5</level>
    <keywords>Legend,Undead,Durable</keywords>
    <effect><![CDATA[Attack: 20]]></effect>
    <code><![CDATA[$hisdata->attack(20);]]></code>
    <created>2010-03-14</created>
    <modified>2012-09-08</modified>
  </card>
  <card id="516">
    <name>Frozen flame</name>
    <class>Common</class>
    <cost>
      <gems>1</gems>
    </cost>
    <level>10</level>
    <keywords>Burning</keywords>
    <effect><![CDATA[If last card played was <b>Burning</b><br />Returns half of its cost (max 5)]]></effect>
    <code><![CDATA[
    if ($mylast_card->hasKeyword('Burning') and $mylast_action == 'play') {
      $mydata->Bricks+= min(round($mylast_card->getResources('Bricks') / 2), 5);
      $mydata->Gems+= min(round($mylast_card->getResources('Gems') / 2), 5);
      $mydata->Recruits+= min(round($mylast_card->getResources('Recruits') / 2), 5);
    }
]]></code>
    <created>2010-03-14</created>
    <modified>2010-03-14</modified>
  </card>
  <card id="517">
    <name>Cockatrice</name>
    <class>Rare</class>
    <cost>
      <recruits>25</recruits>
    </cost>
    <level>4</level>
    <keywords>Beast</keywords>
    <effect><![CDATA[Attack: 20<br />Bricks: +N<br />N = #Enemy recruits / 2<br />Enemy recruits: = 0]]></effect>
    <code><![CDATA[
    $hisdata->attack(20);
    $mydata->Bricks+= round($hisdata->Recruits / 2); $hisdata->Recruits = 0;
]]></code>
    <created>2010-03-14</created>
    <modified>2010-03-14</modified>
  </card>
  <card id="518">
    <name>Thieves guild</name>
    <class>Common</class>
    <cost>
      <bricks>5</bricks>
      <recruits>2</recruits>
    </cost>
    <level>3</level>
    <effect><![CDATA[Tower: +3<br />Enemy stock: -1<br />Summons a <b>Brigand</b>]]></effect>
    <code><![CDATA[
    $mydata->Tower+= 3;
    $hisdata->addStock(-1);
    $nextcard = $this->drawCard($this->getList(['keyword'=>'Brigand']), $mydata->Hand, $cardpos, 'drawCardList');
]]></code>
    <created>2010-03-14</created>
    <modified>2010-03-14</modified>
  </card>
  <card id="519">
    <name>Lake fairy</name>
    <class>Common</class>
    <cost>
      <gems>1</gems>
    </cost>
    <modes>8</modes>
    <level>10</level>
    <keywords>Nature</keywords>
    <effect><![CDATA[Gems: +N<br />N = #<b>Nature</b> in hand (max 4)<br />Replace a card in hand with common <b>Nature</b>]]></effect>
    <code><![CDATA[
    $mydata->Gems+= min($this->keywordCount($mydata->Hand, 'Nature'), 4);
    $this->setCard('my', $mode, $this->drawCard($this->getList(['class'=>'Common', 'keyword'=>'Nature']), $mydata->Hand, $mode, 'drawCardList'));
    if ($mode == $cardpos) $nextcard = 0;
]]></code>
    <created>2010-03-14</created>
    <modified>2011-04-24</modified>
  </card>
  <card id="520">
    <name>Desert outpost</name>
    <class>Uncommon</class>
    <cost>
      <bricks>18</bricks>
    </cost>
    <level>1</level>
    <effect><![CDATA[Tower: +5<br />Wall: +10<br />Gems: +5<br />Recruits: +5]]></effect>
    <code><![CDATA[
    $mydata->Tower+= 5; $mydata->Wall+= 10;
    $mydata->Gems+= 5; $mydata->Recruits+= 5;
]]></code>
    <created>2010-03-14</created>
    <modified>2012-09-08</modified>
  </card>
  <card id="521">
    <name>Mermaid</name>
    <class>Common</class>
    <cost>
      <recruits>5</recruits>
    </cost>
    <level>7</level>
    <keywords>Aqua</keywords>
    <effect><![CDATA[Enemy tower: -2<br />Enemy wall: -2<br />Enemy stock: -2]]></effect>
    <code><![CDATA[
    $hisdata->Tower-= 2; $hisdata->Wall-= 2;
    $hisdata->addStock(-2);
]]></code>
    <created>2010-03-14</created>
    <modified>2010-03-14</modified>
  </card>
  <card id="522">
    <name>Sunken ruins</name>
    <class>Common</class>
    <cost>
      <bricks>3B</bricks>
    </cost>
    <level>10</level>
    <keywords>Aqua</keywords>
    <effect><![CDATA[Tower: +N / 2<br />Wall: +N<br />N = #<b>Aqua</b> in hand]]></effect>
    <code><![CDATA[
    $tmp = $this->keywordCount($mydata->Hand, 'Aqua');
    $mydata->Tower+= round($tmp / 2); $mydata->Wall+= $tmp;
]]></code>
    <created>2010-03-14</created>
    <modified>2010-03-14</modified>
  </card>
  <card id="523">
    <name>Whale</name>
    <class>Uncommon</class>
    <cost>
      <recruits>30</recruits>
    </cost>
    <level>8</level>
    <keywords>Aqua</keywords>
    <effect><![CDATA[Enemy tower: -10<br />Enemy wall: -10<br />Enemy stock: -10]]></effect>
    <code><![CDATA[
    $hisdata->Tower-= 10; $hisdata->Wall-= 10;
    $hisdata->addStock(-10);
]]></code>
    <created>2010-03-14</created>
    <modified>2010-03-14</modified>
  </card>
  <card id="524">
    <name>Sea serpent</name>
    <class>Common</class>
    <cost>
      <gems>5</gems>
      <recruits>5</recruits>
    </cost>
    <level>7</level>
    <keywords>Aqua,Siege</keywords>
    <effect><![CDATA[If Enemy wall = 0<br />Enemy stock: -7<br />else<br />Enemy tower: -3<br />Enemy wall: -7]]></effect>
    <code><![CDATA[
    if ($hisdata->Wall == 0) {
      $hisdata->addStock(-7);
    }
    else {
      $hisdata->Tower-= 3; $hisdata->Wall-= 7;
    }
]]></code>
    <created>2010-03-14</created>
    <modified>2011-04-24</modified>
  </card>
  <card id="525">
    <name>Poseidon's wrath</name>
    <class>Uncommon</class>
    <cost>
      <gems>30</gems>
    </cost>
    <level>10</level>
    <keywords>Destruction</keywords>
    <effect><![CDATA[Player(s) with fewest <b>Aqua</b> in hand suffers<br />Tower: -15<br />Wall: -15<br />Stock: -10]]></effect>
    <code><![CDATA[
    $my_count = $this->keywordCount($mydata->Hand, 'Aqua');
    $his_count = $this->keywordCount($hisdata->Hand, 'Aqua');
    if ($my_count <= $his_count) {
      $mydata->Tower-= 15;
      $mydata->Wall-= 15;
      $mydata->addStock(-10);
    }
    if ($my_count >= $his_count) {
      $hisdata->Tower-= 15;
      $hisdata->Wall-= 15;
      $hisdata->addStock(-10);
    }
]]></code>
    <created>2010-03-14</created>
    <modified>2012-04-07</modified>
  </card>
  <card id="526">
    <name>Princess of elves</name>
    <class>Rare</class>
    <cost>
      <gems>5</gems>
    </cost>
    <level>10</level>
    <keywords>Alliance</keywords>
    <effect><![CDATA[Stock: +5<br />Summons a rare card from opponent's deck]]></effect>
    <code><![CDATA[
    $mydata->addStock(5);
    $nextcard = $this->drawCard($his_deck->Rare, $mydata->Hand, $cardpos, 'drawCardList');
]]></code>
    <created>2010-03-14</created>
    <modified>2010-09-10</modified>
  </card>
  <card id="527">
    <name>Elven priestesses</name>
    <class>Common</class>
    <level>7</level>
    <keywords>Alliance,Holy</keywords>
    <effect><![CDATA[Lowest facility prod x2]]></effect>
    <code><![CDATA[$production->multiply(2, $mydata->detectLowestFacility());]]></code>
    <created>2010-03-14</created>
    <modified>2011-01-24</modified>
  </card>
  <card id="528">
    <name>Legacy of Barbz</name>
    <class>Uncommon</class>
    <level>10</level>
    <effect><![CDATA[Replace a common card in hand of player(s) with most common cards with a rare card from his deck]]></effect>
    <code><![CDATA[
    $my_storage = $his_storage = array();
    for ($i = 1; $i <= 8; $i++) {
      if ($this->getCard($mydata->Hand[$i])->getClass() == 'Common') $my_storage[] = $i;
      if ($this->getCard($hisdata->Hand[$i])->getClass() == 'Common') $his_storage[] = $i;
    }
    if (count($my_storage) > 0 and count($my_storage) >= count($his_storage)) {
      $pos = $my_storage[$this->arrayRand($my_storage)];
      $this->setCard('my', $pos, $this->drawCard($my_deck->Rare, $mydata->Hand, $pos, 'drawCardList'));
    }
    if (count($his_storage) > 0 and count($my_storage) <= count($his_storage)) {
      $pos = $his_storage[$this->arrayRand($his_storage)];
      $this->setCard('his', $pos, $this->drawCard($his_deck->Rare, $hisdata->Hand, $pos, 'drawCardList'));
    }
]]></code>
    <created>2010-03-14</created>
    <modified>2011-01-24</modified>
  </card>
  <card id="529">
    <name>Waterfall</name>
    <class>Common</class>
    <cost>
      <gems>1</gems>
    </cost>
    <level>1</level>
    <keywords>Aqua</keywords>
    <effect><![CDATA[Wall: -5<br />Stock: +3]]></effect>
    <code><![CDATA[$mydata->Wall-= 5; $mydata->addStock(3);]]></code>
    <created>2010-03-14</created>
    <modified>2010-03-14</modified>
  </card>
  <card id="530">
    <name>Ocean queen</name>
    <class>Rare</class>
    <cost>
      <gems>20</gems>
      <recruits>20</recruits>
    </cost>
    <level>7</level>
    <keywords>Aqua</keywords>
    <effect><![CDATA[Attack: 40<br />If last card played was an <b>Aqua</b><br />Bonus attack based on card rarity (C-10, U-25, R-50)]]></effect>
    <code><![CDATA[
    if ($mylast_card->hasKeyword('Aqua') and $mylast_action == 'play') {
      $dmg = ['Common' => 10, 'Uncommon' => 25, 'Rare' => 50];
      $bonus = $dmg[$mylast_card->getClass()];
    }
    else $bonus = 0;
    $hisdata->attack(40 + $bonus);
]]></code>
    <created>2010-03-14</created>
    <modified>2010-03-14</modified>
  </card>
  <card id="531">
    <name>Exiled</name>
    <class>Common</class>
    <cost>
      <recruits>5</recruits>
    </cost>
    <level>9</level>
    <keywords>Aqua,Brigand</keywords>
    <effect><![CDATA[Attack: 7<br />If #<b>Aqua</b> in opponent's hand > 0<br />Enemy stock: -3]]></effect>
    <code><![CDATA[
    $hisdata->attack(7);
    $tmp = $this->keywordCount($hisdata->Hand, 'Aqua');
    if ($tmp > 0) {
      $hisdata->addStock(-3);
    }
]]></code>
    <created>2010-03-14</created>
    <modified>2010-03-14</modified>
  </card>
  <card id="532">
    <name>Pixie</name>
    <class>Common</class>
    <cost>
      <gems>1</gems>
    </cost>
    <level>10</level>
    <effect><![CDATA[Stock: +N/2 - 1<br />N = #common cards in hand]]></effect>
    <code><![CDATA[
    $tmp = 0;
    for ($i = 1; $i <= 8; $i++) {
      if ($this->getCard($mydata->Hand[$i])->getClass() == 'Common') {
        $tmp++;
      }
    }
    $mydata->addStock(max(round($tmp / 2) - 1, 0));
]]></code>
    <created>2010-03-14</created>
    <modified>2012-04-07</modified>
  </card>
  <card id="533">
    <name>Chaos gargoyle</name>
    <class>Common</class>
    <cost>
      <bricks>6</bricks>
    </cost>
    <level>10</level>
    <keywords>Unliving,Durable</keywords>
    <effect><![CDATA[Attack: 5<br />Discard a common card from hand<br />If discarded card wasn't <b>Unliving</b><br />Wall: +5]]></effect>
    <code><![CDATA[
    $hisdata->attack(5);
    $storage = array();
    for ($i = 1; $i <= 8; $i++) {
      if ($i != $cardpos and $this->getCard($mydata->Hand[$i])->getClass() == 'Common') {
        $storage[] = $i;
      }
    }
    if (count($storage) > 0) {
      $dis_index = $storage[$this->arrayRand($storage)];
      if (!$this->getCard($mydata->Hand[$dis_index])->hasKeyword('Unliving')) $mydata->Wall+= 5;
      $this->setCard('my', $dis_index, $this->drawCard($my_deck, $mydata->Hand, $dis_index, 'drawCardRandom'));
    }
]]></code>
    <created>2010-06-21</created>
    <modified>2012-12-24</modified>
  </card>
  <card id="534">
    <name>Sniper</name>
    <class>Common</class>
    <cost>
      <recruits>6</recruits>
    </cost>
    <level>10</level>
    <keywords>Soldier,Far sight</keywords>
    <effect><![CDATA[Attack: 6<br />If #<b>Quick</b> + #<b>Swift</b> in opponent's hand > 0<br />Enemy tower: -6]]></effect>
    <code><![CDATA[
    $hisdata->attack(6);
    if ($this->keywordCount($hisdata->Hand, 'Quick') > 0 or $this->keywordCount($hisdata->Hand, 'Swift') > 0) {
      $hisdata->Tower-= 6;
    }
]]></code>
    <created>2010-06-21</created>
    <modified>2010-09-10</modified>
  </card>
  <card id="535">
    <name>Urk the Conqueror</name>
    <class>Rare</class>
    <cost>
      <recruits>30</recruits>
    </cost>
    <level>7</level>
    <keywords>Barbarian,Durable,Banish</keywords>
    <effect><![CDATA[If last card played was a non-common <b>Barbarian</b><br />Enemy wall: -20<br />Always:<br />Attack: 35]]></effect>
    <code><![CDATA[
    if ($mylast_card->hasKeyword('Barbarian') and $mylast_action == 'play' and $mylast_card->getClass() != 'Common') {
      $hisdata->Wall-= 20;
    }
    $hisdata->attack(35);
]]></code>
    <created>2010-06-21</created>
    <modified>2010-11-01</modified>
  </card>
  <card id="536">
    <name>Rage of Urk</name>
    <class>Rare</class>
    <cost>
      <recruits>18</recruits>
    </cost>
    <level>5</level>
    <keywords>Barbarian,Frenzy</keywords>
    <effect><![CDATA[If New<br />Enemy wall: -13<br />Always:<br />Attack: 22]]></effect>
    <code><![CDATA[
    if (isset($mynewflags[$cardpos])) $hisdata->Wall-= 13;
    $hisdata->attack(22);
]]></code>
    <created>2010-06-21</created>
    <modified>2010-06-21</modified>
  </card>
  <card id="537">
    <name>Minaret</name>
    <class>Common</class>
    <cost>
      <bricks>5</bricks>
    </cost>
    <level>9</level>
    <effect><![CDATA[Player(s) with fewest different keywords in hand gains<br />Tower: +10]]></effect>
    <code><![CDATA[
    $mine = $this->countDistinctKeywords($mydata->Hand);
    $his = $this->countDistinctKeywords($hisdata->Hand);
    if ($mine <= $his) $mydata->Tower+= 10;
    if ($mine >= $his) $hisdata->Tower+= 10;
]]></code>
    <created>2010-06-21</created>
    <modified>2013-10-19</modified>
  </card>
  <card id="538">
    <name>Forest guardian</name>
    <class>Common</class>
    <cost>
      <recruits>5</recruits>
    </cost>
    <level>9</level>
    <keywords>Beast,Nature</keywords>
    <effect><![CDATA[Attack: #<b>Beast</b> + #<b>Nature</b> in hand (min 6)]]></effect>
    <code><![CDATA[
    $tmp = $this->keywordCount($mydata->Hand, 'Beast') + $this->keywordCount($mydata->Hand, 'Nature');
    $hisdata->attack(max(6, $tmp));
]]></code>
    <created>2010-06-21</created>
    <modified>2013-07-27</modified>
  </card>
  <card id="539">
    <name>Book of life</name>
    <class>Common</class>
    <cost>
      <recruits>4</recruits>
    </cost>
    <level>9</level>
    <keywords>Nature</keywords>
    <effect><![CDATA[Summons a <b>Beast</b> or a <b>Nature</b><br />If New<br />non-common<br />else<br />non-rare]]></effect>
    <code><![CDATA[
    $tmp = (isset($mynewflags[$cardpos])) ? 'Rare' : 'Common';
    $uncommon_b = $this->getList(['class'=>'Uncommon', 'keyword'=>'Beast']);
    $other_b = $this->getList(['class'=>$tmp, 'keyword'=>'Beast']);
    $uncommon_n = $this->getList(['class'=>'Uncommon', 'keyword'=>'Nature']);
    $other_n = $this->getList(['class'=>$tmp, 'keyword'=>'Nature']);
    $nextcard = $this->drawCard(array_unique(array_merge($uncommon_b, $other_b, $uncommon_n, $other_n)), $mydata->Hand, $cardpos, 'drawCardList');
]]></code>
    <created>2010-06-21</created>
    <modified>2010-06-21</modified>
  </card>
  <card id="540">
    <name>White lady</name>
    <class>Common</class>
    <level>7</level>
    <effect><![CDATA[Player(s) with highest tower gains<br />Stock: +2]]></effect>
    <code><![CDATA[
    if ($mydata->Tower >= $hisdata->Tower) {
      $mydata->addStock(2);
    }
    if ($mydata->Tower <= $hisdata->Tower) {
      $hisdata->addStock(2);
    }
]]></code>
    <created>2010-06-21</created>
    <modified>2013-10-19</modified>
  </card>
  <card id="541">
    <name>Forest spirit</name>
    <class>Uncommon</class>
    <cost>
      <recruits>15</recruits>
    </cost>
    <level>10</level>
    <keywords>Beast,Nature</keywords>
    <effect><![CDATA[Attack: 12 + N<br />Wall: +2N<br />N = #<b>Beast</b> + #<b>Nature</b> in hand]]></effect>
    <code><![CDATA[
    $tmp = $this->keywordCount($mydata->Hand, 'Beast') + $this->keywordCount($mydata->Hand, 'Nature');
    $hisdata->attack(12 + $tmp); $mydata->Wall+= 2 * $tmp;
]]></code>
    <created>2010-06-21</created>
    <modified>2010-06-21</modified>
  </card>
  <card id="542">
    <name>Seth</name>
    <class>Rare</class>
    <cost>
      <gems>15</gems>
      <recruits>15</recruits>
    </cost>
    <modes>3</modes>
    <level>0</level>
    <keywords>Destruction</keywords>
    <effect><![CDATA[Mode1:<br />Enemy tower: -20<br />Mode2:<br />Enemy wall: -50<br />Mode3:<br />Enemy stock: -15]]></effect>
    <code><![CDATA[
    if ($mode == 1) $hisdata->Tower-=20;
    elseif ($mode == 2) $hisdata->Wall-= 50;
    elseif ($mode == 3) $hisdata->addStock(-15);
]]></code>
    <created>2010-06-21</created>
    <modified>2010-06-21</modified>
  </card>
  <card id="543">
    <name>Deathwood shaman</name>
    <class>Uncommon</class>
    <cost>
      <gems>12</gems>
      <recruits>13</recruits>
    </cost>
    <level>10</level>
    <keywords>Nature,Undead</keywords>
    <effect><![CDATA[Stock: +2N<br />Enemy wall: -5M<br />N = #<b>Nature</b> in hand<br />M = #<b>Undead</b> in hand]]></effect>
    <code><![CDATA[
    $tmp = $this->keywordCount($mydata->Hand, 'Undead');
    $hisdata->Wall-= 5 * $tmp;
    $tmp = $this->keywordCount($mydata->Hand, 'Nature');
    $mydata->addStock(2 * $tmp);
]]></code>
    <created>2010-06-21</created>
    <modified>2012-09-08</modified>
  </card>
  <card id="544">
    <name>Black unicorn</name>
    <class>Uncommon</class>
    <cost>
      <recruits>16</recruits>
    </cost>
    <level>8</level>
    <keywords>Legend,Banish</keywords>
    <effect><![CDATA[If #rare cards in hand > 0<br />Attack: 15<br />else<br />Attack: 25]]></effect>
    <code><![CDATA[
    $found = false;
    for ($i = 1; $i <= 8; $i++) {
      if ($this->getCard($mydata->Hand[$i])->getClass() == 'Rare') {
        $found = true;
      }
    }
    $hisdata->attack(((!$found) ? 25 : 15));
]]></code>
    <created>2010-06-21</created>
    <modified>2010-11-01</modified>
  </card>
  <card id="545">
    <name>Elven marksman</name>
    <class>Common</class>
    <cost>
      <recruits>6</recruits>
    </cost>
    <level>8</level>
    <keywords>Alliance</keywords>
    <effect><![CDATA[Gems prod x2<br />Enemy tower: -N<br />Attack: 8 - N<br />N = #<b>Alliance</b> in hand]]></effect>
    <code><![CDATA[
    $production->multiplyGems(2);
    $tmp = $this->keywordCount($mydata->Hand, 'Alliance');
    $hisdata->Tower-= $tmp;
    if ($tmp < 8) $hisdata->attack(8 - $tmp);
]]></code>
    <created>2010-06-21</created>
    <modified>2011-12-24</modified>
  </card>
  <card id="546">
    <name>Dwarven elder</name>
    <class>Rare</class>
    <cost>
      <bricks>12</bricks>
      <gems>12</gems>
      <recruits>12</recruits>
    </cost>
    <level>9</level>
    <keywords>Runic</keywords>
    <effect><![CDATA[Attack: N<br />Wall: +3N<br />N = sum of all facilities in game]]></effect>
    <code><![CDATA[
    $facilities = $mydata->Quarry + $mydata->Magic + $mydata->Dungeons + $hisdata->Quarry + $hisdata->Magic + $hisdata->Dungeons;
    $hisdata->attack($facilities);
    $mydata->Wall+= 3 * $facilities;
]]></code>
    <created>2010-06-21</created>
    <modified>2011-04-24</modified>
  </card>
  <card id="547">
    <name>Flame lord</name>
    <class>Rare</class>
    <cost>
      <gems>15</gems>
    </cost>
    <level>4</level>
    <keywords>Burning,Far sight</keywords>
    <effect><![CDATA[Attack: 25<br />Summons Eternal flame]]></effect>
    <code><![CDATA[$hisdata->attack(25); $nextcard = 336;]]></code>
    <created>2010-06-21</created>
    <modified>2010-06-21</modified>
  </card>
  <card id="548">
    <name>War wolf</name>
    <class>Common</class>
    <cost>
      <recruits>10</recruits>
    </cost>
    <level>7</level>
    <keywords>Beast,Horde</keywords>
    <effect><![CDATA[Attack: 8<br />Recruits: +6]]></effect>
    <code><![CDATA[$hisdata->attack(8); $mydata->Recruits+= 6;]]></code>
    <created>2010-06-21</created>
    <modified>2011-12-24</modified>
  </card>
  <card id="549">
    <name>Goblin regiment</name>
    <class>Uncommon</class>
    <cost>
      <recruits>23</recruits>
    </cost>
    <level>10</level>
    <keywords>Horde</keywords>
    <effect><![CDATA[Attack: 30<br />Replace all common cards in hand with Goblin flankers<br />Recruits: +2N<br />N = #replaced cards]]></effect>
    <code><![CDATA[
    $hisdata->attack(30); $tmp = 0;
    for ($i = 1; $i <= 8; $i++) {
      if ($i != $cardpos and $this->getCard($mydata->Hand[$i])->getClass() == 'Common') {
        $this->setCard('my', $i, 13, ['reveal' => true]); $tmp++;
      }
    }
    $mydata->Recruits+= $tmp * 2;
]]></code>
    <created>2010-06-21</created>
    <modified>2015-09-26</modified>
  </card>
  <card id="550">
    <name>Sea priestess</name>
    <class>Common</class>
    <cost>
      <gems>1</gems>
    </cost>
    <level>10</level>
    <keywords>Aqua,Restoration</keywords>
    <effect><![CDATA[Summons an <b>Aqua</b><br />If last card played was an <b>Aqua</b><br />Stock: +1]]></effect>
    <code><![CDATA[
    $nextcard = $this->drawCard($this->getList(['keyword'=>'Aqua']), $mydata->Hand, $cardpos, 'drawCardList');
    if ($mylast_card->hasKeyword('Aqua') and $mylast_action == 'play') {
      $mydata->addStock(1);
    }
]]></code>
    <created>2010-06-21</created>
    <modified>2010-06-21</modified>
  </card>
  <card id="551">
    <name>Spectral siren</name>
    <class>Uncommon</class>
    <cost>
      <gems>12</gems>
    </cost>
    <level>7</level>
    <keywords>Aqua,Undead</keywords>
    <effect><![CDATA[Attack: 12<br />Enemy recruits: -2N<br />N = #<b>Aqua</b> in hand]]></effect>
    <code><![CDATA[
    $hisdata->attack(12);
    $tmp = $this->keywordCount($mydata->Hand, 'Aqua');
    $hisdata->Recruits-= 2 * $tmp;
]]></code>
    <created>2010-06-21</created>
    <modified>2010-06-21</modified>
  </card>
  <card id="552">
    <name>Leviathan</name>
    <class>Rare</class>
    <cost>
      <gems>30</gems>
      <recruits>50</recruits>
    </cost>
    <level>10</level>
    <keywords>Aqua</keywords>
    <effect><![CDATA[Enemy tower: -80<br />Enemy wall: -100]]></effect>
    <code><![CDATA[$hisdata->Tower-= 80; $hisdata->Wall-= 100;]]></code>
    <created>2010-06-21</created>
    <modified>2010-06-21</modified>
  </card>
  <card id="553">
    <name>Hidden lagoon</name>
    <class>Common</class>
    <cost>
      <gems>1</gems>
    </cost>
    <level>8</level>
    <keywords>Aqua</keywords>
    <effect><![CDATA[Wall: +N / 2<br />Stock: +N / 3<br />N = #<b>Aqua</b> in hand]]></effect>
    <code><![CDATA[
    $tmp = $this->keywordCount($mydata->Hand, 'Aqua');
    $mydata->Wall+= round($tmp / 2);
    $mydata->addStock(round($tmp / 3));
]]></code>
    <created>2010-06-21</created>
    <modified>2010-06-21</modified>
  </card>
  <card id="554">
    <name>Northern fortress</name>
    <class>Uncommon</class>
    <cost>
      <bricks>35</bricks>
    </cost>
    <level>10</level>
    <effect><![CDATA[Wall: +40<br />If New or matching card is New<br />Tower: +20]]></effect>
    <code><![CDATA[
    $mydata->Wall+= 40;
    if (isset($mynewflags[$cardpos]) or isset($hisnewflags[$cardpos])) $mydata->Tower+= 20;
]]></code>
    <created>2010-06-21</created>
    <modified>2010-07-22</modified>
  </card>
  <card id="555">
    <name>Trickster</name>
    <class>Uncommon</class>
    <cost>
      <gems>3</gems>
      <recruits>3</recruits>
    </cost>
    <level>10</level>
    <keywords>Brigand</keywords>
    <effect><![CDATA[Opponent's tokens are destroyed<br />Gain 1 random resource for each 10 destroyed tokens of the same kind]]></effect>
    <code><![CDATA[
    $tmp = 0;
    foreach ($hisdata->TokenValues as $i => $value) {
      if ($value > 0) {
        $tmp+= floor($value / 10); $hisdata->TokenValues[$i] = 0;
      }
    }
    $mydata->addRandomResources($tmp);
]]></code>
    <created>2010-06-21</created>
    <modified>2010-06-21</modified>
  </card>
  <card id="556">
    <name>Dwarven watchtower</name>
    <class>Common</class>
    <cost>
      <bricks>8</bricks>
    </cost>
    <level>10</level>
    <keywords>Runic</keywords>
    <effect><![CDATA[Tower: +6<br />Summons <b>Runic</b> of the same rarity as matching card]]></effect>
    <code><![CDATA[
    $mydata->Tower+= 6;
    $rarity = $this->getCard($hisdata->Hand[$cardpos])->getClass();
    $nextcard = $this->drawCard($this->getList(['class'=>$rarity, 'keyword'=>'Runic']), $mydata->Hand, $cardpos, 'drawCardList');
]]></code>
    <created>2010-06-21</created>
    <modified>2011-04-24</modified>
  </card>
  <card id="557">
    <name>Confusion</name>
    <class>Uncommon</class>
    <modes>8</modes>
    <level>9</level>
    <keywords>Illusion</keywords>
    <effect><![CDATA[Stock: +4<br />Replace a card in opponent's hand with a rare card from your deck]]></effect>
    <code><![CDATA[
    $mydata->addStock(4);
    $this->setCard('his', $mode, $this->drawCard($my_deck->Rare, $hisdata->Hand, $mode, 'drawCardList'));
]]></code>
    <created>2010-06-21</created>
    <modified>2010-06-21</modified>
  </card>
  <card id="558">
    <name>Magic spring</name>
    <class>Common</class>
    <level>10</level>
    <effect><![CDATA[Gain 1 random resource for each different keyword in hand]]></effect>
    <code><![CDATA[$mydata->addRandomResources($this->countDistinctKeywords($mydata->Hand));]]></code>
    <created>2010-06-21</created>
    <modified>2010-06-21</modified>
  </card>
  <card id="559">
    <name>River thief</name>
    <class>Common</class>
    <cost>
      <gems>4</gems>
      <recruits>4</recruits>
    </cost>
    <level>8</level>
    <keywords>Aqua,Brigand</keywords>
    <effect><![CDATA[Attack: 4<br />Enemy stock: -2<br />If #<b>Aqua</b> in hand > 2<br />Stock: +2]]></effect>
    <code><![CDATA[
    $hisdata->attack(4);
    $hisdata->addStock(-2);
    if ($this->keywordCount($mydata->Hand, 'Aqua') > 2) {
      $mydata->addStock(2);
    }
]]></code>
    <created>2010-06-21</created>
    <modified>2011-02-12</modified>
  </card>
  <card id="560">
    <name>Sea gate</name>
    <class>Uncommon</class>
    <cost>
      <bricks>10</bricks>
    </cost>
    <level>10</level>
    <keywords>Aqua,Far sight</keywords>
    <effect><![CDATA[Wall: +15<br />Discard highest rarity <b>Aqua</b> from opponent's hand]]></effect>
    <code><![CDATA[
    $mydata->Wall+= 15;
    $storage = ['Common' => array(), 'Uncommon' => array(), 'Rare' => array()];
    for ($i = 1; $i <= 8; $i++) {
      $cur_card = $this->getCard($hisdata->Hand[$i]);
      $rarity = $cur_card->getClass();
      if ($cur_card->hasKeyword('Aqua')) $storage[$rarity][] = $i;
    }
    if ((count($storage['Common']) + count($storage['Uncommon']) + count($storage['Rare'])) > 0) {
      shuffle($storage['Common']); shuffle($storage['Uncommon']); shuffle($storage['Rare']);
      $storage_temp = array_merge($storage['Common'], $storage['Uncommon'], $storage['Rare']);
      $discarded_pos = array_pop($storage_temp);
      $this->setCard('his', $discarded_pos, $this->drawCard($his_deck, $hisdata->Hand, $discarded_pos, 'drawCardDifferent'));
    }
]]></code>
    <created>2010-06-21</created>
    <modified>2010-07-22</modified>
  </card>
  <card id="561">
    <name>Arcane bolt</name>
    <class>Common</class>
    <cost>
      <gems>5</gems>
    </cost>
    <level>10</level>
    <keywords>Destruction</keywords>
    <effect><![CDATA[Enemy stock: -2<br />If <b>Mage</b> tokens > 60<br />Enemy stock: -3]]></effect>
    <code><![CDATA[$reduction = ($mydata->getToken('Mage') > 60) ? 5 : 2; $hisdata->addStock(-$reduction);]]></code>
    <created>2010-06-21</created>
    <modified>2010-12-24</modified>
  </card>
  <card id="562">
    <name>Divine guidance</name>
    <class>Common</class>
    <cost>
      <gems>7</gems>
    </cost>
    <modes>2</modes>
    <level>1</level>
    <keywords>Restoration</keywords>
    <effect><![CDATA[Mode1:<br />Wall: +10<br />Mode2:<br />Recruits: +7]]></effect>
    <code><![CDATA[
    if ($mode == 1) $mydata->Wall+= 10; elseif ($mode == 2) $mydata->Recruits+= 7;
]]></code>
    <created>2010-06-21</created>
    <modified>2012-04-07</modified>
  </card>
  <card id="563">
    <name>Lancer</name>
    <class>Uncommon</class>
    <cost>
      <recruits>10</recruits>
    </cost>
    <level>9</level>
    <keywords>Barbarian,Frenzy</keywords>
    <effect><![CDATA[Attack: 15<br />Discard all <b>Quick</b> and <b>Swift</b> from opponent's hand]]></effect>
    <code><![CDATA[
    $hisdata->attack(15);
    for ($i = 1; $i <= 8; $i++) {
      $cur_card = $this->getCard($hisdata->Hand[$i]);
      if ($cur_card->hasKeyword('Quick') or $cur_card->hasKeyword('Swift')) {
        $this->setCard('his', $i, $this->drawCard($his_deck, $hisdata->Hand, $i, 'drawCardRandom'));
      }
    }
]]></code>
    <created>2010-06-21</created>
    <modified>2012-12-24</modified>
  </card>
  <card id="564">
    <name>Summon master</name>
    <class>Uncommon</class>
    <cost>
      <gems>6</gems>
    </cost>
    <level>10</level>
    <keywords>Mage</keywords>
    <effect><![CDATA[If <b>Mage</b> tokens > 60<br />Summons a <b>Legend</b><br /><b>Mage</b> tokens: = 0<br />else<br /><b>Mage</b> tokens: +40]]></effect>
    <code><![CDATA[
    if ($mydata->getToken('Mage') > 60) {
      $nextcard = $this->drawCard($this->getList(['keyword'=>'Legend']), $mydata->Hand, $cardpos, 'drawCardList');
      $mydata->setToken('Mage', 0);
    }
    else $mydata->addToken('Mage', 40);
]]></code>
    <created>2010-06-21</created>
    <modified>2014-12-24</modified>
  </card>
  <card id="565">
    <name>Titan's worshipper</name>
    <class>Uncommon</class>
    <cost>
      <gems>10</gems>
    </cost>
    <level>9</level>
    <effect><![CDATA[Summons a <b>Titan</b> not present in hand]]></effect>
    <code><![CDATA[
    $titans = array_diff($this->getList(['keyword'=>'Titan']), $mydata->Hand);
    if (count($titans) > 0) $nextcard = $this->drawCard($titans, $mydata->Hand, $cardpos, 'drawCardList');
]]></code>
    <created>2010-06-21</created>
    <modified>2010-06-21</modified>
  </card>
  <card id="566">
    <name>Wheat farm</name>
    <class>Common</class>
    <cost>
      <bricks>1</bricks>
      <gems>1</gems>
      <recruits>1</recruits>
    </cost>
    <level>10</level>
    <effect><![CDATA[Stock: +2N<br />N = #Wheat farm in hand]]></effect>
    <code><![CDATA[
    $tmp = 0;
    for ($i = 1; $i <= 8; $i++) {
      if ($mydata->Hand[$i] == 566) {
        $tmp++;
      }
    }
    $mydata->addStock(2 * $tmp);
]]></code>
    <created>2010-06-21</created>
    <modified>2011-02-12</modified>
  </card>
  <card id="567">
    <name>Jungle river</name>
    <class>Common</class>
    <cost>
      <recruits>1</recruits>
    </cost>
    <modes>8</modes>
    <level>9</level>
    <keywords>Aqua,Nature</keywords>
    <effect><![CDATA[Recruits: +3<br />Enemy wall: -3<br />Replace a card in hand with Piranhas]]></effect>
    <code><![CDATA[
    $mydata->Recruits+= 3;
    $hisdata->Wall-= 3; $this->setCard('my', $mode, 504, ['reveal' => true]);
    if ($mode == $cardpos) $nextcard = 0;
]]></code>
    <created>2010-06-21</created>
    <modified>2015-09-26</modified>
  </card>
  <card id="568">
    <name>Flesh golem</name>
    <class>Common</class>
    <cost>
      <bricks>8</bricks>
      <recruits>6</recruits>
    </cost>
    <modes>2</modes>
    <level>5</level>
    <keywords>Undead,Unliving</keywords>
    <effect><![CDATA[Attack: 6<br />Wall: +4<br />Mode1:<br />Bricks: +8<br />Mode2:<br />Recruits: +6]]></effect>
    <code><![CDATA[
    $hisdata->attack(6); $mydata->Wall+= 4;
    if ($mode == 1) $mydata->Bricks+=8; elseif ($mode == 2) $mydata->Recruits+= 6;
]]></code>
    <created>2010-06-21</created>
    <modified>2010-06-21</modified>
  </card>
  <card id="569">
    <name>Dream shift</name>
    <class>Uncommon</class>
    <cost>
      <gems>9</gems>
    </cost>
    <level>10</level>
    <keywords>Illusion</keywords>
    <effect><![CDATA[Replace your hand with cards from your deck of the same rarity as replaced cards]]></effect>
    <code><![CDATA[
    for ($i = 1; $i <= 8; $i++) {
      if ($i != $cardpos) {
        $rarity = $this->getCard($mydata->Hand[$i])->getClass();
        $this->setCard('my', $i, $this->drawCard(array_diff($my_deck->$rarity, [569, $mydata->Hand[$i]]), $mydata->Hand, $i, 'drawCardList'));
      }
    }
]]></code>
    <created>2010-06-21</created>
    <modified>2010-11-01</modified>
  </card>
  <card id="570">
    <name>Swamp</name>
    <class>Common</class>
    <cost>
      <bricks>4</bricks>
      <gems>3</gems>
    </cost>
    <level>6</level>
    <keywords>Aqua,Skirmisher</keywords>
    <effect><![CDATA[Wall: +8<br />Enemy stock: -1]]></effect>
    <code><![CDATA[
    $mydata->Wall+= 8;
    $hisdata->addStock(-1);
]]></code>
    <created>2010-06-21</created>
    <modified>2010-06-21</modified>
  </card>
  <card id="571">
    <name>Flame obelisk</name>
    <class>Uncommon</class>
    <cost>
      <bricks>12</bricks>
    </cost>
    <level>10</level>
    <keywords>Burning</keywords>
    <effect><![CDATA[Tower: +15<br />Replace neighbouring cards with <b>Burning</b>]]></effect>
    <code><![CDATA[
    $mydata->Tower+= 15;
    if ($cardpos > 1) {
      $this->setCard('my', $cardpos - 1, $this->drawCard($this->getList(['keyword'=>'Burning']), $mydata->Hand, $cardpos - 1, 'drawCardList'));
    }
    if ($cardpos < 8) {
      $this->setCard('my', $cardpos + 1, $this->drawCard($this->getList(['keyword'=>'Burning']), $mydata->Hand, $cardpos + 1, 'drawCardList'));
    }
]]></code>
    <created>2010-06-21</created>
    <modified>2013-07-27</modified>
  </card>
  <card id="572">
    <name>Stables</name>
    <class>Common</class>
    <cost>
      <bricks>4</bricks>
      <recruits>1</recruits>
    </cost>
    <level>7</level>
    <effect><![CDATA[Tower: +2<br />Wall: +4<br />Summons non-rare <b>Charge</b>]]></effect>
    <code><![CDATA[
    $mydata->Tower+= 2; $mydata->Wall+= 4;
    $common = $this->getList(['class'=>'Common', 'keyword'=>'Charge']);
    $uncommon = $this->getList(['class'=>'Uncommon', 'keyword'=>'Charge']);
    $nextcard = $this->drawCard(array_merge($common, $uncommon), $mydata->Hand, $cardpos, 'drawCardList');
]]></code>
    <created>2010-06-21</created>
    <modified>2014-12-24</modified>
  </card>
  <card id="573">
    <name>Laputa the Flying fortress</name>
    <class>Rare</class>
    <cost>
      <bricks>18</bricks>
      <gems>18</gems>
      <recruits>18</recruits>
    </cost>
    <level>9</level>
    <keywords>Aria</keywords>
    <effect><![CDATA[Tower:= Max tower - Tower<br />If Wall > 35<br />Wall:= Max wall - Wall]]></effect>
    <code><![CDATA[
    $mydata->Tower = $max_tower - $mydata->Tower;
    if ($mydata->Wall > 35) $mydata->Wall = $max_wall - $mydata->Wall;
]]></code>
    <created>2010-06-21</created>
    <modified>2012-06-24</modified>
  </card>
  <card id="574">
    <name>Alucard</name>
    <class>Rare</class>
    <cost>
      <gems>20</gems>
      <recruits>20</recruits>
    </cost>
    <level>8</level>
    <keywords>Far sight,Banish,Skirmisher</keywords>
    <effect><![CDATA[Attack: 35<br />If #different keywords in hand > #different keywords in opponent's hand<br />Attack: 30]]></effect>
    <code><![CDATA[
    $tmp = ($this->countDistinctKeywords($mydata->Hand) > $this->countDistinctKeywords($hisdata->Hand)) ? 65 : 35;
    $hisdata->attack($tmp);
]]></code>
    <created>2010-06-21</created>
    <modified>2010-12-24</modified>
  </card>
  <card id="575">
    <name>Chateau</name>
    <class>Common</class>
    <cost>
      <bricks>10</bricks>
    </cost>
    <level>8</level>
    <effect><![CDATA[If Tower < 15 or Wall < 15<br />Tower: +5<br />Wall: +12<br />else<br />Tower: +3<br />Wall: +8]]></effect>
    <code><![CDATA[
    if ($mydata->Tower < 15 or $mydata->Wall < 15) {
      $mydata->Tower+= 5; $mydata->Wall+= 12;
    }
    else {
      $mydata->Tower+= 3; $mydata->Wall+= 8;
    }
]]></code>
    <created>2010-09-10</created>
    <modified>2010-09-10</modified>
  </card>
  <card id="576">
    <name>Necroent</name>
    <class>Uncommon</class>
    <cost>
      <gems>20</gems>
      <recruits>20</recruits>
    </cost>
    <level>10</level>
    <keywords>Nature,Undead</keywords>
    <effect><![CDATA[Enemy wall: -23<br />Attack: 15<br />If #<b>Nature</b> in hand > 4<br />Gems: +20<br />If #<b>Undead</b> in hand > 4<br />Recruits: +20]]></effect>
    <code><![CDATA[
    $hisdata->Wall-= 23; $hisdata->attack(15);
    if ($this->keywordCount($mydata->Hand, 'Nature') > 4) $mydata->Gems+= 20;
    if ($this->keywordCount($mydata->Hand, 'Undead') > 4) $mydata->Recruits+= 20;
]]></code>
    <created>2010-09-10</created>
    <modified>2013-12-24</modified>
  </card>
  <card id="577">
    <name>Seiryu</name>
    <class>Rare</class>
    <cost>
      <gems>50</gems>
    </cost>
    <level>8</level>
    <keywords>Dragon</keywords>
    <effect><![CDATA[Attack: 10N<br />N = #Magic + #Enemy magic]]></effect>
    <code><![CDATA[
    $tmp = $mydata->Magic + $hisdata->Magic;
    $hisdata->attack(10 * $tmp);
]]></code>
    <created>2010-09-10</created>
    <modified>2010-09-10</modified>
  </card>
  <card id="578">
    <name>Deathwood necromancer</name>
    <class>Common</class>
    <cost>
      <gems>1</gems>
      <recruits>1</recruits>
    </cost>
    <level>10</level>
    <keywords>Nature,Undead</keywords>
    <effect><![CDATA[Gems: +#<b>Nature</b> in hand (max 4)<br />Recruits: +#<b>Undead</b> in hand (max 4)]]></effect>
    <code><![CDATA[
    $mydata->Gems+= min(4, $this->keywordCount($mydata->Hand, 'Nature'));
    $mydata->Recruits+= min(4, $this->keywordCount($mydata->Hand, 'Undead'));
]]></code>
    <created>2010-09-10</created>
    <modified>2013-12-24</modified>
  </card>
  <card id="579">
    <name>Citadel towers</name>
    <class>Uncommon</class>
    <cost>
      <bricks>17</bricks>
    </cost>
    <level>9</level>
    <keywords>Far sight</keywords>
    <effect><![CDATA[If Tower < Wall<br />Tower: +25<br />else<br />Tower: +12]]></effect>
    <code><![CDATA[if ($mydata->Tower < $mydata->Wall) $mydata->Tower+= 25; else $mydata->Tower+= 12;]]></code>
    <created>2010-09-10</created>
    <modified>2010-09-10</modified>
  </card>
  <card id="580">
    <name>Wizard's tower</name>
    <class>Common</class>
    <cost>
      <bricks>2</bricks>
      <gems>3</gems>
    </cost>
    <level>5</level>
    <effect><![CDATA[Tower: +N<br />N = 3 + #Magic]]></effect>
    <code><![CDATA[$mydata->Tower+= 3 + $mydata->Magic;]]></code>
    <created>2010-09-10</created>
    <modified>2010-09-10</modified>
  </card>
  <card id="581">
    <name>Mountain berserker</name>
    <class>Common</class>
    <cost>
      <recruits>8</recruits>
    </cost>
    <level>2</level>
    <keywords>Barbarian</keywords>
    <effect><![CDATA[Attack: 7<br />Stock: +2]]></effect>
    <code><![CDATA[
    $hisdata->attack(7);
    $mydata->addStock(2);
]]></code>
    <created>2010-09-10</created>
    <modified>2010-09-10</modified>
  </card>
  <card id="582">
    <name>Magical defense</name>
    <class>Common</class>
    <cost>
      <gems>7</gems>
    </cost>
    <level>2</level>
    <keywords>Illusion</keywords>
    <effect><![CDATA[Wall: +7<br />Bricks: +5]]></effect>
    <code><![CDATA[$mydata->Wall+= 7; $mydata->Bricks+= 5;]]></code>
    <created>2010-09-10</created>
    <modified>2010-10-03</modified>
  </card>
  <card id="583">
    <name>Moon castle</name>
    <class>Uncommon</class>
    <cost>
      <gems>1</gems>
    </cost>
    <level>10</level>
    <effect><![CDATA[Players gain 1 stock for each non-keyword card and lose 1 stock for each different keyword in their hand]]></effect>
    <code><![CDATA[
    $mine = $his = 0;
    for ($i = 1; $i <= 8; $i++) {
      if (!$this->getCard($mydata->Hand[$i])->hasKeyword('any')) $mine++;
      if (!$this->getCard($hisdata->Hand[$i])->hasKeyword('any')) $his++;
    }
    $my_gain = $mine - $this->countDistinctKeywords($mydata->Hand);
    $his_gain = $his - $this->countDistinctKeywords($hisdata->Hand);
    $mydata->addStock($my_gain);
    $hisdata->addStock($his_gain);
]]></code>
    <created>2010-09-10</created>
    <modified>2010-09-10</modified>
  </card>
  <card id="584">
    <name>Chaos dwarf</name>
    <class>Common</class>
    <cost>
      <recruits>3</recruits>
    </cost>
    <modes>8</modes>
    <level>10</level>
    <keywords>Runic</keywords>
    <effect><![CDATA[Replace a card in hand with self<br />Raises wall based on replaced card rarity (C-2, U-6, R-14)]]></effect>
    <code><![CDATA[
    $rarities = ['Common' => 2, 'Uncommon' => 6, 'Rare' => 14];
    $cur_rarity = $this->getCard($mydata->Hand[$mode])->getClass();
    $mydata->Wall+= $rarities[$cur_rarity];
    if ($mode == $cardpos) $nextcard = 0;
    else $this->replaceCard('my', $mode, $card->id());
]]></code>
    <created>2010-09-10</created>
    <modified>2012-04-07</modified>
  </card>
  <card id="585">
    <name>Barbz's pupil</name>
    <class>Common</class>
    <modes>8</modes>
    <level>9</level>
    <keywords>Brigand</keywords>
    <effect><![CDATA[Summons selected non-rare card in opponent's hand]]></effect>
    <code><![CDATA[if ($this->getCard($hisdata->Hand[$mode])->getClass() != 'Rare') $nextcard = $hisdata->Hand[$mode];]]></code>
    <created>2010-09-10</created>
    <modified>2011-12-24</modified>
  </card>
  <card id="586">
    <name>Mithril miner</name>
    <class>Common</class>
    <cost>
      <gems>1</gems>
      <recruits>1</recruits>
    </cost>
    <level>2</level>
    <keywords>Runic</keywords>
    <effect><![CDATA[Highest facility prod x2]]></effect>
    <code><![CDATA[$production->multiply(2, $mydata->detectHighestFacility());]]></code>
    <created>2010-09-10</created>
    <modified>2011-04-24</modified>
  </card>
  <card id="587">
    <name>Working together</name>
    <class>Common</class>
    <cost>
      <bricks>2</bricks>
      <recruits>1</recruits>
    </cost>
    <level>8</level>
    <effect><![CDATA[Tower: +#common cards in hand]]></effect>
    <code><![CDATA[
    for ($i = 1; $i <= 8; $i++) {
      if ($this->getCard($mydata->Hand[$i])->getClass() == 'Common') {
        $mydata->Tower++;
      }
    }
]]></code>
    <created>2010-09-10</created>
    <modified>2010-09-10</modified>
  </card>
  <card id="588">
    <name>Harvest fairy</name>
    <class>Common</class>
    <cost>
      <recruits>2</recruits>
    </cost>
    <level>10</level>
    <effect><![CDATA[Replace neighbouring cards with Wheat farm]]></effect>
    <code><![CDATA[
    if ($cardpos > 1) {
      $this->setCard('my', $cardpos - 1, 566, ['reveal' => true]);
    }
    if ($cardpos < 8) {
      $this->setCard('my', $cardpos + 1, 566, ['reveal' => true]);
    }
]]></code>
    <created>2010-09-10</created>
    <modified>2015-09-26</modified>
  </card>
  <card id="589">
    <name>Librarian</name>
    <class>Common</class>
    <cost>
      <gems>7</gems>
    </cost>
    <level>10</level>
    <keywords>Mage</keywords>
    <effect><![CDATA[Tower: +3<br /><b>Mage</b> tokens: +30]]></effect>
    <code><![CDATA[$mydata->Tower+= 3; $mydata->addToken('Mage', 30);]]></code>
    <created>2010-09-10</created>
    <modified>2013-03-31</modified>
  </card>
  <card id="590">
    <name>Golem Messenger</name>
    <class>Common</class>
    <cost>
      <bricks>9</bricks>
    </cost>
    <level>10</level>
    <keywords>Unliving</keywords>
    <effect><![CDATA[Tower: +4<br />Wall: +6<br />Summons <b>Unliving</b>]]></effect>
    <code><![CDATA[
    $mydata->Tower+= 4; $mydata->Wall+= 6;
    $nextcard = $this->drawCard($this->getList(['keyword'=>'Unliving']), $mydata->Hand, $cardpos, 'drawCardList');
]]></code>
    <created>2010-09-10</created>
    <modified>2010-09-10</modified>
  </card>
  <card id="591">
    <name>Colossus of Kran</name>
    <class>Rare</class>
    <cost>
      <bricks>40</bricks>
    </cost>
    <level>10</level>
    <keywords>Unliving,Siege</keywords>
    <effect><![CDATA[Attack: 30 + 4N<br />Quarry: +N / 2<br />N = #<b>Unliving</b> in hand]]></effect>
    <code><![CDATA[
    $tmp = $this->keywordCount($mydata->Hand, 'Unliving');
    $hisdata->attack(30 + 4 * $tmp);
    $mydata->Quarry+= round($tmp / 2);
]]></code>
    <created>2010-09-10</created>
    <modified>2011-04-24</modified>
  </card>
  <card id="592">
    <name>Eternal dream</name>
    <class>Uncommon</class>
    <cost>
      <gems>4</gems>
    </cost>
    <level>9</level>
    <keywords>Illusion</keywords>
    <effect><![CDATA[If last card played was a rare<br />Summons a rare card]]></effect>
    <code><![CDATA[
    if ($mylast_card->getClass() == 'Rare') {
      $nextcard = $this->drawCard($this->getList(['class'=>'Rare']), $mydata->Hand, $cardpos, 'drawCardList');
    }
]]></code>
    <created>2010-09-10</created>
    <modified>2010-09-10</modified>
  </card>
  <card id="593">
    <name>Witch rider</name>
    <class>Uncommon</class>
    <cost>
      <gems>20</gems>
      <recruits>12</recruits>
    </cost>
    <level>5</level>
    <effect><![CDATA[Gems: +8<br />If #<b>Far sight</b> in hand > 0<br />Enemy tower: -18<br />else<br />Attack: 20]]></effect>
    <code><![CDATA[
    $mydata->Gems+= 8;
    if ($this->keywordCount($mydata->Hand, 'Far sight') > 0) $hisdata->Tower-= 18;
    else $hisdata->attack(20);
]]></code>
    <created>2010-09-10</created>
    <modified>2010-12-24</modified>
  </card>
  <card id="594">
    <name>Desert traveler</name>
    <class>Uncommon</class>
    <cost>
      <recruits>8</recruits>
    </cost>
    <level>10</level>
    <effect><![CDATA[Attack: 8<br />Opponent loses 14 random resources<br />Replace matching card with Caravan]]></effect>
    <code><![CDATA[
    $hisdata->attack(8);
    $hisdata->addRandomResources(-14);
    $this->setCard('his', $cardpos, 23, ['reveal' => true]);
]]></code>
    <created>2010-09-10</created>
    <modified>2015-09-26</modified>
  </card>
  <card id="595">
    <name>Thug</name>
    <class>Common</class>
    <cost>
      <recruits>4</recruits>
    </cost>
    <level>9</level>
    <effect><![CDATA[Opponent loses 5 random resources<br />Replace non-rare matching card with Palisade]]></effect>
    <code><![CDATA[
    $hisdata->addRandomResources(-5);
    if ($this->getCard($hisdata->Hand[$cardpos])->getClass() != 'Rare') {
      $this->setCard('his', $cardpos, 297, ['reveal' => true]);
    }
]]></code>
    <created>2010-09-10</created>
    <modified>2015-09-26</modified>
  </card>
  <card id="596">
    <name>Myr's academy</name>
    <class>Rare</class>
    <cost>
      <bricks>7</bricks>
      <gems>7</gems>
      <recruits>7</recruits>
    </cost>
    <level>7</level>
    <effect><![CDATA[Replace your hand with Red mage, Conjurer, Wizard, Chaos wizard, Librarian, Summon master, Sorceress and Wind witch<br />Gems prod x3]]></effect>
    <code><![CDATA[$this->setHandShuffled('my', [329, 82, 457, 589, 109, 564, 53, 467]); $nextcard = 0; $production->multiplyGems(3);]]></code>
    <created>2010-09-10</created>
    <modified>2012-09-08</modified>
  </card>
  <card id="597">
    <name>Fireball</name>
    <class>Common</class>
    <cost>
      <gems>4</gems>
    </cost>
    <level>10</level>
    <keywords>Burning,Siege</keywords>
    <effect><![CDATA[Attack: 3 + N / 10<br />N = <b>Mage</b> tokens<br />If Enemy tower > 45<br />Enemy tower: -5]]></effect>
    <code><![CDATA[
    $dmg = ($mydata->findToken('Mage')) ? round($mydata->getToken('Mage') / 10) : 0;
    $hisdata->attack(3 + $dmg);
    if ($hisdata->Tower > 45) $hisdata->Tower-= 5;
]]></code>
    <created>2010-09-10</created>
    <modified>2011-12-24</modified>
  </card>
  <card id="598">
    <name>Urk's tribe</name>
    <class>Common</class>
    <level>9</level>
    <keywords>Barbarian,Charge (2)</keywords>
    <effect><![CDATA[Attack: 8<br />You lose 6 random resources]]></effect>
    <code><![CDATA[
    $hisdata->attack(8);
    $mydata->addRandomResources(-6);
]]></code>
    <created>2010-09-10</created>
    <modified>2010-12-24</modified>
  </card>
  <card id="599">
    <name>Elven warlock</name>
    <class>Rare</class>
    <cost>
      <gems>24</gems>
      <recruits>18</recruits>
    </cost>
    <level>9</level>
    <keywords>Alliance,Mage</keywords>
    <effect><![CDATA[Attack: 8N<br />N = #Magic<br />Gems prod x6<br />]]></effect>
    <code><![CDATA[$hisdata->attack(8 * $mydata->Magic); $production->multiplyGems(6);]]></code>
    <created>2010-10-03</created>
    <modified>2010-12-24</modified>
  </card>
  <card id="600">
    <name>Battle rager</name>
    <class>Uncommon</class>
    <cost>
      <recruits>16</recruits>
    </cost>
    <level>8</level>
    <keywords>Barbarian,Skirmisher,Frenzy</keywords>
    <effect><![CDATA[If played card is a neighbour of a <b>Frenzy</b> card<br />Attack: 15<br />else<br />Attack: 21]]></effect>
    <code><![CDATA[
    $tmp = (($cardpos > 1 and $this->getCard($mydata->Hand[$cardpos - 1])->hasKeyword('Frenzy')) or ($cardpos < 8 and $this->getCard($mydata->Hand[$cardpos + 1])->hasKeyword('Frenzy'))) ? 15 : 21;
    $hisdata->attack($tmp);
]]></code>
    <created>2010-10-03</created>
    <modified>2013-07-27</modified>
  </card>
  <card id="601">
    <name>Whirlwind</name>
    <class>Uncommon</class>
    <level>8</level>
    <keywords>Quick,Aria</keywords>
    <effect><![CDATA[Enemy wall: -3<br />Enemy stock: -1<br />Shuffles your hand]]></effect>
    <code><![CDATA[
    $hisdata->Wall-= 3;
    $hisdata->addStock(-1);
    $this->setCard('my', $cardpos, $this->drawCard($my_deck, $mydata->Hand, $cardpos, 'drawCardNoRare'));
    $mydata->shuffleHand(); $nextcard = 0; 
]]></code>
    <created>2010-10-03</created>
    <modified>2015-08-01</modified>
  </card>
  <card id="602">
    <name>Northern mountains</name>
    <class>Common</class>
    <level>10</level>
    <effect><![CDATA[Wall: +10<br />Enemy wall: +10<br />Summons a <b>Barbarian</b>]]></effect>
    <code><![CDATA[
    $mydata->Wall+= 10; $hisdata->Wall+= 10;
    $nextcard = $this->drawCard($this->getList(['keyword'=>'Barbarian']), $mydata->Hand, $cardpos, 'drawCardList');
]]></code>
    <created>2010-10-03</created>
    <modified>2014-04-21</modified>
  </card>
  <card id="603">
    <name>Wolf mistress</name>
    <class>Uncommon</class>
    <cost>
      <recruits>8</recruits>
    </cost>
    <modes>8</modes>
    <level>8</level>
    <keywords>Barbarian,Beast,Frenzy</keywords>
    <effect><![CDATA[Attack: 8<br />Replace a card in hand with <b>Frenzy</b>]]></effect>
    <code><![CDATA[
    $hisdata->attack(8);
    $this->setCard('my', $mode, $this->drawCard($this->getList(['keyword'=>'Frenzy']), $mydata->Hand, $mode, 'drawCardList'));
    if ($mode == $cardpos) $nextcard = 0;
]]></code>
    <created>2010-10-03</created>
    <modified>2013-07-27</modified>
  </card>
  <card id="604">
    <name>Byakko</name>
    <class>Rare</class>
    <cost>
      <recruits>20</recruits>
    </cost>
    <level>10</level>
    <keywords>Beast,Durable</keywords>
    <effect><![CDATA[Dungeon: +1<br />Attack: 10N<br />N = #Dungeon - #Enemy dungeon<br />Recruits prod x0]]></effect>
    <code><![CDATA[
    $mydata->Dungeons+= 1; $tmp = max(0, $mydata->Dungeons - $hisdata->Dungeons);
    $hisdata->attack(10 * $tmp); $production->multiplyRecruits(0);
]]></code>
    <created>2010-10-03</created>
    <modified>2010-12-24</modified>
  </card>
  <card id="605">
    <name>Reinforcements</name>
    <class>Common</class>
    <modes>8</modes>
    <level>10</level>
    <effect><![CDATA[Replace a card in hand with Recruits only no support keyword attack card]]></effect>
    <code><![CDATA[
    $this->setCard('my', $mode, $this->drawCard($this->getList(['cost'=>'Green', 'advanced'=>'Attack:', 'support'=>'No keywords']), $mydata->Hand, $mode, 'drawCardList'));
    if ($mode == $cardpos) $nextcard = 0;
]]></code>
    <created>2010-10-03</created>
    <modified>2012-04-07</modified>
  </card>
  <card id="606">
    <name>Poison frog</name>
    <class>Common</class>
    <cost>
      <gems>2</gems>
      <recruits>3</recruits>
    </cost>
    <level>7</level>
    <keywords>Aqua,Quick</keywords>
    <effect><![CDATA[Attack: 2<br />Enemy recruits: -1]]></effect>
    <code><![CDATA[$hisdata->attack(2); $hisdata->Recruits-= 1;]]></code>
    <created>2010-10-03</created>
    <modified>2010-10-03</modified>
  </card>
  <card id="607">
    <name>Fire fox</name>
    <class>Common</class>
    <cost>
      <gems>3</gems>
      <recruits>3</recruits>
    </cost>
    <level>10</level>
    <keywords>Beast,Burning</keywords>
    <effect><![CDATA[Gems: +#<b>Burning</b> in game (max 7)<br />Recruits: +#<b>Beast</b> in hand (max 7)]]></effect>
    <code><![CDATA[
    $mydata->Gems+= min(7, $this->keywordCount($mydata->Hand, 'Burning') + $this->keywordCount($hisdata->Hand, 'Burning'));
    $mydata->Recruits+= min(7, $this->keywordCount($mydata->Hand, 'Beast'));
]]></code>
    <created>2010-10-03</created>
    <modified>2011-12-24</modified>
  </card>
  <card id="608">
    <name>Purifying fire</name>
    <class>Common</class>
    <cost>
      <gems>1</gems>
    </cost>
    <level>10</level>
    <keywords>Burning</keywords>
    <effect><![CDATA[Players discard all non-rare cards not from their deck (can't draw rare cards)]]></effect>
    <code><![CDATA[
    $my_cards = array_merge($my_deck->Common, $my_deck->Uncommon);
    for ($i = 1; $i <= 8; $i++) {
      $cur_card = $mydata->Hand[$i];
      if ($this->getCard($cur_card)->getClass() != 'Rare' and !in_array($cur_card, $my_cards) and $i != $cardpos) {
        $this->setCard('my', $i, $this->drawCard($my_deck, $mydata->Hand, $i, 'drawCardNoRare'));
      }
    }
    $his_cards = array_merge($his_deck->Common, $his_deck->Uncommon);
    for ($i = 1; $i <= 8; $i++) {
      $cur_card = $hisdata->Hand[$i];
      if ($this->getCard($cur_card)->getClass() != 'Rare' and !in_array($cur_card, $his_cards)) {
        $this->setCard('his', $i, $this->drawCard($his_deck, $hisdata->Hand, $i, 'drawCardNoRare'));
      }
    }
]]></code>
    <created>2010-10-03</created>
    <modified>2014-12-24</modified>
  </card>
  <card id="609">
    <name>Warhound</name>
    <class>Common</class>
    <cost>
      <recruits>4</recruits>
    </cost>
    <level>7</level>
    <keywords>Beast,Soldier,Charge (2)</keywords>
    <effect><![CDATA[Wall: +6]]></effect>
    <code><![CDATA[$mydata->Wall+= 6;]]></code>
    <created>2011-01-01</created>
    <modified>2011-01-01</modified>
  </card>
  <card id="610">
    <name>Succubus</name>
    <class>Uncommon</class>
    <cost>
      <gems>8</gems>
      <recruits>8</recruits>
    </cost>
    <modes>8</modes>
    <level>9</level>
    <keywords>Burning,Demonic</keywords>
    <effect><![CDATA[Attack: 16<br />Discard a non-rare card from opponent's hand<br />Summons the discarded card]]></effect>
    <code><![CDATA[
    $hisdata->attack(16);
    if ($this->getCard($hisdata->Hand[$mode])->getClass() != 'Rare') {
      $this->setCard('my', $cardpos, $hisdata->Hand[$mode], ['reveal' => true]);
      $nextcard = 0;
      $this->setCard('his', $mode, $this->drawCard($his_deck, $hisdata->Hand, $mode, 'drawCardDifferent'));
    }
]]></code>
    <created>2011-01-01</created>
    <modified>2015-09-26</modified>
  </card>
  <card id="611">
    <name>Infinite weapon works</name>
    <class>Rare</class>
    <cost>
      <bricks>1</bricks>
      <gems>1</gems>
      <recruits>1</recruits>
    </cost>
    <level>10</level>
    <keywords>Durable</keywords>
    <effect><![CDATA[Production x0<br />Recruits: +20]]></effect>
    <code><![CDATA[$production->multiply(0); $mydata->Recruits+= 20;]]></code>
    <created>2011-01-01</created>
    <modified>2011-01-01</modified>
  </card>
  <card id="612">
    <name>Corrupted woods</name>
    <class>Rare</class>
    <cost>
      <bricks>8</bricks>
      <gems>8</gems>
      <recruits>8</recruits>
    </cost>
    <level>9</level>
    <keywords>Nature,Undead</keywords>
    <effect><![CDATA[Wall: +5N<br />Enemy wall: -5M<br />Stock: +(N + M)<br />N = #<b>Nature</b> in hand<br />M = #<b>Undead</b> in hand]]></effect>
    <code><![CDATA[
    $nature = $this->keywordCount($mydata->Hand, 'Nature');
    $undead = $this->keywordCount($mydata->Hand, 'Undead');
    $tmp = $nature + $undead;
    $mydata->Wall+= 5 * $nature; $hisdata->Wall-= 5 * $undead;
    $mydata->addStock($tmp);
]]></code>
    <created>2011-01-01</created>
    <modified>2011-02-12</modified>
  </card>
  <card id="613">
    <name>Atlantis</name>
    <class>Rare</class>
    <cost>
      <gems>12</gems>
    </cost>
    <level>9</level>
    <effect><![CDATA[Replace your hand with Mermaid, Hidden lagoon, Sea priestess, Sea gate, Sea lord, Kraken, Ocean queen and Water dragon]]></effect>
    <code><![CDATA[$this->setHandShuffled('my', [521, 553, 550, 560, 507, 505, 530, 506]); $nextcard = 0;]]></code>
    <created>2011-01-01</created>
    <modified>2011-09-24</modified>
  </card>
  <card id="614">
    <name>Crystal cavern</name>
    <class>Rare</class>
    <cost>
      <bricks>15</bricks>
      <gems>15</gems>
      <recruits>15</recruits>
    </cost>
    <level>1</level>
    <effect><![CDATA[Facilities: +2]]></effect>
    <code><![CDATA[$mydata->addFacilities(2);]]></code>
    <created>2011-01-01</created>
    <modified>2011-01-01</modified>
  </card>
  <card id="615">
    <name>Ancient dragon</name>
    <class>Rare</class>
    <cost>
      <gems>18</gems>
      <recruits>18</recruits>
    </cost>
    <modes>2</modes>
    <level>1</level>
    <keywords>Dragon</keywords>
    <effect><![CDATA[Attack: 45<br />Mode1:<br />Magic: +1<br />Mode2:<br />Dungeon: +1]]></effect>
    <code><![CDATA[
    $hisdata->attack(45);
    if ($mode == 1) $mydata->Magic+= 1; elseif ($mode == 2) $mydata->Dungeons+= 1;
]]></code>
    <created>2011-01-01</created>
    <modified>2011-01-01</modified>
  </card>
  <card id="616">
    <name>Genbu</name>
    <class>Rare</class>
    <cost>
      <bricks>30</bricks>
    </cost>
    <level>10</level>
    <keywords>Unliving</keywords>
    <effect><![CDATA[Attack: 10N<br />Tower: +10M<br />N = #Quarry<br />M = #Enemy quarry]]></effect>
    <code><![CDATA[
    $hisdata->attack(10 * $mydata->Quarry);
    $mydata->Tower+= 10 * $hisdata->Quarry;
]]></code>
    <created>2011-01-01</created>
    <modified>2011-01-01</modified>
  </card>
  <card id="617">
    <name>Dwarven forge</name>
    <class>Uncommon</class>
    <cost>
      <bricks>15</bricks>
      <gems>12</gems>
    </cost>
    <level>4</level>
    <keywords>Runic</keywords>
    <effect><![CDATA[Tower: +4<br />Wall: +6<br />Lowest facility: +2]]></effect>
    <code><![CDATA[
    $mydata->Tower+= 4;
    $mydata->Wall+= 6;
    $mydata->addLowestFacility(2);
]]></code>
    <created>2011-01-01</created>
    <modified>2012-12-24</modified>
  </card>
  <card id="618">
    <name>Dwarven guard</name>
    <class>Uncommon</class>
    <cost>
      <recruits>16</recruits>
    </cost>
    <level>5</level>
    <keywords>Runic</keywords>
    <effect><![CDATA[Attack: 13<br />If N < 1<br />N = #<b>Runic</b> + #<b>Durable</b> in opponent's hand<br />Attack: 12]]></effect>
    <code><![CDATA[
    $tmp = ($this->keywordCount($hisdata->Hand, 'Runic') + $this->keywordCount($hisdata->Hand, 'Durable') < 1) ? 25 : 13;
    $hisdata->attack($tmp);
]]></code>
    <created>2011-01-01</created>
    <modified>2015-09-26</modified>
  </card>
  <card id="619">
    <name>Dwarven wall</name>
    <class>Common</class>
    <cost>
      <bricks>7</bricks>
    </cost>
    <level>9</level>
    <keywords>Runic</keywords>
    <effect><![CDATA[Wall: +N<br />N = #Facilities]]></effect>
    <code><![CDATA[$mydata->Wall+= $mydata->Quarry + $mydata->Magic + $mydata->Dungeons;]]></code>
    <created>2011-01-01</created>
    <modified>2013-10-19</modified>
  </card>
  <card id="620">
    <name>Wish</name>
    <class>Common</class>
    <cost>
      <gems>6</gems>
    </cost>
    <level>7</level>
    <effect><![CDATA[Discard your hand and draw new starting hand]]></effect>
    <code><![CDATA[$this->setHand('my', $this->drawHandInitial($my_deck)); $nextcard = 0;]]></code>
    <created>2011-01-01</created>
    <modified>2011-01-01</modified>
  </card>
  <card id="621">
    <name>Warpriest</name>
    <class>Uncommon</class>
    <cost>
      <gems>9</gems>
      <recruits>9</recruits>
    </cost>
    <level>7</level>
    <keywords>Holy,Mage</keywords>
    <effect><![CDATA[Attack: 6 + 2N<br />N = #Magic + #Dungeon]]></effect>
    <code><![CDATA[
    $tmp = $mydata->Magic + $mydata->Dungeons;
    $hisdata->attack(6 + 2 * $tmp);
]]></code>
    <created>2011-01-01</created>
    <modified>2011-01-01</modified>
  </card>
  <card id="622">
    <name>Dragon nest</name>
    <class>Rare</class>
    <cost>
      <bricks>11</bricks>
      <gems>11</gems>
      <recruits>11</recruits>
    </cost>
    <level>1</level>
    <effect><![CDATA[Magic: +1<br />Dungeon: +1<br />Summons a rare <b>Dragon</b>]]></effect>
    <code><![CDATA[
    $mydata->Magic+= 1; $mydata->Dungeons+= 1;
    $nextcard = $this->drawCard($this->getList(['class'=>'Rare', 'keyword'=>'Dragon']), $mydata->Hand, $cardpos, 'drawCardList');
]]></code>
    <created>2011-01-01</created>
    <modified>2011-01-01</modified>
  </card>
  <card id="623">
    <name>Reunion of the tribes</name>
    <class>Rare</class>
    <cost>
      <recruits>1</recruits>
    </cost>
    <level>9</level>
    <effect><![CDATA[Recruits: +45<br />Enemy wall: +120<br />Replace your hand with Marauder, Tarkhan, Berserker, Gladiator, Warchief, Devastator, Warlord and Urk the Conqueror]]></effect>
    <code><![CDATA[
    $mydata->Recruits+= 45; $hisdata->Wall+= 120;
    $this->setHandShuffled('my', [45, 334, 281, 68, 344, 345, 337, 535]); $nextcard = 0;
]]></code>
    <created>2011-01-01</created>
    <modified>2015-08-01</modified>
  </card>
  <card id="624">
    <name>Dwarven dome</name>
    <class>Common</class>
    <cost>
      <bricks>7</bricks>
    </cost>
    <level>9</level>
    <keywords>Runic</keywords>
    <effect><![CDATA[If Tower < 65<br />Tower: +7<br />else<br />Wall: +9]]></effect>
    <code><![CDATA[if ($mydata->Tower < 65) $mydata->Tower+= 7; else $mydata->Wall+= 9;]]></code>
    <created>2011-04-24</created>
    <modified>2012-09-08</modified>
  </card>
  <card id="625">
    <name>Shifting mass</name>
    <class>Common</class>
    <cost>
      <bricks>3</bricks>
      <gems>3</gems>
      <recruits>3</recruits>
    </cost>
    <level>10</level>
    <effect><![CDATA[Summons highest cost card in game (can't summon self)]]></effect>
    <code><![CDATA[
    $high = $costs = array();
    $max = 0;
    for ($i = 1; $i <= 8; $i++) {
      if ($i != $cardpos and $card->id() != $mydata->Hand[$i]) {
        $cur_cost = $costs[$i] = $this->getCard($mydata->Hand[$i])->getResources();
        if ($cur_cost > $max) $max = $cur_cost;
      }
      if ($card->id() != $hisdata->Hand[$i]) {
        $cur_cost = $costs[$i + 8] = $this->getCard($hisdata->Hand[$i])->getResources();
        if ($cur_cost > $max) $max = $cur_cost;
      }
    }
    for ($i = 1; $i <= 8; $i++) {
      if ($i != $cardpos and $card->id() != $mydata->Hand[$i] and $costs[$i] == $max) {
        $high[] = $mydata->Hand[$i];
      }
      if ($card->id() != $hisdata->Hand[$i] and $costs[$i + 8] == $max) {
        $high[] = $hisdata->Hand[$i];
      }
    }
    if (count($high) > 0) {
      $nextcard = $high[$this->arrayRand($high)];
    }
]]></code>
    <created>2011-04-24</created>
    <modified>2014-12-24</modified>
  </card>
  <card id="626">
    <name>Petrify</name>
    <class>Common</class>
    <cost>
      <bricks>2</bricks>
      <gems>2</gems>
    </cost>
    <modes>8</modes>
    <level>10</level>
    <effect><![CDATA[Tower: +3<br />Replace a non-<b>Unliving</b> card in hand with <b>Unliving</b> card of the same rarity]]></effect>
    <code><![CDATA[
    $mydata->Tower+= 3;
    $selected = $this->getCard($mydata->Hand[$mode]);
    if (!$selected->hasKeyword('Unliving')) {
      $this->setCard('my', $mode, $this->drawCard($this->getList(['class'=>$selected->getClass(), 'keyword'=>'Unliving']), $mydata->Hand, $mode, 'drawCardList'));
    }
]]></code>
    <created>2011-04-24</created>
    <modified>2011-12-24</modified>
  </card>
  <card id="627">
    <name>Shadow wolf</name>
    <class>Common</class>
    <cost>
      <gems>5</gems>
    </cost>
    <level>10</level>
    <keywords>Beast,Illusion</keywords>
    <effect><![CDATA[Attack: 4<br />Discard highest rarity discarding or replacing non-rare card from opponent's hand]]></effect>
    <code><![CDATA[
    $hisdata->attack(4);
    $storage = ['Common' => array(), 'Uncommon' => array()];
    $target_cards = array_merge($this->getList(['advanced'=>"Discard "]), $this->getList(['advanced'=>'Replace ']));
    
    for ($i = 1; $i <= 8; $i++) {
      if (in_array($hisdata->Hand[$i], $target_cards)) {
        $dis_card = $this->getCard($hisdata->Hand[$i]);
        $dis_class = $dis_card->getClass();
        if ($dis_class != 'Rare') $storage[$dis_class][] = $i;
      }
    }

    if ((count($storage['Common']) + count($storage['Uncommon'])) > 0) {
      shuffle($storage['Common']); shuffle($storage['Uncommon']);
      $storage_temp = array_merge($storage['Common'], $storage['Uncommon']);
      $discarded_pos = array_pop($storage_temp);
      $this->setCard('his', $discarded_pos, $this->drawCard($his_deck, $hisdata->Hand, $discarded_pos, 'drawCardDifferent'));
    }
]]></code>
    <created>2011-04-24</created>
    <modified>2011-12-24</modified>
  </card>
  <card id="628">
    <name>Pet dragon</name>
    <class>Common</class>
    <cost>
      <gems>5</gems>
      <recruits>5</recruits>
    </cost>
    <modes>2</modes>
    <level>6</level>
    <keywords>Alliance,Dragon</keywords>
    <effect><![CDATA[Attack: 5<br />Mode1:<br />Gems prod x2<br />Mode2:<br />Recruits prod x2]]></effect>
    <code><![CDATA[
    $hisdata->attack(5);
    if ($mode == 1) $production->multiplyGems(2);
    elseif ($mode == 2) $production->multiplyRecruits(2);
]]></code>
    <created>2011-04-24</created>
    <modified>2012-04-07</modified>
  </card>
  <card id="629">
    <name>Elven apprentice</name>
    <class>Common</class>
    <cost>
      <bricks>4</bricks>
      <gems>4</gems>
      <recruits>4</recruits>
    </cost>
    <modes>3</modes>
    <level>9</level>
    <keywords>Alliance</keywords>
    <effect><![CDATA[Summons<br />Mode1:<br />Master bricklayer<br />Mode2:<br />Book of magic<br />Mode3:<br />Blacksmith]]></effect>
    <code><![CDATA[
    if ($mode == 1) $nextcard = 22;
    elseif ($mode == 2) $nextcard = 34;
    elseif ($mode == 3) $nextcard = 12;
]]></code>
    <created>2011-04-24</created>
    <modified>2011-04-24</modified>
  </card>
  <card id="630">
    <name>Goblin tower</name>
    <class>Common</class>
    <level>8</level>
    <keywords>Horde</keywords>
    <effect><![CDATA[Tower: +7<br />Production x0]]></effect>
    <code><![CDATA[$mydata->Tower+= 7; $production->multiply(0);]]></code>
    <created>2011-04-24</created>
    <modified>2011-12-24</modified>
  </card>
  <card id="631">
    <name>Dwarven castle</name>
    <class>Uncommon</class>
    <cost>
      <bricks>5</bricks>
    </cost>
    <modes>2</modes>
    <level>10</level>
    <keywords>Runic</keywords>
    <effect><![CDATA[Mode1:<br />Tower: = 21<br />Mode2:<br />Wall: = 21]]></effect>
    <code><![CDATA[if ($mode == 1) $mydata->Tower = 21; elseif ($mode == 2) $mydata->Wall = 21;]]></code>
    <created>2011-04-24</created>
    <modified>2015-09-26</modified>
  </card>
  <card id="632">
    <name>Priestess of light</name>
    <class>Uncommon</class>
    <cost>
      <bricks>2</bricks>
      <gems>2</gems>
      <recruits>2</recruits>
    </cost>
    <modes>3</modes>
    <level>7</level>
    <keywords>Alliance,Holy</keywords>
    <effect><![CDATA[Mode1:<br />Bricks prod x3<br />Mode2:<br />Gems prod x3<br />Mode3:<br />Recruits prod x3]]></effect>
    <code><![CDATA[
    if ($mode == 1) $production->multiplyBricks(3);
    elseif ($mode == 2) $production->multiplyGems(3);
    elseif ($mode == 3) $production->multiplyRecruits(3);
]]></code>
    <created>2011-04-24</created>
    <modified>2011-04-24</modified>
  </card>
  <card id="633">
    <name>Scylla</name>
    <class>Uncommon</class>
    <cost>
      <gems>18</gems>
      <recruits>15</recruits>
    </cost>
    <level>8</level>
    <keywords>Aqua,Skirmisher</keywords>
    <effect><![CDATA[Enemy wall: -9<br />Attack: N<br />N = #Enemy tower (max 30)]]></effect>
    <code><![CDATA[$hisdata->Wall-= 9; $hisdata->attack(min(30, $hisdata->Tower));]]></code>
    <created>2011-04-24</created>
    <modified>2011-04-24</modified>
  </card>
  <card id="634">
    <name>Suzaku</name>
    <class>Rare</class>
    <cost>
      <gems>42</gems>
      <recruits>42</recruits>
    </cost>
    <level>9</level>
    <keywords>Burning</keywords>
    <effect><![CDATA[Attack: 10N<br />N = sum of three highest facilities in game]]></effect>
    <code><![CDATA[
    $facilities = [$mydata->Quarry, $mydata->Magic, $mydata->Dungeons, $hisdata->Quarry, $hisdata->Magic, $hisdata->Dungeons];
    sort($facilities);
    $sum = 0;
    for ($i = 1; $i <= 3; $i++) {
      $val = array_pop($facilities);
      $sum+= $val;
    }
    $hisdata->attack(10 * $sum);
]]></code>
    <created>2011-04-24</created>
    <modified>2011-12-24</modified>
  </card>
  <card id="635">
    <name>Hydra</name>
    <class>Rare</class>
    <cost>
      <recruits>10</recruits>
    </cost>
    <level>8</level>
    <keywords>Dragon</keywords>
    <effect><![CDATA[Replace neighbouring cards with Hydra<br />Attack: 5N<br />N = #Hydra cards in game]]></effect>
    <code><![CDATA[
    if ($cardpos > 1) {
      $this->setCard('my', $cardpos - 1, 635, ['reveal' => true]);
    }
    if ($cardpos < 8) {
      $this->setCard('my', $cardpos + 1, 635, ['reveal' => true]);
    }
    $tmp = 0;
    for ($i = 1; $i <= 8; $i++) {
      if ($mydata->Hand[$i] == 635) $tmp++;
      if ($hisdata->Hand[$i] == 635) $tmp++;
    }
    $hisdata->attack(5 * $tmp);
]]></code>
    <created>2011-04-24</created>
    <modified>2015-09-26</modified>
  </card>
  <card id="636">
    <name>Mirror elemental</name>
    <class>Rare</class>
    <cost>
      <bricks>5</bricks>
      <gems>5</gems>
    </cost>
    <modes>8</modes>
    <level>7</level>
    <keywords>Illusion,Unliving</keywords>
    <effect><![CDATA[Wall: +15<br />Replace a card in hand with Mirror golem]]></effect>
    <code><![CDATA[$mydata->Wall+= 15; $this->setCard('my', $mode, 479, ['reveal' => true]); if ($mode == $cardpos) $nextcard = 0;]]></code>
    <created>2011-04-24</created>
    <modified>2015-09-26</modified>
  </card>
  <card id="637">
    <name>Bahamut</name>
    <class>Rare</class>
    <cost>
      <recruits>75</recruits>
    </cost>
    <level>10</level>
    <keywords>Dragon,Legend</keywords>
    <effect><![CDATA[Enemy wall: -80<br />Attack: 150]]></effect>
    <code><![CDATA[$hisdata->Wall-= 80; $hisdata->attack(150);]]></code>
    <created>2011-04-24</created>
    <modified>2011-04-24</modified>
  </card>
  <card id="638">
    <name>Standstill</name>
    <class>Common</class>
    <level>3</level>
    <effect><![CDATA[Tower: +4<br />Wall: +8<br />Enemy tower: +4<br />Enemy wall: +8]]></effect>
    <code><![CDATA[$mydata->Tower+= 4; $mydata->Wall+= 8; $hisdata->Tower+= 4; $hisdata->Wall+= 8;]]></code>
    <created>2011-09-24</created>
    <modified>2012-06-24</modified>
  </card>
  <card id="639">
    <name>Goblin heap</name>
    <class>Common</class>
    <level>8</level>
    <keywords>Horde</keywords>
    <effect><![CDATA[Wall: +10<br />Bricks prod x0<br />Recruits prod x0]]></effect>
    <code><![CDATA[$mydata->Wall+= 10; $production->multiplyBricks(0); $production->multiplyRecruits(0);]]></code>
    <created>2011-09-24</created>
    <modified>2011-12-24</modified>
  </card>
  <card id="640">
    <name>Gorgon</name>
    <class>Common</class>
    <level>7</level>
    <effect><![CDATA[Bricks: +5<br />Recruits: -5<br />Enemy bricks: +5<br />Enemy recruits: -5]]></effect>
    <code><![CDATA[$mydata->Bricks+= 5; $mydata->Recruits-= 5; $hisdata->Bricks+= 5; $hisdata->Recruits-= 5;]]></code>
    <created>2011-09-24</created>
    <modified>2012-06-24</modified>
  </card>
  <card id="641">
    <name>Samurai princess</name>
    <class>Rare</class>
    <level>9</level>
    <effect><![CDATA[Discard all rare cards from opponent's hand (opponent can't draw rare cards)]]></effect>
    <code><![CDATA[
    for ($i = 1; $i <= 8; $i++) {
      if ($this->getCard($hisdata->Hand[$i])->getClass() == 'Rare') {
        $this->setCard('his', $i, $this->drawCard($his_deck, $hisdata->Hand, $i, 'drawCardNoRare'));
      }
    }
]]></code>
    <created>2011-09-24</created>
    <modified>2011-09-24</modified>
  </card>
  <card id="642">
    <name>Arcane tome</name>
    <class>Rare</class>
    <cost>
      <gems>1</gems>
    </cost>
    <modes>8</modes>
    <level>5</level>
    <effect><![CDATA[Magic: +1<br />Replace a card in hand with Book of magic]]></effect>
    <code><![CDATA[
    $mydata->Magic+= 1; $this->setCard('my', $mode, 34, ['reveal' => true]);
    if ($mode == $cardpos) $nextcard = 0;
]]></code>
    <created>2011-09-24</created>
    <modified>2015-09-26</modified>
  </card>
  <card id="643">
    <name>Mason</name>
    <class>Rare</class>
    <cost>
      <bricks>1</bricks>
    </cost>
    <modes>8</modes>
    <level>2</level>
    <effect><![CDATA[Quarry: +1<br />Replace a card in hand with Master bricklayer]]></effect>
    <code><![CDATA[
    $mydata->Quarry+= 1; $this->setCard('my', $mode, 22, ['reveal' => true]);
    if ($mode == $cardpos) $nextcard = 0;
]]></code>
    <created>2011-09-24</created>
    <modified>2015-09-26</modified>
  </card>
  <card id="644">
    <name>Forge master</name>
    <class>Rare</class>
    <cost>
      <recruits>1</recruits>
    </cost>
    <modes>8</modes>
    <level>3</level>
    <effect><![CDATA[Dungeon: +1<br />Replace a card in hand with Blacksmith]]></effect>
    <code><![CDATA[
    $mydata->Dungeons+= 1; $this->setCard('my', $mode, 12, ['reveal' => true]);
    if ($mode == $cardpos) $nextcard = 0;
]]></code>
    <created>2011-09-24</created>
    <modified>2015-09-26</modified>
  </card>
  <card id="645">
    <name>Ancient power</name>
    <class>Common</class>
    <level>10</level>
    <effect><![CDATA[Players gain 1 stock for each rare card and each <b>Dragon</b> in their hand]]></effect>
    <code><![CDATA[
    $mine = $his = 0;
    for ($i = 1; $i <= 8; $i++) {
      if ($i != $cardpos and $this->getCard($mydata->Hand[$i])->getClass() == 'Rare') $mine++;
      if ($this->getCard($hisdata->Hand[$i])->getClass() == 'Rare') $his++;
    }
    $mine+= $this->keywordCount($mydata->Hand, 'Dragon');
    $his+= $this->keywordCount($hisdata->Hand, 'Dragon');
    $mydata->addStock($mine);
    $hisdata->addStock($his);
]]></code>
    <created>2011-09-24</created>
    <modified>2011-09-24</modified>
  </card>
  <card id="646">
    <name>Northern archer</name>
    <class>Common</class>
    <cost>
      <recruits>1</recruits>
    </cost>
    <level>10</level>
    <keywords>Barbarian,Far sight</keywords>
    <effect><![CDATA[Enemy tower: -N<br />Enemy wall: +N<br />N = #<b>Barbarian</b> in hand]]></effect>
    <code><![CDATA[
    $tmp = $this->keywordCount($mydata->Hand, 'Barbarian');
    $hisdata->Tower-= $tmp; $hisdata->Wall+= $tmp;
]]></code>
    <created>2011-09-24</created>
    <modified>2012-04-07</modified>
  </card>
  <card id="647">
    <name>Guardian spirit</name>
    <class>Common</class>
    <cost>
      <gems>2</gems>
    </cost>
    <level>6</level>
    <keywords>Restoration</keywords>
    <effect><![CDATA[Tower: +2<br />If Tower or Wall was damaged during opponent's last round<br />Wall: +8]]></effect>
    <code><![CDATA[$mydata->Tower+= 2; if ($mychanges['Tower'] < 0 or $mychanges['Wall'] < 0) $mydata->Wall+= 8;]]></code>
    <created>2011-09-24</created>
    <modified>2011-09-24</modified>
  </card>
  <card id="648">
    <name>Water ritual</name>
    <class>Rare</class>
    <cost>
      <bricks>8</bricks>
      <gems>8</gems>
      <recruits>8</recruits>
    </cost>
    <level>3</level>
    <keywords>Aqua</keywords>
    <effect><![CDATA[Summons Ocean queen]]></effect>
    <code><![CDATA[$nextcard = 530;]]></code>
    <created>2011-09-24</created>
    <modified>2011-09-24</modified>
  </card>
  <card id="649">
    <name>Zeus</name>
    <class>Rare</class>
    <cost>
      <gems>30</gems>
      <recruits>30</recruits>
    </cost>
    <level>5</level>
    <effect><![CDATA[Enemy tower:= 10<br />Enemy wall:= 10]]></effect>
    <code><![CDATA[$hisdata->Tower = 10; $hisdata->Wall = 10;]]></code>
    <created>2011-09-24</created>
    <modified>2011-09-24</modified>
  </card>
  <card id="650">
    <name>Baku</name>
    <class>Common</class>
    <cost>
      <gems>6</gems>
    </cost>
    <level>8</level>
    <keywords>Beast,Illusion</keywords>
    <effect><![CDATA[Attack: 6<br />Summons a card from opponent's deck]]></effect>
    <code><![CDATA[$hisdata->attack(6); $nextcard = $this->drawCard(array_merge($his_deck->Common, $his_deck->Uncommon, $his_deck->Rare), $mydata->Hand, $cardpos, 'drawCardList');]]></code>
    <created>2011-09-24</created>
    <modified>2014-04-21</modified>
  </card>
  <card id="651">
    <name>Amazon warrior</name>
    <class>Common</class>
    <cost>
      <recruits>6</recruits>
    </cost>
    <level>7</level>
    <keywords>Barbarian</keywords>
    <effect><![CDATA[If Enemy wall > 30<br />Enemy wall: -10<br />Always:<br />Attack: 7]]></effect>
    <code><![CDATA[if ($hisdata->Wall > 30) $hisdata->Wall-= 10; $hisdata->attack(7);]]></code>
    <created>2011-09-24</created>
    <modified>2012-04-07</modified>
  </card>
  <card id="652">
    <name>Tsunami</name>
    <class>Rare</class>
    <cost>
      <gems>15</gems>
    </cost>
    <level>9</level>
    <keywords>Aqua,Durable</keywords>
    <effect><![CDATA[Discard opponent's hand (opponent can't draw rare cards)]]></effect>
    <code><![CDATA[$this->setHand('his', $this->drawHandNoRare($his_deck));]]></code>
    <created>2011-09-24</created>
    <modified>2011-09-24</modified>
  </card>
  <card id="653">
    <name>Elven sorceress</name>
    <class>Common</class>
    <cost>
      <gems>3</gems>
    </cost>
    <level>5</level>
    <keywords>Alliance,Mage</keywords>
    <effect><![CDATA[Attack: 3<br />If Gems < Enemy gems<br />Gems prod x2]]></effect>
    <code><![CDATA[$hisdata->attack(3); if ($mydata->Gems < $hisdata->Gems) $production->multiplyGems(2);]]></code>
    <created>2011-09-24</created>
    <modified>2011-09-24</modified>
  </card>
  <card id="654">
    <name>Academy</name>
    <class>Rare</class>
    <cost>
      <bricks>10</bricks>
      <gems>10</gems>
      <recruits>10</recruits>
    </cost>
    <level>7</level>
    <keywords>Durable</keywords>
    <effect><![CDATA[Tower: +15<br />Lowest facility: +1<br />Highest facility prod x0]]></effect>
    <code><![CDATA[$mydata->Tower+= 15; $mydata->addLowestFacility(1); $production->multiply(0, $mydata->detectHighestFacility());]]></code>
    <created>2011-09-24</created>
    <modified>2012-12-24</modified>
  </card>
  <card id="655">
    <name>Elven market</name>
    <class>Common</class>
    <cost>
      <recruits>1</recruits>
    </cost>
    <level>10</level>
    <keywords>Alliance</keywords>
    <effect><![CDATA[Production x2<br />You lose 1 random resource for each non-<b>Alliance</b> card in hand]]></effect>
    <code><![CDATA[
    $production->multiply(2);
    for ($i = 1; $i <= 8; $i++) {
      if ($i != $cardpos and !$this->getCard($mydata->Hand[$i])->hasKeyword('Alliance')) {
        $mydata->addRandomResources(-1);
      }
    }
]]></code>
    <created>2011-09-24</created>
    <modified>2011-09-24</modified>
  </card>
  <card id="656">
    <name>Orc engineer</name>
    <class>Uncommon</class>
    <level>7</level>
    <keywords>Horde</keywords>
    <effect><![CDATA[Tower: +17<br />Quarry: -1<br />Won't raise tower above 65]]></effect>
    <code><![CDATA[$tmp = max($mydata->Tower, 65); $mydata->Tower+= 17; $mydata->Quarry-= 1; $mydata->Tower = min($mydata->Tower, $tmp);]]></code>
    <created>2012-01-06</created>
    <modified>2013-07-27</modified>
  </card>
  <card id="657">
    <name>Thunderbird</name>
    <class>Common</class>
    <cost>
      <gems>6</gems>
    </cost>
    <level>8</level>
    <keywords>Beast,Destruction</keywords>
    <effect><![CDATA[If last card played cost gems<br />Enemy stock: -3<br />else<br />Gems: +9]]></effect>
    <code><![CDATA[
    if ($mylast_action == 'play' and $mylast_card->getResources('Gems') > 0) {
      $hisdata->addStock(-3);
    }
    else {
      $mydata->Gems+= 9;
    }
]]></code>
    <created>2012-01-06</created>
    <modified>2012-01-06</modified>
  </card>
  <card id="658">
    <name>Orc banner</name>
    <class>Common</class>
    <cost>
      <bricks>5</bricks>
      <recruits>1</recruits>
    </cost>
    <modes>8</modes>
    <level>9</level>
    <effect><![CDATA[Tower: +2<br />Recruits prod x2<br />Replace a card in hand with non-rare <b>Horde</b>]]></effect>
    <code><![CDATA[
    $mydata->Tower+= 2; $production->multiplyRecruits(2);
    $common = $this->getList(['class'=>'Common', 'keyword'=>'Horde']);
    $uncommon = $this->getList(['class'=>'Uncommon', 'keyword'=>'Horde']);
    $this->setCard('my', $mode, $this->drawCard(array_merge($common, $uncommon), $mydata->Hand, $mode, 'drawCardList'));
    if ($mode == $cardpos) $nextcard = 0;
]]></code>
    <created>2012-01-06</created>
    <modified>2012-04-07</modified>
  </card>
  <card id="659">
    <name>Elven rogue</name>
    <class>Common</class>
    <cost>
      <recruits>6</recruits>
    </cost>
    <level>10</level>
    <keywords>Alliance,Brigand</keywords>
    <effect><![CDATA[Attack: 8 - N<br />Steals N random resources<br />N = #<b>Alliance</b> in opponent's hand]]></effect>
    <code><![CDATA[
    $count = $this->keywordCount($hisdata->Hand, 'Alliance');
    $hisdata->attack(8 - $count);
    $mydata->addRandomResources($count);
    $hisdata->addRandomResources(-$count);
]]></code>
    <created>2012-01-06</created>
    <modified>2012-09-08</modified>
  </card>
  <card id="660">
    <name>Ambassador</name>
    <class>Common</class>
    <level>9</level>
    <effect><![CDATA[Gain 1 stock for each card in hand not from your deck (max 4)]]></effect>
    <code><![CDATA[
    $deck_cards = array_merge($my_deck->Common, $my_deck->Uncommon, $my_deck->Rare);
    $count = 0;
    for ($i = 1; $i <= 8; $i++) {
      if (!in_array($mydata->Hand[$i], $deck_cards) and $i != $cardpos) {
        $count++;
      }
    }
    $mydata->addStock(min($count, 4));
]]></code>
    <created>2012-01-06</created>
    <modified>2012-04-07</modified>
  </card>
  <card id="661">
    <name>River knight</name>
    <class>Common</class>
    <cost>
      <recruits>4</recruits>
      <gems>4</gems>
    </cost>
    <level>9</level>
    <keywords>Aqua,Skirmisher</keywords>
    <effect><![CDATA[Attack: 5 + N<br />N = #<b>Aqua</b> in hand]]></effect>
    <code><![CDATA[$tmp = $this->keywordCount($mydata->Hand, 'Aqua'); $hisdata->attack(5 + $tmp);]]></code>
    <created>2012-01-06</created>
    <modified>2012-04-07</modified>
  </card>
  <card id="662">
    <name>Moon empire</name>
    <class>Rare</class>
    <cost>
      <gems>1</gems>
    </cost>
    <level>8</level>
    <effect><![CDATA[Replace your hand with Moon shrine, Moon priestess, Samurai, Ninja, Shogun, Standstill, Moon castle and Samurai princess]]></effect>
    <code><![CDATA[$this->setHandShuffled('my', [487, 433, 51, 76, 681, 638, 583, 641]); $nextcard = 0;]]></code>
    <created>2012-01-06</created>
    <modified>2012-06-24</modified>
  </card>
  <card id="663">
    <name>Mountain unicorn</name>
    <class>Rare</class>
    <cost>
      <bricks>12</bricks>
      <recruits>12</recruits>
      <gems>12</gems>
    </cost>
    <level>0</level>
    <keywords>Legend,Runic</keywords>
    <effect><![CDATA[Attack: 20<br />Wall: +20<br />Quarry: +1]]></effect>
    <code><![CDATA[$hisdata->attack(20); $mydata->Wall+= 20; $mydata->Quarry+= 1;]]></code>
    <created>2012-01-06</created>
    <modified>2014-04-21</modified>
  </card>
  <card id="664">
    <name>Alchemist</name>
    <class>Rare</class>
    <level>8</level>
    <keywords>Restoration</keywords>
    <effect><![CDATA[Bricks:= N<br />Gems:= N<br />Recruits:= N<br />N = #Stock / 3]]></effect>
    <code><![CDATA[$mydata->setStock(round(($mydata->Bricks + $mydata->Gems + $mydata->Recruits) / 3));]]></code>
    <created>2012-01-06</created>
    <modified>2012-04-07</modified>
  </card>
  <card id="665">
    <name>Huo-Ryu</name>
    <class>Rare</class>
    <cost>
      <recruits>20</recruits>
      <gems>20</gems>
    </cost>
    <level>7</level>
    <keywords>Burning,Dragon</keywords>
    <effect><![CDATA[Attack: 30 + 10N<br />N = #<b>Dragon</b> in game]]></effect>
    <code><![CDATA[
    $tmp = $this->keywordCount($mydata->Hand, 'Dragon') + $this->keywordCount($hisdata->Hand, 'Dragon');
    $hisdata->attack(30 + 10 * $tmp);
]]></code>
    <created>2012-01-06</created>
    <modified>2012-01-06</modified>
  </card>
  <card id="666">
    <name>Tavern</name>
    <class>Common</class>
    <cost>
      <bricks>7</bricks>
    </cost>
    <level>10</level>
    <keywords>Runic</keywords>
    <effect><![CDATA[Wall: +8 - N<br />Recruits: +N<br />N = #<b>Barbarian</b> + #<b>Runic</b> + #<b>Soldier</b> in hand]]></effect>
    <code><![CDATA[
    $tmp = $this->keywordCount($mydata->Hand, 'Barbarian') + $this->keywordCount($mydata->Hand, 'Runic') + $this->keywordCount($mydata->Hand, 'Soldier');
    $mydata->Wall+= (8 - $tmp);
    $mydata->Recruits+= $tmp;
]]></code>
    <created>2012-01-06</created>
    <modified>2012-04-07</modified>
  </card>
  <card id="667">
    <name>Prairie</name>
    <class>Common</class>
    <cost>
      <recruits>1</recruits>
    </cost>
    <level>10</level>
    <effect><![CDATA[Gain 1 random resource for each non-attack card in hand]]></effect>
    <code><![CDATA[
    $attack_cards = $this->getList(['advanced'=>'Attack:']);
    for ($i = 1; $i <= 8; $i++) {
      if ($i != $cardpos and !in_array($mydata->Hand[$i], $attack_cards)) {
        $mydata->addRandomResources(1);
      }
    }
]]></code>
    <created>2012-01-06</created>
    <modified>2012-04-07</modified>
  </card>
  <card id="668">
    <name>Reiji Maigo</name>
    <class>Rare</class>
    <cost>
      <gems>1</gems>
    </cost>
    <level>10</level>
    <keywords>Restoration,Durable</keywords>
    <effect><![CDATA[If Round is divisible by 3<br />Gems: +15]]></effect>
    <code><![CDATA[if (($round % 3) == 0) $mydata->Gems+= 15;]]></code>
    <created>2012-06-24</created>
    <modified>2012-09-08</modified>
  </card>
  <card id="669">
    <name>Steelbeard</name>
    <class>Rare</class>
    <cost>
      <recruits>6</recruits>
    </cost>
    <level>9</level>
    <keywords>Brigand,Durable</keywords>
    <effect><![CDATA[If last card played wasn't Steelbeard<br />Production x0<br />Replace highest rarity card in opponent's hand with Hidden treasure]]></effect>
    <code><![CDATA[
    if ($mylast_action != 'play' || $mylast_card->id() != $card->id()) {
      $production->multiply(0);
      $storage = ['Common' => array(), 'Uncommon' => array(), 'Rare' => array()];
      for ($i = 1; $i <= 8; $i++) {
        $cur_card = $this->getCard($hisdata->Hand[$i]);
        $rarity = $cur_card->getClass();
        $storage[$rarity][] = $i;
      }
      if ((count($storage['Common']) + count($storage['Uncommon']) + count($storage['Rare'])) > 0) {
        shuffle($storage['Common']); shuffle($storage['Uncommon']); shuffle($storage['Rare']);
        $storage_temp = array_merge($storage['Common'], $storage['Uncommon'], $storage['Rare']);
        $discarded_pos = array_pop($storage_temp);
        $this->setCard('his', $discarded_pos, 274, ['reveal' => true]);
      }
    }
]]></code>
    <created>2012-06-24</created>
    <modified>2015-09-26</modified>
  </card>
  <card id="670">
    <name>Mother of dragons</name>
    <class>Rare</class>
    <cost>
      <recruits>12</recruits>
    </cost>
    <modes>8</modes>
    <level>9</level>
    <keywords>Dragon,Legend</keywords>
    <effect><![CDATA[Replace a card in hand with a rare <b>Dragon</b>]]></effect>
    <code><![CDATA[
    $dragon = $this->getList(['class'=>'Rare', 'keyword'=>'Dragon']);
    $this->setCard('my', $mode, $this->drawCard($dragon, $mydata->Hand, $mode, 'drawCardList'));
    if ($mode == $cardpos) $nextcard = 0;
]]></code>
    <created>2012-06-24</created>
    <modified>2012-09-08</modified>
  </card>
  <card id="671">
    <name>Sellsword</name>
    <class>Rare</class>
    <cost>
      <recruits>40</recruits>
    </cost>
    <level>6</level>
    <keywords>Soldier,Horde</keywords>
    <effect><![CDATA[Attack: 30<br />If not in your deck<br />Attack: 60<br />else<br />Recruits: +20]]></effect>
    <code><![CDATA[
    $hisdata->attack(30);
    if (!in_array($card->id(), $my_deck->Rare)) $hisdata->attack(60);
    else $mydata->Recruits+= 20;
]]></code>
    <created>2012-06-24</created>
    <modified>2012-09-08</modified>
  </card>
  <card id="672">
    <name>Dreamweaver</name>
    <class>Rare</class>
    <cost>
      <gems>11</gems>
    </cost>
    <level>7</level>
    <keywords>Illusion</keywords>
    <effect><![CDATA[Attack: 22<br />Summons Wish or Eternal dream]]></effect>
    <code><![CDATA[
    $hisdata->attack(22);
    $nextcard = $this->drawCard([620, 592], $mydata->Hand, $cardpos, 'drawCardList');
]]></code>
    <created>2012-06-24</created>
    <modified>2012-06-24</modified>
  </card>
  <card id="673">
    <name>Nightmare owl</name>
    <class>Uncommon</class>
    <cost>
      <gems>10</gems>
    </cost>
    <level>8</level>
    <keywords>Illusion,Aria</keywords>
    <effect><![CDATA[Attack: 10<br />If last card was discarded<br />Summons a rare card]]></effect>
    <code><![CDATA[
    $hisdata->attack(10);
    if ($mylast_action == 'discard') {
      $nextcard = $this->drawCard($this->getList(['class'=>'Rare']), $mydata->Hand, $cardpos, 'drawCardList');
    }
]]></code>
    <created>2012-06-24</created>
    <modified>2013-07-27</modified>
  </card>
  <card id="674">
    <name>Spirit of Air</name>
    <class>Rare</class>
    <level>10</level>
    <keywords>Quick,Aria</keywords>
    <effect><![CDATA[Replace neighbouring cards with non-common <b>Aria</b> (can't summon self)]]></effect>
    <code><![CDATA[
    $uncommon = $this->getList(['class'=>'Uncommon', 'keyword'=>'Aria']);
    $rare = $this->getList(['class'=>'Rare', 'keyword'=>'Aria']);
    $aria = array_merge($uncommon, $rare);
    $aria = array_diff($aria, [$card->id()]);
    if ($cardpos > 1) {
      $this->setCard('my', $cardpos - 1, $this->drawCard($aria, $mydata->Hand, $cardpos - 1, 'drawCardList'));
    }
    if ($cardpos < 8) {
      $this->setCard('my', $cardpos + 1, $this->drawCard($aria, $mydata->Hand, $cardpos + 1, 'drawCardList'));
    }
]]></code>
    <created>2012-06-24</created>
    <modified>2012-06-24</modified>
  </card>
  <card id="675">
    <name>Spirit of Earth</name>
    <class>Common</class>
    <cost>
      <bricks>10</bricks>
    </cost>
    <level>10</level>
    <keywords>Alliance,Unliving</keywords>
    <effect><![CDATA[Attack: 3<br />Wall: +7<br />If matching card is an attack card<br />Bricks prod x2]]></effect>
    <code><![CDATA[
    $hisdata->attack(3);
    $mydata->Wall+= 7;
    $attack_cards = $this->getList(['advanced'=>'Attack:']);
    if (in_array($hisdata->Hand[$cardpos], $attack_cards)) $production->multiplyBricks(2);
]]></code>
    <created>2012-06-24</created>
    <modified>2013-07-27</modified>
  </card>
  <card id="676">
    <name>Steam golem</name>
    <class>Rare</class>
    <cost>
      <bricks>42</bricks>
    </cost>
    <level>10</level>
    <keywords>Unliving,Charge (18)</keywords>
    <effect><![CDATA[Enemy wall: -38<br />Bricks: +21<br />Replace neighbouring cards with Wind<br />Summons Reuse the rubble]]></effect>
    <code><![CDATA[
    $hisdata->Wall-= 38; $mydata->Bricks+=21;
    if ($cardpos > 1) {
      $this->setCard('my', $cardpos - 1, 247, ['reveal' => true]);
    }
    if ($cardpos < 8) {
      $this->setCard('my', $cardpos + 1, 247, ['reveal' => true]);
    }
    $this->setCard('my', $cardpos, 349, ['reveal' => true]);
    $nextcard = 0;
]]></code>
    <created>2012-06-24</created>
    <modified>2015-09-26</modified>
  </card>
  <card id="677">
    <name>Stymphalian birds</name>
    <class>Common</class>
    <cost>
      <recruits>2</recruits>
    </cost>
    <level>8</level>
    <keywords>Banish,Aria</keywords>
    <effect><![CDATA[Attack: N<br />Enemy recruits: -N<br />N = #Enemy dungeon]]></effect>
    <code><![CDATA[$hisdata->attack($hisdata->Dungeons); $hisdata->Recruits-= $hisdata->Dungeons;]]></code>
    <created>2012-06-24</created>
    <modified>2012-06-24</modified>
  </card>
  <card id="678">
    <name>Goblin emperor</name>
    <class>Rare</class>
    <cost>
      <recruits>30</recruits>
    </cost>
    <modes>8</modes>
    <level>8</level>
    <keywords>Horde</keywords>
    <effect><![CDATA[Attack: 25<br />Replace neighbouring cards with <b>Horde</b><br />Replace a card in hand with self]]></effect>
    <code><![CDATA[
    $hisdata->attack(25);
    if ($cardpos > 1) {
      $this->setCard('my', $cardpos - 1, $this->drawCard($this->getList(['keyword'=>'Horde']), $mydata->Hand, $cardpos - 1, 'drawCardList'));
    }
    if ($cardpos < 8) {
      $this->setCard('my', $cardpos + 1, $this->drawCard($this->getList(['keyword'=>'Horde']), $mydata->Hand, $cardpos + 1, 'drawCardList'));
    }
    if ($mode == $cardpos) $nextcard = 0;
    else $this->replaceCard('my', $mode, $card->id());
]]></code>
    <created>2012-06-24</created>
    <modified>2012-06-24</modified>
  </card>
  <card id="679">
    <name>Wind dragon</name>
    <class>Rare</class>
    <cost>
      <gems>9</gems>
    </cost>
    <level>7</level>
    <keywords>Dragon,Swift,Aria</keywords>
    <effect><![CDATA[Attack: 10<br />If matching card is a zero cost card<br />Attack: 10]]></effect>
    <code><![CDATA[
    $hisdata->attack(10);
    if ($this->getCard($hisdata->Hand[$cardpos])->getResources() == 0)
      $hisdata->attack(10);
]]></code>
    <created>2012-06-24</created>
    <modified>2012-06-24</modified>
  </card>
  <card id="680">
    <name>Iskander the Rider</name>
    <class>Rare</class>
    <cost>
      <recruits>60</recruits>
    </cost>
    <level>10</level>
    <keywords>Legend,Charge (40),Siege</keywords>
    <effect><![CDATA[Attack: 90]]></effect>
    <code><![CDATA[$hisdata->attack(90);]]></code>
    <created>2012-06-24</created>
    <modified>2012-06-24</modified>
  </card>
  <card id="681">
    <name>Shogun</name>
    <class>Rare</class>
    <level>9</level>
    <effect><![CDATA[Tower: +N<br />Wall: +N<br />N = #Facilities<br />Enemy tower: -#Enemy facilities]]></effect>
    <code><![CDATA[
    $my_faciltities = $mydata->Quarry + $mydata->Magic + $mydata->Dungeons;
    $his_faciltities = $hisdata->Quarry + $hisdata->Magic + $hisdata->Dungeons;
    $mydata->Tower+= $my_faciltities; $mydata->Wall+= $my_faciltities;
    $hisdata->Tower-= $his_faciltities;
]]></code>
    <created>2012-06-24</created>
    <modified>2012-06-24</modified>
  </card>
  <card id="682">
    <name>Windmill</name>
    <class>Common</class>
    <cost>
      <bricks>2</bricks>
    </cost>
    <level>8</level>
    <keywords>Aria</keywords>
    <effect><![CDATA[Tower: +2<br />Gain N random resources<br />N = #<b>Aria</b> in hand]]></effect>
    <code><![CDATA[$mydata->Tower+= 2; $mydata->addRandomResources($this->keywordCount($mydata->Hand, 'Aria'));]]></code>
    <created>2012-06-24</created>
    <modified>2012-06-24</modified>
  </card>
  <card id="683">
    <name>Harpy</name>
    <class>Common</class>
    <cost>
      <recruits>10</recruits>
    </cost>
    <level>9</level>
    <keywords>Aria,Siege</keywords>
    <effect><![CDATA[Attack: 10<br />If #<b>Aria</b> in opponent's hand = 0<br />Recruits: +5]]></effect>
    <code><![CDATA[$hisdata->attack(10); if ($this->keywordCount($hisdata->Hand, 'Aria') == 0) $mydata->Recruits+= 5;]]></code>
    <created>2012-06-24</created>
    <modified>2012-06-24</modified>
  </card>
  <card id="684">
    <name>Apostate</name>
    <class>Uncommon</class>
    <cost>
      <gems>10</gems>
    </cost>
    <modes>8</modes>
    <level>10</level>
    <keywords>Horde</keywords>
    <effect><![CDATA[Replace a card in hand with a <b>Horde</b> of the same rarity<br />Recruits prod x3]]></effect>
    <code><![CDATA[
    $class = $this->getCard($mydata->Hand[$mode])->getClass();
    $this->setCard('my', $mode, $this->drawCard(array_diff($this->getList(['class'=>$class, 'keyword'=>'Horde']), [$mydata->Hand[$mode]]), $mydata->Hand, $mode, 'drawCardList'));
    if ($mode == $cardpos) $nextcard = 0;
    $production->multiplyRecruits(3);
]]></code>
    <created>2012-06-24</created>
    <modified>2015-09-26</modified>
  </card>
  <card id="685">
    <name>Faceless</name>
    <class>Common</class>
    <cost>
      <recruits>5</recruits>
    </cost>
    <modes>8</modes>
    <level>10</level>
    <keywords>Illusion</keywords>
    <effect><![CDATA[Replace a common card in opponent's hand with a common card from your deck<br />Attack: N<br />N = cost of the replaced card]]></effect>
    <code><![CDATA[
    $target_card = $this->getCard($hisdata->Hand[$mode]);
    if ($target_card->getClass() == 'Common') {
      $this->setCard('his', $mode, $this->drawCard($my_deck->Common, $hisdata->Hand, $mode, 'drawCardList'));
      $attack = $target_card->getResources();
      $hisdata->attack($attack);
    }
]]></code>
    <created>2012-06-24</created>
    <modified>2015-09-26</modified>
  </card>
  <card id="686">
    <name>Titan soldier</name>
    <class>Common</class>
    <cost>
      <recruits>3</recruits>
    </cost>
    <modes>8</modes>
    <level>10</level>
    <keywords>Soldier,Unliving</keywords>
    <effect><![CDATA[Attack: 3<br /><b>Titan</b> tokens: +10<br />Discard a card from hand]]></effect>
    <code><![CDATA[
    $hisdata->attack(3); $mydata->addToken('Titan', 10);
    if ($mode != $cardpos) {
      $this->setCard('my', $mode, $this->drawCard($my_deck, $mydata->Hand, $mode, 'drawCardRandom'));
    }
]]></code>
    <created>2013-01-01</created>
    <modified>2014-12-24</modified>
  </card>
  <card id="687">
    <name>Miriam</name>
    <class>Rare</class>
    <cost>
      <recruits>16</recruits>
    </cost>
    <level>10</level>
    <keywords>Alliance,Legend</keywords>
    <effect><![CDATA[Production x4<br />Summons non-common <b>Alliance</b>]]></effect>
    <code><![CDATA[
    $production->multiply(4);
    $uncommon = $this->getList(['class'=>'Uncommon', 'keyword'=>'Alliance']);
    $rare = $this->getList(['class'=>'Rare', 'keyword'=>'Alliance']);
    $nextcard = $this->drawCard(array_merge($uncommon, $rare), $mydata->Hand, $cardpos, 'drawCardList');
]]></code>
    <created>2013-01-01</created>
    <modified>2013-01-01</modified>
  </card>
  <card id="688">
    <name>Elven woods</name>
    <class>Common</class>
    <cost>
      <recruits>4</recruits>
    </cost>
    <level>10</level>
    <keywords>Alliance,Nature</keywords>
    <effect><![CDATA[Wall: +N<br />N = #<b>Alliance</b> in hand<br />Summons <b>Alliance</b>]]></effect>
    <code><![CDATA[
    $tmp = $this->keywordCount($mydata->Hand, 'Alliance');
    $mydata->Wall+= $tmp; 
    $nextcard = $this->drawCard($this->getList(['keyword'=>'Alliance']), $mydata->Hand, $cardpos, 'drawCardList');
]]></code>
    <created>2013-01-01</created>
    <modified>2013-01-01</modified>
  </card>
  <card id="689">
    <name>Mountain dragon</name>
    <class>Rare</class>
    <cost>
      <bricks>30</bricks>
      <recruits>25</recruits>
    </cost>
    <level>10</level>
    <keywords>Dragon,Runic</keywords>
    <effect><![CDATA[Attack: 38<br />Tower: +N / 2<br />Wall: +N<br />N = #Bricks (max 30)]]></effect>
    <code><![CDATA[
    $hisdata->attack(38);
    $bricks = min(30, $mydata->Bricks);
    $mydata->Tower+= round($bricks / 2);
    $mydata->Wall+= $bricks;
]]></code>
    <created>2013-01-01</created>
    <modified>2013-01-01</modified>
  </card>
  <card id="690">
    <name>Dryad of Miriam</name>
    <class>Common</class>
    <cost>
      <recruits>2</recruits>
    </cost>
    <level>10</level>
    <keywords>Alliance,Nature</keywords>
    <effect><![CDATA[Enemy wall: -3<br />If Enemy wall is divisible by 2<br />Recruits prod x2]]></effect>
    <code><![CDATA[$hisdata->Wall-= 3; if ((max(0, $hisdata->Wall) % 2) == 0) $production->multiplyRecruits(2);]]></code>
    <created>2013-01-01</created>
    <modified>2013-01-01</modified>
  </card>
  <card id="691">
    <name>Barbz's hideout</name>
    <class>Rare</class>
    <cost>
      <bricks>30</bricks>
    </cost>
    <level>10</level>
    <effect><![CDATA[Quarry: +1 for each rare in hand<br />Tower: +5 for each uncommon in hand<br />Wall: +8 for each common in hand]]></effect>
    <code><![CDATA[
    for ($i = 1; $i <= 8; $i++) {
      $cur_card = $this->getCard($mydata->Hand[$i]);
      if ($cur_card->getClass() == 'Rare') $mydata->Quarry+= 1;
      elseif ($cur_card->getClass() == 'Uncommon') $mydata->Tower+= 5;
      elseif ($cur_card->getClass() == 'Common') $mydata->Wall+= 8;
    }
]]></code>
    <created>2013-01-01</created>
    <modified>2013-01-01</modified>
  </card>
  <card id="692">
    <name>Emerald unicorn</name>
    <class>Rare</class>
    <cost>
      <recruits>20</recruits>
    </cost>
    <level>10</level>
    <keywords>Legend,Nature</keywords>
    <effect><![CDATA[Attack: 28<br />Dungeon: +1<br />Discard a rare <b>Nature</b> from hand to gain<br />Recruits: +20]]></effect>
    <code><![CDATA[
    $hisdata->attack(28); $mydata->Dungeons+= 1;
    $storage = array();
    for ($i = 1; $i <= 8; $i++) {
      $cur_card = $this->getCard($mydata->Hand[$i]);
      if ($i != $cardpos and $cur_card->hasKeyword('Nature') and $cur_card->getClass() == 'Rare')
        $storage[] = $i;
    }
    if (count($storage) > 0) {
      $discarded_pos = $storage[$this->arrayRand($storage)];
      $this->setCard('my', $discarded_pos, $this->drawCard($my_deck, $mydata->Hand, $discarded_pos, 'drawCardRandom'));
      $mydata->Recruits+= 20;
    }
]]></code>
    <created>2013-01-01</created>
    <modified>2013-01-01</modified>
  </card>
  <card id="693">
    <name>Myth summoner</name>
    <class>Rare</class>
    <cost>
      <gems>12</gems>
    </cost>
    <level>10</level>
    <keywords>Mage</keywords>
    <effect><![CDATA[Highest facility: +1<br />Summons Genbu, Seiryu, Byakko or Suzaku]]></effect>
    <code><![CDATA[
    $mydata->addHighestFacility(1);
    $nextcard = $this->drawCard([616, 577, 604, 634], $mydata->Hand, $cardpos, 'drawCardList');
]]></code>
    <created>2013-01-01</created>
    <modified>2013-01-01</modified>
  </card>
  <card id="694">
    <name>Harpy vanguard</name>
    <class>Common</class>
    <cost>
      <gems>1</gems>
      <recruits>2</recruits>
    </cost>
    <level>10</level>
    <keywords>Aria,Siege</keywords>
    <effect><![CDATA[Enemy tower: -1<br />Enemy wall: -1<br />Summons <b>Aria</b>]]></effect>
    <code><![CDATA[
    $hisdata->Tower-= 1; 
    $hisdata->Wall-= 1; 
    $nextcard = $this->drawCard($this->getList(['keyword'=>'Aria']), $mydata->Hand, $cardpos, 'drawCardList');
]]></code>
    <created>2013-01-01</created>
    <modified>2013-01-01</modified>
  </card>
  <card id="695">
    <name>Harpy warrior</name>
    <class>Uncommon</class>
    <cost>
      <gems>5</gems>
      <recruits>6</recruits>
    </cost>
    <level>10</level>
    <keywords>Aria,Siege</keywords>
    <effect><![CDATA[Attack: 2N<br />N = #<b>Aria</b> + #non-common cards in hand]]></effect>
    <code><![CDATA[
    $aria = $this->keywordCount($mydata->Hand, 'Aria');
    $noncommon =  0;
    for ($i = 1; $i <= 8; $i++) {
      if ($this->getCard($mydata->Hand[$i])->getClass() != 'Common') {
        $noncommon++;
      }
    }
    $hisdata->attack(2 * ($aria + $noncommon));
]]></code>
    <created>2013-01-01</created>
    <modified>2013-01-01</modified>
  </card>
  <card id="696">
    <name>Harpy hag</name>
    <class>Common</class>
    <cost>
      <gems>3</gems>
      <recruits>3</recruits>
    </cost>
    <level>10</level>
    <keywords>Aria,Siege</keywords>
    <effect><![CDATA[Attack: 3<br />If all cards in hand are common<br />Discard your hand and draw new starting hand]]></effect>
    <code><![CDATA[
    $hisdata->attack(3); $found = false;
    for ($i = 1; $i <= 8; $i++) {
      if ($i != $cardpos and $this->getCard($mydata->Hand[$i])->getClass() != 'Common') {
        $found = true; break;
      }
    }
    if (!$found) {
      $this->setHand('my', $this->drawHandInitial($my_deck));
      $nextcard = 0;
    }
]]></code>
    <created>2013-01-01</created>
    <modified>2013-01-01</modified>
  </card>
  <card id="697">
    <name>Harpy queen</name>
    <class>Rare</class>
    <cost>
      <gems>15</gems>
      <recruits>15</recruits>
    </cost>
    <level>10</level>
    <keywords>Aria,Siege</keywords>
    <effect><![CDATA[Attack: 15<br />Enemy tower: -10<br />Replace all tower+ and wall+ cards in opponent's hand with Wind]]></effect>
    <code><![CDATA[
    $hisdata->attack(15); $hisdata->Tower-= 10;
    $target_cards = array_merge($this->getList(['advanced'=>'Tower: +']), $this->getList(['advanced'=>'Wall: +']));
    for ($i = 1; $i <= 8; $i++) {
      if (in_array($hisdata->Hand[$i], $target_cards)) {
        $this->setCard('his', $i, 247, ['reveal' => true]);
      }
    }
]]></code>
    <created>2013-01-01</created>
    <modified>2015-09-26</modified>
  </card>
  <card id="698">
    <name>Justice</name>
    <class>Uncommon</class>
    <level>10</level>
    <effect><![CDATA[Player(s) with lowest tower gains<br />Tower: +10<br />Player(s) with lowest wall gains<br />Wall: +10]]></effect>
    <code><![CDATA[
    $my_tower = $mydata->Tower; $my_wall = $mydata->Wall;
    $his_tower = $hisdata->Tower; $his_wall = $hisdata->Wall;
    if ($my_tower <= $his_tower) $mydata->Tower+= 10;
    if ($my_wall <= $his_wall) $mydata->Wall+= 10;
    if ($my_tower >= $his_tower) $hisdata->Tower+= 10;
    if ($my_wall >= $his_wall) $hisdata->Wall+= 10;
]]></code>
    <created>2013-01-01</created>
    <modified>2013-01-01</modified>
  </card>
  <card id="699">
    <name>Einzbern castle</name>
    <class>Uncommon</class>
    <cost>
      <bricks>17</bricks>
    </cost>
    <level>10</level>
    <keywords>Illusion</keywords>
    <effect><![CDATA[Tower: +12<br />Wall: +3N<br />N = #<b>Illusion</b> + #rare cards in hand]]></effect>
    <code><![CDATA[
    $illusions = $this->keywordCount($mydata->Hand, 'Illusion');
    $mydata->Tower+= 12;
    $rares = 0;
    for ($i = 1; $i <= 8; $i++) {
      if ($i != $cardpos and $this->getCard($mydata->Hand[$i])->getClass() == 'Rare') {
        $rares++;
      }
    }
    $mydata->Wall+= 3 * ($illusions + $rares);
]]></code>
    <created>2013-01-01</created>
    <modified>2013-01-01</modified>
  </card>
  <card id="700">
    <name>Templar castle</name>
    <class>Uncommon</class>
    <cost>
      <bricks>20</bricks>
    </cost>
    <level>10</level>
    <keywords>Holy,Soldier</keywords>
    <effect><![CDATA[Tower: +30<br />Won't raise tower above Max tower / 2<br />If Dungeon < 4<br />Dungeon: +1]]></effect>
    <code><![CDATA[
    $tmp = max($mydata->Tower, round($max_tower / 2));
    $mydata->Tower+= 30;
    $mydata->Tower = min($mydata->Tower, $tmp);
    if ($mydata->Dungeons < 4) {
      $mydata->Dungeons++;
    }
]]></code>
    <created>2013-01-01</created>
    <modified>2015-09-26</modified>
  </card>
  <card id="701">
    <name>Stone dragon</name>
    <class>Rare</class>
    <cost>
      <bricks>30</bricks>
    </cost>
    <level>10</level>
    <keywords>Dragon,Unliving</keywords>
    <effect><![CDATA[Attack: 20<br />Wall: +25<br />Bricks prod x3]]></effect>
    <code><![CDATA[$hisdata->attack(20); $mydata->Wall+= 25; $production->multiplyBricks(3);]]></code>
    <created>2013-01-01</created>
    <modified>2013-01-01</modified>
  </card>
  <card id="702">
    <name>Centaur champion</name>
    <class>Rare</class>
    <cost>
      <recruits>40</recruits>
    </cost>
    <level>10</level>
    <keywords>Beast,Horde,Charge (30)</keywords>
    <effect><![CDATA[Attack: 30<br />Recruits prod x4]]></effect>
    <code><![CDATA[$hisdata->attack(30); $production->multiplyRecruits(4);]]></code>
    <created>2013-01-01</created>
    <modified>2013-10-19</modified>
  </card>
  <card id="703">
    <name>Northern scout</name>
    <class>Common</class>
    <level>10</level>
    <keywords>Barbarian</keywords>
    <effect><![CDATA[Wall: +N<br />Recruits: +N<br />N = #Enemy wall / 10]]></effect>
    <code><![CDATA[$tmp = round($hisdata->Wall / 10); $mydata->Wall+= $tmp; $mydata->Recruits+= $tmp;]]></code>
    <created>2013-01-01</created>
    <modified>2013-01-01</modified>
  </card>
  <card id="704">
    <name>Gate of Babylon</name>
    <class>Rare</class>
    <cost>
      <bricks>5</bricks>
      <gems>5</gems>
      <recruits>5</recruits>
    </cost>
    <level>10</level>
    <keywords>Durable</keywords>
    <effect><![CDATA[Replace neighbouring cards with rare cards]]></effect>
    <code><![CDATA[
    if ($cardpos > 1) {
      $this->setCard('my', $cardpos - 1, $this->drawCard($this->getList(['class'=>'Rare']), $mydata->Hand, $cardpos - 1, 'drawCardList'));
    }
    if ($cardpos < 8) {
      $this->setCard('my', $cardpos + 1, $this->drawCard($this->getList(['class'=>'Rare']), $mydata->Hand, $cardpos + 1, 'drawCardList'));
    }
]]></code>
    <created>2013-01-01</created>
    <modified>2013-01-01</modified>
  </card>
  <card id="705">
    <name>Overlord's castle</name>
    <class>Rare</class>
    <level>10</level>
    <keywords>Horde</keywords>
    <effect><![CDATA[Tower: +4N<br />Wall: +15<br />Production x0<br />N = #<b>Horde</b> in hand]]></effect>
    <code><![CDATA[$mydata->Tower+= 4 * $this->keywordCount($mydata->Hand, 'Horde'); $mydata->Wall+= 15; $production->multiply(0);]]></code>
    <created>2013-01-01</created>
    <modified>2013-01-01</modified>
  </card>
  <card id="706">
    <name>Talos</name>
    <class>Rare</class>
    <cost>
      <bricks>15</bricks>
      <gems>15</gems>
      <recruits>15</recruits>
    </cost>
    <level>10</level>
    <keywords>Legend,Unliving</keywords>
    <effect><![CDATA[Attack: 10 + 4N<br />N = #Facilities]]></effect>
    <code><![CDATA[$hisdata->attack(10 + 4 * ($mydata->Quarry + $mydata->Magic + $mydata->Dungeons));]]></code>
    <created>2013-01-01</created>
    <modified>2013-01-01</modified>
  </card>
  <card id="707">
    <name>Dragon bard</name>
    <class>Common</class>
    <cost>
      <recruits>6</recruits>
    </cost>
    <modes>8</modes>
    <level>10</level>
    <effect><![CDATA[Replace selected <b>Dragon</b> in hand with a <b>Dragon</b> of the same rarity or replace selected Dragon egg in hand with a <b>Dragon</b>]]></effect>
    <code><![CDATA[
    if ($mode != $cardpos) {
      $cur_card = $this->getCard($mydata->Hand[$mode]);
      if ($cur_card->id() == 131) {
        $this->setCard('my', $mode, $this->drawCard($this->getList(['keyword'=>'Dragon']), $mydata->Hand, $mode, 'drawCardList'));
      }
      elseif ($cur_card->hasKeyword('Dragon')) {
        $this->setCard('my', $mode, $this->drawCard(array_diff($this->getList(['class'=>$cur_card->getClass(), 'keyword'=>'Dragon']), [$cur_card->id()]), $mydata->Hand, $mode, 'drawCardList'));
      }
    }
]]></code>
    <created>2013-07-27</created>
    <modified>2013-07-27</modified>
  </card>
  <card id="708">
    <name>Darkling</name>
    <class>Common</class>
    <cost>
      <recruits>1</recruits>
    </cost>
    <level>10</level>
    <keywords>Horde</keywords>
    <effect><![CDATA[Wall: +5 - N<br />Steals N random resources<br />N = #zero cost cards in opponent's hand]]></effect>
    <code><![CDATA[
    $count = 0;
    for ($i = 1; $i <= 8; $i++) {
      if ($this->getCard($hisdata->Hand[$i])->getResources() == 0) {
        $count++;
      }
    }
    $mydata->Wall+= 5 - $count;
    $mydata->addRandomResources($count);
    $hisdata->addRandomResources(-$count);
]]></code>
    <created>2013-07-27</created>
    <modified>2013-07-27</modified>
  </card>
  <card id="709">
    <name>Shield guard</name>
    <class>Common</class>
    <cost>
      <bricks>5</bricks>
      <recruits>2</recruits>
    </cost>
    <level>10</level>
    <keywords>Runic</keywords>
    <effect><![CDATA[Wall: +7<br />Summons a Bricks only no keyword Wall + card]]></effect>
    <code><![CDATA[$mydata->Wall+= 7; $nextcard = $this->drawCard($this->getList(['cost'=>'Red', 'keyword'=>'No keywords', 'advanced'=>'Wall: +']), $mydata->Hand, $cardpos, 'drawCardList');]]></code>
    <created>2013-07-27</created>
    <modified>2013-07-27</modified>
  </card>
  <card id="710">
    <name>Acnologia</name>
    <class>Rare</class>
    <cost>
      <recruits>45</recruits>
    </cost>
    <level>10</level>
    <keywords>Destruction,Dragon</keywords>
    <effect><![CDATA[Enemy tower: -35<br />Enemy highest facility: -1]]></effect>
    <code><![CDATA[$hisdata->Tower-= 35; $hisdata->addHighestFacility(-1);]]></code>
    <created>2013-07-27</created>
    <modified>2013-07-27</modified>
  </card>
  <card id="711">
    <name>Mana spring</name>
    <class>Rare</class>
    <cost>
      <gems>1</gems>
    </cost>
    <level>10</level>
    <effect><![CDATA[Highest facility: +1<br />Highest resource: +10]]></effect>
    <code><![CDATA[$mydata->addHighestFacility(1); $mydata->addHighestResource(10);]]></code>
    <created>2013-07-27</created>
    <modified>2013-07-27</modified>
  </card>
  <card id="712">
    <name>Cheshire</name>
    <class>Rare</class>
    <cost>
      <gems>7</gems>
    </cost>
    <level>10</level>
    <keywords>Illusion</keywords>
    <effect><![CDATA[Replace other rare cards in hand with rare cards from your deck<br />Summons rare <b>Illusion</b>]]></effect>
    <code><![CDATA[
    for ($i = 1; $i <= 8; $i++) {
      if ($i != $cardpos and $this->getCard($mydata->Hand[$i])->getClass() == 'Rare') {
        $this->setCard('my', $i, $this->drawCard($my_deck->Rare, $mydata->Hand, $i, 'drawCardList'));
      }
    }
    $nextcard = $this->drawCard($this->getList(['class'=>'Rare', 'keyword'=>'Illusion']), $mydata->Hand, $cardpos, 'drawCardList');
]]></code>
    <created>2013-07-27</created>
    <modified>2013-07-27</modified>
  </card>
  <card id="713">
    <name>Ziz</name>
    <class>Rare</class>
    <cost>
      <gems>27</gems>
      <recruits>27</recruits>
    </cost>
    <level>10</level>
    <keywords>Aria</keywords>
    <effect><![CDATA[Enemy tower: -10N<br />N = #<b>Aria</b> in hand]]></effect>
    <code><![CDATA[$hisdata->Tower-= 10 * $this->keywordCount($mydata->Hand, 'Aria');]]></code>
    <created>2013-07-27</created>
    <modified>2013-07-27</modified>
  </card>
  <card id="714">
    <name>Kitsune</name>
    <class>Rare</class>
    <cost>
      <gems>12</gems>
    </cost>
    <level>10</level>
    <keywords>Beast,Illusion</keywords>
    <effect><![CDATA[Attack: 26<br />Replace opponent's hand with cards from your deck of the same rarity]]></effect>
    <code><![CDATA[
    $hisdata->attack(26);
    for ($i = 1; $i <= 8; $i++) {
      $rarity = $this->getCard($hisdata->Hand[$i])->getClass();
      $this->setCard('his', $i, $this->drawCard($my_deck->$rarity, $hisdata->Hand, $i, 'drawCardList'));
    }
]]></code>
    <created>2013-07-27</created>
    <modified>2013-07-27</modified>
  </card>
  <card id="715">
    <name>Phantom unicorn</name>
    <class>Rare</class>
    <cost>
      <gems>13</gems>
      <recruits>13</recruits>
    </cost>
    <level>10</level>
    <keywords>Illusion,Legend</keywords>
    <effect><![CDATA[Attack: 25<br />Replace all discarding and replacing cards in opponent's hand with common cards from his deck]]></effect>
    <code><![CDATA[
    $hisdata->attack(25);
    $target_cards = array_merge($this->getList(['advanced'=>"Discard "]), $this->getList(['advanced'=>'Replace ']));
    for ($i = 1; $i <= 8; $i++) {
      if (in_array($hisdata->Hand[$i], $target_cards)) {
        $this->setCard('his', $i, $this->drawCard($his_deck->Common, $hisdata->Hand, $i, 'drawCardList'));
      }
    }
]]></code>
    <created>2013-07-27</created>
    <modified>2013-07-27</modified>
  </card>
  <card id="716">
    <name>Heimdall</name>
    <class>Rare</class>
    <cost>
      <gems>14</gems>
      <recruits>16</recruits>
    </cost>
    <level>10</level>
    <keywords>Barbarian,Mage,Far sight</keywords>
    <effect><![CDATA[Attack: 30<br />Summons a rare <b>Far sight</b>]]></effect>
    <code><![CDATA[$hisdata->attack(30); $nextcard = $this->drawCard($this->getList(['class'=>'Rare', 'keyword'=>'Far sight']), $mydata->Hand, $cardpos, 'drawCardList');]]></code>
    <created>2013-07-27</created>
    <modified>2013-07-27</modified>
  </card>
  <card id="717">
    <name>Book of eternity</name>
    <class>Rare</class>
    <cost>
      <bricks>4</bricks>
      <gems>4</gems>
      <recruits>4</recruits>
    </cost>
    <level>10</level>
    <keywords>Durable</keywords>
    <effect><![CDATA[Discard all other cards from hand]]></effect>
    <code><![CDATA[
    for ($i = 1; $i <= 8; $i++) {
      if ($i != $cardpos) {
        $this->setCard('my', $i, $this->drawCard($my_deck, $mydata->Hand, $i, 'drawCardRandom'));
      }
    }
]]></code>
    <created>2014-01-01</created>
    <modified>2014-01-01</modified>
  </card>
  <card id="718">
    <name>Dwarven kingdom</name>
    <class>Rare</class>
    <cost>
      <bricks>5</bricks>
      <recruits>5</recruits>
    </cost>
    <level>10</level>
    <effect><![CDATA[Replace your hand with 3 common, 3 uncommon and 2 rare <b>Runic</b> cards]]></effect>
    <code><![CDATA[
    $trans = ['Common', 'Common', 'Common', 'Uncommon', 'Uncommon', 'Uncommon', 'Rare', 'Rare'];
    shuffle($trans);
    for ($i = 1; $i <= 8; $i++) {
      $this->setCard('my', $i, $this->drawCard($this->getList(['class'=>$trans[$i-1], 'keyword'=>'Runic']), $mydata->Hand, $i, 'drawCardList'));
    }
    $nextcard = 0;
]]></code>
    <created>2014-01-01</created>
    <modified>2014-01-01</modified>
  </card>
  <card id="719">
    <name>Adamantine citadel</name>
    <class>Rare</class>
    <cost>
      <bricks>30</bricks>
    </cost>
    <level>10</level>
    <keywords>Runic</keywords>
    <effect><![CDATA[Wall: +30<br />If Wall = Max wall<br />Instant construction victory<br />else<br />Bricks: +15]]></effect>
    <code><![CDATA[
    $mydata->Wall+= 30;
    if ($mydata->Wall >= $max_wall ) {
      $mydata->Tower = $max_tower;
    }
    else {
      $mydata->Bricks+= 15;
    }
]]></code>
    <created>2014-01-01</created>
    <modified>2014-01-01</modified>
  </card>
  <card id="720">
    <name>Ocean king</name>
    <class>Rare</class>
    <cost>
      <bricks>30</bricks>
      <gems>30</gems>
      <recruits>30</recruits>
    </cost>
    <level>10</level>
    <keywords>Aqua,Far sight</keywords>
    <effect><![CDATA[Tower: +40<br />Wall: +40<br />Facilities: +1]]></effect>
    <code><![CDATA[
    $mydata->Tower+= 40;
    $mydata->Wall+= 40;
    $mydata->addFacilities(1);
]]></code>
    <created>2014-01-01</created>
    <modified>2014-01-01</modified>
  </card>
  <card id="721">
    <name>Temptress</name>
    <class>Rare</class>
    <cost>
      <bricks>15</bricks>
      <recruits>15</recruits>
    </cost>
    <level>10</level>
    <keywords>Demonic</keywords>
    <effect><![CDATA[Attack: 30<br />If last card played was a rare<br />Enemy stock: -10<br />If last card played was <b>Demonic</b><br />Attack: 20]]></effect>
    <code><![CDATA[
    $hisdata->attack(30);
    if ($mylast_card->getClass() == 'Rare') {
      $hisdata->addStock(-10);
    }
    if ($mylast_card->hasKeyword('Demonic')) {
      $hisdata->attack(20);
    }
]]></code>
    <created>2014-01-01</created>
    <modified>2014-01-01</modified>
  </card>
  <card id="722">
    <name>Balrog</name>
    <class>Rare</class>
    <cost>
      <gems>20</gems>
      <recruits>20</recruits>
    </cost>
    <level>10</level>
    <keywords>Burning,Demonic</keywords>
    <effect><![CDATA[Attack: 50<br />Replace <b>Alliance</b>, <b>Mage</b>, <b>Runic</b> and <b>Soldier</b> in opponent's hand with Searing fire]]></effect>
    <code><![CDATA[
    $hisdata->attack(50);
    for ($i = 1; $i <= 8; $i++) {
      $his_card = $this->getCard($hisdata->Hand[$i]);
      if ($his_card->hasKeyword('Alliance') or $his_card->hasKeyword('Mage') or $his_card->hasKeyword('Runic') or $his_card->hasKeyword('Soldier')) {
        $this->setCard('his', $i, 248, ['reveal' => true]);
      }
    }
]]></code>
    <created>2014-01-01</created>
    <modified>2015-09-26</modified>
  </card>
  <card id="723">
    <name>Hell charger</name>
    <class>Common</class>
    <cost>
      <gems>3</gems>
      <recruits>3</recruits>
    </cost>
    <level>10</level>
    <keywords>Demonic,Charge (4)</keywords>
    <effect><![CDATA[Attack: 7]]></effect>
    <code><![CDATA[$hisdata->attack(7);]]></code>
    <created>2014-01-01</created>
    <modified>2014-01-01</modified>
  </card>
  <card id="724">
    <name>Quasit</name>
    <class>Common</class>
    <level>10</level>
    <keywords>Demonic</keywords>
    <effect><![CDATA[Gain 1 random resource for each unplayable card in game]]></effect>
    <code><![CDATA[
    $count = 0;
    for ($i = 1; $i <= 8; $i++) {
      $cur_card = $this->getCard($mydata->Hand[$i]);
      if ($i != $cardpos and ($cur_card->getResources('Bricks') > $mydata->Bricks or $cur_card->getResources('Gems') > $mydata->Gems or $cur_card->getResources('Recruits') > $mydata->Recruits)) {
        $count++;
      }
    }
    for ($i = 1; $i <= 8; $i++) {
      $cur_card = $this->getCard($hisdata->Hand[$i]);
      if ($cur_card->getResources('Bricks') > $hisdata->Bricks or $cur_card->getResources('Gems') > $hisdata->Gems or $cur_card->getResources('Recruits') > $hisdata->Recruits) {
        $count++;
      }
    }
    $mydata->addRandomResources($count);
]]></code>
    <created>2014-01-01</created>
    <modified>2014-01-01</modified>
  </card>
  <card id="725">
    <name>Demon fruit</name>
    <class>Common</class>
    <cost>
      <recruits>1</recruits>
    </cost>
    <level>10</level>
    <keywords>Demonic,Nature</keywords>
    <effect><![CDATA[Gain N random resources (min 4)<br />N = 25 - Tower]]></effect>
    <code><![CDATA[$mydata->addRandomResources(max(4, 25 - $mydata->Tower));]]></code>
    <created>2014-01-01</created>
    <modified>2015-08-01</modified>
  </card>
  <card id="726">
    <name>Cerberus</name>
    <class>Rare</class>
    <cost>
      <recruits>28</recruits>
    </cost>
    <level>10</level>
    <keywords>Beast,Demonic</keywords>
    <effect><![CDATA[Attack 30<br />Recruits prod x2<br />Replace matching card in opponent's hand and its neighbours with Purified ashes]]></effect>
    <code><![CDATA[
    $hisdata->attack(30);
    $production->multiplyRecruits(2);
    $this->setCard('his', $cardpos, 381, ['reveal' => true]);
    if ($cardpos > 1) {
      $this->setCard('his', $cardpos - 1, 381, ['reveal' => true]);
    }
    if ($cardpos < 8) {
      $this->setCard('his', $cardpos + 1, 381, ['reveal' => true]);
    }
]]></code>
    <created>2014-01-01</created>
    <modified>2015-09-26</modified>
  </card>
  <card id="727">
    <name>Hellmare</name>
    <class>Common</class>
    <cost>
      <gems>2</gems>
      <recruits>2</recruits>
    </cost>
    <level>10</level>
    <keywords>Demonic,Aria</keywords>
    <effect><![CDATA[Attack: 3<br />Gems: +N<br />Recruits: +N<br />N = #<b>Demonic</b> in hand (max 4)]]></effect>
    <code><![CDATA[
    $hisdata->attack(3);
    $tmp = min(4, $this->keywordCount($mydata->Hand, 'Demonic'));
    $mydata->Gems+= $tmp; $mydata->Recruits+= $tmp;
]]></code>
    <created>2015-01-01</created>
    <modified>2015-01-01</modified>
  </card>
  <card id="728">
    <name>Whirlpool</name>
    <class>Common</class>
    <cost>
      <gems>1</gems>
    </cost>
    <level>10</level>
    <keywords>Aqua</keywords>
    <effect><![CDATA[Discard neighbouring cards]]></effect>
    <code><![CDATA[
    if ($cardpos > 1) {
       $this->setCard('my', $cardpos - 1, $this->drawCard($my_deck, $mydata->Hand, $cardpos - 1, 'drawCardRandom'));
    }
    if ($cardpos < 8) {
      $this->setCard('my', $cardpos + 1, $this->drawCard($my_deck, $mydata->Hand, $cardpos + 1, 'drawCardRandom'));
    }
]]></code>
    <created>2015-01-01</created>
    <modified>2015-01-01</modified>
  </card>
  <card id="729">
    <name>Hydromancer</name>
    <class>Uncommon</class>
    <cost>
      <gems>7</gems>
    </cost>
    <modes>8</modes>
    <level>10</level>
    <keywords>Aqua,Mage</keywords>
    <effect><![CDATA[Attack: 6<br />Replace a card in hand with Whirlpool]]></effect>
    <code><![CDATA[$hisdata->attack(6); $this->setCard('my', $mode, 728, ['reveal' => true]); if ($mode == $cardpos) $nextcard = 0;]]></code>
    <created>2015-01-01</created>
    <modified>2015-09-26</modified>
  </card>
  <card id="730">
    <name>New growth</name>
    <class>Common</class>
    <cost>
      <recruits>1</recruits>
    </cost>
    <level>10</level>
    <keywords>Nature,Restoration</keywords>
    <effect><![CDATA[Stock: +1<br />If New<br />Stock: +1]]></effect>
    <code><![CDATA[$mydata->addStock((isset($mynewflags[$cardpos])) ? 2 : 1);]]></code>
    <created>2015-01-01</created>
    <modified>2015-01-01</modified>
  </card>
  <card id="731">
    <name>Ancient city</name>
    <class>Uncommon</class>
    <cost>
      <bricks>36</bricks>
    </cost>
    <level>10</level>
    <keywords>Legend</keywords>
    <effect><![CDATA[Wall: +40<br />Stock: +6<br />Summons a <b>Legend</b>]]></effect>
    <code><![CDATA[
    $mydata->Wall+= 40;
    $mydata->addStock(6);
    $nextcard = $this->drawCard($this->getList(['keyword'=>'Legend']), $mydata->Hand, $cardpos, 'drawCardList');
]]></code>
    <created>2015-01-01</created>
    <modified>2015-01-01</modified>
  </card>
  <card id="732">
    <name>Night demon</name>
    <class>Uncommon</class>
    <cost>
      <gems>7</gems>
      <recruits>9</recruits>
    </cost>
    <level>10</level>
    <keywords>Demonic</keywords>
    <effect><![CDATA[Attack: 20<br />If matching card in opponent's hand is unplayable<br />Discard the matching card]]></effect>
    <code><![CDATA[
    $hisdata->attack(20);
    if ($this->getCard($hisdata->Hand[$cardpos])->getResources('Bricks') > $hisdata->Bricks or $this->getCard($hisdata->Hand[$cardpos])->getResources('Gems') > $hisdata->Gems or $this->getCard($hisdata->Hand[$cardpos])->getResources('Recruits') > $hisdata->Recruits) {
      $this->setCard('his', $cardpos, $this->drawCard($his_deck, $hisdata->Hand, $cardpos, 'drawCardDifferent'));
    }
]]></code>
    <created>2015-01-01</created>
    <modified>2015-01-01</modified>
  </card>
  <card id="733">
    <name>Treetop village</name>
    <class>Uncommon</class>
    <cost>
      <bricks>10</bricks>
      <gems>11</gems>
    </cost>
    <level>10</level>
    <keywords>Alliance,Far sight</keywords>
    <effect><![CDATA[Wall: +15<br />Production x2<br />Summons <b>Alliance</b>]]></effect>
    <code><![CDATA[
    $mydata->Wall+= 15; 
    $production->multiply(2);
    $nextcard = $this->drawCard($this->getList(['keyword'=>'Alliance']), $mydata->Hand, $cardpos, 'drawCardList');
]]></code>
    <created>2015-01-01</created>
    <modified>2015-01-01</modified>
  </card>
  <card id="734">
    <name>Darklord Vashna</name>
    <class>Rare</class>
    <cost>
      <gems>19</gems>
      <recruits>19</recruits>
    </cost>
    <level>10</level>
    <keywords>Demonic</keywords>
    <effect><![CDATA[Attack: 30 + 5N<br />N = #<b>Demonic</b> in hand<br />Summons <b>Demonic</b>]]></effect>
    <code><![CDATA[
    $hisdata->attack(30 + 5 * $this->keywordCount($mydata->Hand, 'Demonic'));
    $nextcard = $this->drawCard($this->getList(['keyword'=>'Demonic']), $mydata->Hand, $cardpos, 'drawCardList');
]]></code>
    <created>2015-01-01</created>
    <modified>2015-01-01</modified>
  </card>
  <card id="735">
    <name>Geomancer</name>
    <class>Rare</class>
    <cost>
      <bricks>8</bricks>
      <gems>8</gems>
    </cost>
    <level>10</level>
    <keywords>Runic</keywords>
    <effect><![CDATA[Wall: +35<br />Enemy quarry: +2<br />Summons Wonder, Genbu or Implosion]]></effect>
    <code><![CDATA[
    $mydata->Wall+= 35;
    $hisdata->Quarry+= 2;
    $nextcard = $this->drawCard([100, 616, 221], $mydata->Hand, $cardpos, 'drawCardList');
]]></code>
    <created>2015-01-01</created>
    <modified>2015-01-01</modified>
  </card>
  <card id="736">
    <name>Reliquary</name>
    <class>Rare</class>
    <cost>
      <bricks>18</bricks>
      <gems>16</gems>
    </cost>
    <level>10</level>
    <keywords>Holy,Banish</keywords>
    <effect><![CDATA[Tower: +3N<br />Wall: +4N<br />Stock: +2N<br />N = #<b>Holy</b> in hand]]></effect>
    <code><![CDATA[
    $tmp = $this->keywordCount($mydata->Hand, 'Holy');
    $mydata->Tower+= 3 * $tmp;
    $mydata->Wall+= 4 * $tmp;
    $mydata->addStock(2 * $tmp);
]]></code>
    <created>2015-01-01</created>
    <modified>2015-01-01</modified>
  </card>
  <card id="737">
    <name>Blood shrine</name>
    <class>Common</class>
    <cost>
      <bricks>15</bricks>
    </cost>
    <level>10</level>
    <keywords>Demonic</keywords>
    <effect><![CDATA[Tower: +10<br />Wall: +10]]></effect>
    <code><![CDATA[$mydata->Tower+= 10; $mydata->Wall+= 10;]]></code>
    <created>2015-01-01</created>
    <modified>2015-01-01</modified>
  </card>
  <card id="738">
    <name>Sin city</name>
    <class>Rare</class>
    <cost>
      <bricks>22</bricks>
    </cost>
    <level>10</level>
    <keywords>Demonic</keywords>
    <effect><![CDATA[Tower: +16<br />Wall: +28<br />If last card played was <b>Demonic</b><br />Wall: +24]]></effect>
    <code><![CDATA[$mydata->Tower+= 16; $mydata->Wall+= 28;
    if ($mylast_card->hasKeyword('Demonic') and $mylast_action == 'play') {
      $mydata->Wall+= 24;
    }
    ]]></code>
    <created>2015-01-01</created>
    <modified>2015-01-01</modified>
  </card>
  <card id="739">
    <name>Crystalline lotus</name>
    <class>Rare</class>
    <level>10</level>
    <effect><![CDATA[Stock: +9<br />Production x0]]></effect>
    <code><![CDATA[$mydata->addStock(9); $production->multiply(0);]]></code>
    <created>2015-01-01</created>
    <modified>2015-01-01</modified>
  </card>
  <card id="740">
    <name>Shadow warrior</name>
    <class>Rare</class>
    <cost>
      <recruits>22</recruits>
    </cost>
    <modes>8</modes>
    <level>10</level>
    <keywords>Banish</keywords>
    <effect><![CDATA[Attack: 25<br />Replace a card in hand with self<br />If last card played wasn't Shadow warrior<br />Attack: 30]]></effect>
    <code><![CDATA[
    $hisdata->attack(25); 
    if ($mylast_action != 'play' || $mylast_card->id() != $card->id()) {
      $hisdata->attack(30); 
    }
    if ($mode == $cardpos) $nextcard = 0;
    else $this->replaceCard('my', $mode, $card->id());
    ]]></code>
    <created>2015-01-01</created>
    <modified>2015-08-01</modified>
  </card>
  <card id="741">
    <name>Treasure cave</name>
    <class>Rare</class>
    <cost>
      <bricks>10</bricks>
      <gems>10</gems>
      <recruits>10</recruits>
    </cost>
    <modes>3</modes>
    <level>10</level>
    <effect><![CDATA[Mode1:<br />Bricks: +60<br />Mode2:<br />Gems: +40<br />Mode3:<br />Recruits: +50]]></effect>
    <code><![CDATA[
    if ($mode == 1) $mydata->Bricks+= 60;
    elseif ($mode == 2) $mydata->Gems+= 40;
    elseif ($mode == 3) $mydata->Recruits+= 50;
]]></code>
    <created>2015-01-01</created>
    <modified>2015-01-01</modified>
  </card>
  <card id="742">
    <name>Goblin lair</name>
    <class>Uncommon</class>
    <level>10</level>
    <keywords>Horde</keywords>
    <effect><![CDATA[Quarry: -2<br />Dungeon: +2]]></effect>
    <code><![CDATA[$mydata->Quarry-= 2; $mydata->Dungeons+= 2;]]></code>
    <created>2015-01-01</created>
    <modified>2015-01-01</modified>
  </card>
  <card id="743">
    <name>Storm temple</name>
    <class>Rare</class>
    <cost>
      <bricks>24</bricks>
      <gems>6</gems>
    </cost>
    <level>10</level>
    <keywords>Restoration</keywords>
    <effect><![CDATA[Tower: +5<br />Wall: +15<br />Facilities: +1]]></effect>
    <code><![CDATA[$mydata->Tower+= 5; $mydata->Wall+= 15; $mydata->addFacilities(1);]]></code>
    <created>2015-01-01</created>
    <modified>2015-01-01</modified>
  </card>
  <card id="744">
    <name>Rainbow fairy</name>
    <class>Common</class>
    <cost>
      <bricks>5</bricks>
      <gems>5</gems>
      <recruits>5</recruits>
    </cost>
    <level>10</level>
    <effect><![CDATA[Summon a non-common card from your deck]]></effect>
    <code><![CDATA[$nextcard = $this->drawCard(array_merge($my_deck->Uncommon, $my_deck->Rare), $mydata->Hand, $cardpos, 'drawCardList');]]></code>
    <created>2015-01-01</created>
    <modified>2015-01-01</modified>
  </card>
  <card id="745">
    <name>Foulhorn</name>
    <class>Rare</class>
    <cost>
      <bricks>23</bricks>
      <gems>24</gems>
    </cost>
    <modes>2</modes>
    <level>10</level>
    <keywords>Demonic,Legend,Rebirth</keywords>
    <effect><![CDATA[Attack: 36<br />Mode1:<br />Wall: +38<br />Mode2:<br />Gems: +18]]></effect>
    <code><![CDATA[
    $hisdata->attack(36);
    if ($mode == 1) $mydata->Wall+= 38;
    elseif ($mode == 2) $mydata->Gems+= 18;
]]></code>
    <created>2015-08-01</created>
    <modified>2015-08-01</modified>
  </card>
  <card id="746">
    <name>Marzanna</name>
    <class>Rare</class>
    <modes>8</modes>
    <level>10</level>
    <effect><![CDATA[Production x0<br />Opponent loses 20 random resources<br />Replace a card in hand with Blizzard, Nightmare or Undead cavalry]]></effect>
    <code><![CDATA[
    $production->multiply(0);
    $hisdata->addRandomResources(-20);
    $this->setCard('my', $mode, $this->drawCard([241, 304, 485], $mydata->Hand, $mode, 'drawCardList'));
    if ($mode == $cardpos) $nextcard = 0;
]]></code>
    <created>2015-08-01</created>
    <modified>2015-08-01</modified>
  </card>
  <card id="747">
    <name>Air nomad</name>
    <class>Rare</class>
    <level>10</level>
    <keywords>Quick,Aria</keywords>
    <effect><![CDATA[Replace matching card with Wind<br />Summons Breeze, Elemental storm or Wind dragon]]></effect>
    <code><![CDATA[
    $this->setCard('his', $cardpos, 247, ['reveal' => true]);
    $nextcard = $this->drawCard([509, 497, 679], $mydata->Hand, $cardpos, 'drawCardList');
]]></code>
    <created>2015-08-01</created>
    <modified>2015-09-26</modified>
  </card>
  <card id="748">
    <name>Altruism</name>
    <class>Rare</class>
    <level>10</level>
    <effect><![CDATA[Player(s) with highest facility suffers<br />Highest facility: -1<br />Player(s) with lowest facility gains<br />Lowest facility: +1]]></effect>
    <code><![CDATA[
    $myHighest = $mydata->detectHighestFacility();
    $myLowest = $mydata->detectLowestFacility();
    $myHighestAmount = $mydata->$myHighest;
    $myLowestAmount = $mydata->$myLowest;

    $hisHighest = $hisdata->detectHighestFacility();
    $hisLowest = $hisdata->detectLowestFacility();
    $hisHighestAmount = $hisdata->$hisHighest;
    $hisLowestAmount = $hisdata->$hisLowest;

    if ($myHighestAmount != $myLowestAmount || $myLowestAmount != $hisHighestAmount || $hisHighestAmount != $hisLowestAmount) {
      if ($myHighestAmount >= $hisHighestAmount) {
        $mydata->$myHighest-= 1;
      }
      if ($myHighestAmount <= $hisHighestAmount) {
        $hisdata->$hisHighest-= 1;
      }
      if ($myLowestAmount <= $hisLowestAmount) {
        $mydata->$myLowest+= 1;
      }
      if ($myLowestAmount >= $hisLowestAmount) {
        $hisdata->$hisLowest+= 1;
      }
    }
]]></code>
    <created>2015-08-01</created>
    <modified>2015-08-01</modified>
  </card>
  <card id="749">
    <name>Troll commander</name>
    <class>Rare</class>
    <cost>
      <recruits>25</recruits>
    </cost>
    <level>10</level>
    <keywords>Horde</keywords>
    <effect><![CDATA[Attack: 20<br />Recruits: +15<br />Replace common <b>Horde</b> in hand with uncommon <b>Horde</b>]]></effect>
    <code><![CDATA[
    $hisdata->attack(20);
    $mydata->Recruits+= 15;
    for ($i = 1; $i <= 8; $i++) {
      $cur_card = $this->getCard($mydata->Hand[$i]);
      if ($i != $cardpos and $cur_card->getClass() == 'Common' and $cur_card->hasKeyword('Horde')) {
        $this->setCard('my', $i, $this->drawCard($this->getList(['class'=>'Uncommon', 'keyword'=>'Horde']), $mydata->Hand, $i, 'drawCardList'));
      }
    }
]]></code>
    <created>2015-08-01</created>
    <modified>2015-08-01</modified>
  </card>
</cards>
